/* empty css                  *//* empty css                *//* empty css                   *//* empty css                     *//* empty css                        *//* empty css                  *//* empty css                 */import{u as ae,a as le,r as m,n as se,p as oe,o as C,c as k,d as o,e as t,w as l,t as u,s as i,x as r,y as F,z as ne,A as ie,B as re,C as ue,k as de,i as ce,U as me,Z as _e,h as _,G as pe,H as fe,I as ve,J as U,_ as ge,M as he,$ as we,v as be,N as ye,O as Le,a1 as xe,a2 as Ce,am as Ve,a7 as Ee,P as Me,Q as ke,R as Ae,ac as Ne,T as De,ab as Be,ae as Ie,j as Te,l as ze,F as Fe}from"./index-615a714d.js";import{m as V}from"./music-263a48e5.js";import{_ as Ue}from"./_plugin-vue_export-helper-c27b6911.js";const $e={class:"music-layout"},Re={class:"header"},Se={class:"header-right"},qe={class:"user-info"},je={class:"username"},Ge={class:"main-container"},He={class:"sidebar"},Je={class:"content"},Ke={class:"toolbar"},Oe={class:"toolbar-left"},Pe={class:"toolbar-right"},Qe={class:"stats-row"},Ze={class:"stat-card total"},We={class:"stat-icon"},Xe={class:"stat-info"},Ye={class:"stat-value"},et={class:"music-id"},tt={class:"music-title"},at={class:"music-author"},lt={class:"music-album"},st={class:"music-tags"},ot={key:0,class:"na-text"},nt={class:"table-actions"},it={__name:"Music",setup(rt){const $=ae(),A=le(),f=m(!1),N=m(!1),E=m([]),v=m(""),g=m(!1),h=m(null),b=m(),n=m({id:null,title:"",author:"",album:"",tagList:""}),R={title:[{required:!0,message:"请输入音乐标题",trigger:"blur"}],author:[{required:!0,message:"请输入作者名称",trigger:"blur"}],album:[{required:!0,message:"请输入专辑名称",trigger:"blur"}]},D=se(()=>{if(!v.value)return E.value;const a=v.value.toLowerCase();return E.value.filter(e=>(e.title||"").toLowerCase().includes(a)||(e.author||"").toLowerCase().includes(a)||(e.album||"").toLowerCase().includes(a)||(e.tagList||"").toLowerCase().includes(a))}),S=a=>a?new Date(a).toLocaleString("zh-CN"):"N/A",y=async()=>{f.value=!0;try{const a=await V.getMusicList();a.code===200?E.value=a.data||[]:r.error(a.message||"加载音乐列表失败")}catch(a){console.error("加载音乐列表失败:",a),r.error("加载音乐列表失败")}finally{f.value=!1}},q=async()=>{if(v.value.trim()){f.value=!0;try{const a=await V.searchMusic(v.value.trim());a.code===200?E.value=a.data||[]:r.error(a.message||"搜索失败")}catch(a){console.error("搜索失败:",a),r.error("搜索失败")}finally{f.value=!1}}},I=()=>{h.value=null,n.value={id:null,title:"",author:"",album:"",tagList:""},b.value&&b.value.resetFields()},j=a=>{h.value=a,n.value={id:a.id,title:a.title||"",author:a.author||"",album:a.album||"",tagList:a.tagList||""},g.value=!0},G=async()=>{if(b.value){try{await b.value.validate()}catch{return}N.value=!0;try{let a;h.value?a=await V.updateMusic(n.value):a=await V.addMusic(n.value),a.code===200?(r.success(h.value?"更新音乐成功":"添加音乐成功"),g.value=!1,I(),await y()):r.error(a.message||"操作失败")}catch(a){console.error("操作失败:",a),r.error("操作失败")}finally{N.value=!1}}},H=async a=>{var e;try{await F.confirm(`确认删除音乐"${a.title}"？删除后无法恢复`,"警告",{type:"warning",confirmButtonText:"确认删除",cancelButtonText:"取消"});const c=await V.deleteMusic(a.id);c.code===200?(r.success("删除成功"),await y()):(e=c.message)!=null&&e.includes("歌曲信息不存在")?(r.error("该音乐不存在或已被删除"),await y()):r.error(c.message||"删除失败")}catch(c){c!=="cancel"&&(console.error("删除失败:",c),r.error("删除失败"))}},J=async a=>{if(a==="logout")try{await F.confirm("确认退出登录？","提示",{type:"warning"}),await A.logout(),$.push("/login")}catch{}};return oe(()=>{y()}),(a,e)=>{var z;const c=ne,L=ie,K=Me,O=ke,P=re,B=Ae,Q=ue,w=de,x=ce,p=Ne,Z=De,T=Be,W=Ie,X=me,M=Te,Y=ze,ee=_e,te=Fe;return C(),k("div",$e,[o("header",Re,[e[9]||(e[9]=o("div",{class:"header-left"},[o("h1",{class:"system-title"},"抖音短视频分析系统")],-1)),o("div",Se,[o("div",qe,[t(c,{size:32,class:"user-avatar"},{default:l(()=>{var s,d;return[_(u((d=(s=i(A).user)==null?void 0:s.username)==null?void 0:d.charAt(0)),1)]}),_:1}),o("span",je,u((z=i(A).user)==null?void 0:z.username),1),t(P,{onCommand:J,class:"user-dropdown"},{dropdown:l(()=>[t(O,null,{default:l(()=>[t(K,{command:"logout"},{default:l(()=>e[8]||(e[8]=[_("退出登录",-1)])),_:1,__:[8]})]),_:1})]),default:l(()=>[t(L,{class:"dropdown-icon"},{default:l(()=>[t(i(pe))]),_:1})]),_:1})])])]),o("div",Ge,[o("nav",He,[t(Q,{"default-active":a.$route.path,router:"",class:"sidebar-menu"},{default:l(()=>[t(B,{index:"/dashboard",class:"menu-item"},{default:l(()=>[t(L,null,{default:l(()=>[t(i(fe))]),_:1}),e[10]||(e[10]=o("span",null,"数据概览",-1))]),_:1,__:[10]}),t(B,{index:"/monitor",class:"menu-item"},{default:l(()=>[t(L,null,{default:l(()=>[t(i(ve))]),_:1}),e[11]||(e[11]=o("span",null,"监控管理",-1))]),_:1,__:[11]}),t(B,{index:"/music",class:"menu-item"},{default:l(()=>[t(L,null,{default:l(()=>[t(i(U))]),_:1}),e[12]||(e[12]=o("span",null,"音乐管理",-1))]),_:1,__:[12]})]),_:1},8,["default-active"])]),o("main",Je,[e[17]||(e[17]=o("div",{class:"page-header"},[o("h2",{class:"page-title"},"音乐管理"),o("p",{class:"page-desc"},"管理系统中的音乐库，支持音乐的增删改查操作")],-1)),o("div",Ke,[o("div",Oe,[t(w,{type:"primary",onClick:e[0]||(e[0]=s=>g.value=!0),icon:i(ge)},{default:l(()=>e[13]||(e[13]=[_(" 添加音乐 ",-1)])),_:1,__:[13]},8,["icon"]),t(w,{onClick:y,loading:f.value,icon:i(he)},{default:l(()=>e[14]||(e[14]=[_(" 刷新 ",-1)])),_:1,__:[14]},8,["loading","icon"])]),o("div",Pe,[t(x,{modelValue:v.value,"onUpdate:modelValue":e[1]||(e[1]=s=>v.value=s),placeholder:"搜索音乐标题、作者或专辑","prefix-icon":i(we),style:{width:"300px"},clearable:"",onInput:q},null,8,["modelValue","prefix-icon"])])]),o("div",Qe,[o("div",Ze,[o("div",We,[t(L,{size:"20"},{default:l(()=>[t(i(U))]),_:1})]),o("div",Xe,[o("div",Ye,u(D.value.length),1),e[15]||(e[15]=o("div",{class:"stat-label"},"音乐总数",-1))])])]),t(X,{class:"music-table-card"},{header:l(()=>e[16]||(e[16]=[o("div",{class:"card-header"},[o("span",{class:"card-title"},"音乐列表")],-1)])),default:l(()=>[be((C(),k("div",null,[t(W,{data:D.value,style:{width:"100%"},"empty-text":D.value.length===0?"暂无音乐数据":""},{default:l(()=>[t(p,{label:"ID",width:"80"},{default:l(({row:s})=>[o("span",et,u(s.id),1)]),_:1}),t(p,{label:"音乐标题","min-width":"200"},{default:l(({row:s})=>[o("div",tt,u(s.title||"N/A"),1)]),_:1}),t(p,{label:"作者","min-width":"150"},{default:l(({row:s})=>[o("div",at,u(s.author||"N/A"),1)]),_:1}),t(p,{label:"专辑","min-width":"150"},{default:l(({row:s})=>[o("div",lt,u(s.album||"N/A"),1)]),_:1}),t(p,{label:"标签","min-width":"150"},{default:l(({row:s})=>[o("div",st,[(C(!0),k(ye,null,Le((s.tagList||"").split(",").filter(d=>d.trim()),d=>(C(),xe(Z,{key:d,size:"small",style:{"margin-right":"5px"}},{default:l(()=>[_(u(d.trim()),1)]),_:2},1024))),128)),!s.tagList||!s.tagList.trim()?(C(),k("span",ot,"N/A")):Ce("",!0)])]),_:1}),t(p,{label:"创建时间",width:"180"},{default:l(({row:s})=>[_(u(S(s.createTime)),1)]),_:1}),t(p,{label:"操作",width:"200",fixed:"right"},{default:l(({row:s})=>[o("div",nt,[t(T,{content:"编辑音乐",placement:"top"},{default:l(()=>[t(w,{type:"primary",size:"small",icon:i(Ve),onClick:d=>j(s),link:""},null,8,["icon","onClick"])]),_:2},1024),t(T,{content:"删除音乐",placement:"top"},{default:l(()=>[t(w,{type:"danger",size:"small",icon:i(Ee),onClick:d=>H(s),link:""},null,8,["icon","onClick"])]),_:2},1024)])]),_:1})]),_:1},8,["data","empty-text"])])),[[te,f.value]])]),_:1})])]),t(ee,{modelValue:g.value,"onUpdate:modelValue":e[7]||(e[7]=s=>g.value=s),title:h.value?"编辑音乐":"添加音乐",width:"500px",onClose:I},{footer:l(()=>[t(w,{onClick:e[6]||(e[6]=s=>g.value=!1)},{default:l(()=>e[18]||(e[18]=[_("取消",-1)])),_:1,__:[18]}),t(w,{type:"primary",onClick:G,loading:N.value},{default:l(()=>[_(u(h.value?"更新":"添加"),1)]),_:1},8,["loading"])]),default:l(()=>[t(Y,{model:n.value,rules:R,ref_key:"formRef",ref:b,"label-width":"100px"},{default:l(()=>[t(M,{label:"音乐标题",prop:"title"},{default:l(()=>[t(x,{modelValue:n.value.title,"onUpdate:modelValue":e[2]||(e[2]=s=>n.value.title=s),placeholder:"请输入音乐标题"},null,8,["modelValue"])]),_:1}),t(M,{label:"作者",prop:"author"},{default:l(()=>[t(x,{modelValue:n.value.author,"onUpdate:modelValue":e[3]||(e[3]=s=>n.value.author=s),placeholder:"请输入作者名称"},null,8,["modelValue"])]),_:1}),t(M,{label:"专辑",prop:"album"},{default:l(()=>[t(x,{modelValue:n.value.album,"onUpdate:modelValue":e[4]||(e[4]=s=>n.value.album=s),placeholder:"请输入专辑名称"},null,8,["modelValue"])]),_:1}),t(M,{label:"标签",prop:"tagList"},{default:l(()=>[t(x,{modelValue:n.value.tagList,"onUpdate:modelValue":e[5]||(e[5]=s=>n.value.tagList=s),placeholder:"请输入标签，用逗号分隔（如：流行,抒情）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},wt=Ue(it,[["__scopeId","data-v-b0cc3c2a"]]);export{wt as default};
