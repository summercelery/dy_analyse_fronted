import{_ as ot,ao as lt,u as it,r as g,n as x,ap as nt,p as dt,o as c,c as r,d as t,e as o,w as l,t as i,a3 as z,N as G,O as J,s as n,aq as T,v as ct,x as O,ar as ut,A as rt,k as _t,i as mt,as as vt,af as pt,F as ft,h as u,J as ht,a2 as gt,at as wt,M as bt,a0 as yt,K as Ct,L as kt,au as It,av as Mt,aw as Vt,ax as xt,ay as zt,a4 as Tt,az as Et,aA as Bt,f as P,aB as $t,T as Lt,ad as St,S as Dt}from"./index-ebe2b180.js";/* empty css                   *//* empty css                 *//* empty css                        *//* empty css               *//* empty css                 *//* empty css                           */import{m as j}from"./music-02d5a60f.js";import{v as Nt}from"./video-c44cf66a.js";const Ut={class:"music-detail-page"},At={class:"breadcrumb-container"},Ft={key:0,class:"music-info-card"},Rt={class:"music-info-header"},Kt={class:"music-icon"},qt={class:"music-details"},Gt={class:"music-title"},Jt={class:"music-meta"},Ot={class:"music-author"},Pt={key:0,class:"music-album"},jt={key:0,class:"music-tags"},Ht={class:"music-actions"},Qt={class:"search-section"},Wt={class:"stats-grid"},Xt={class:"stat-icon"},Yt={class:"stat-content"},Zt={class:"stat-value"},te={class:"stat-icon"},ee={class:"stat-content"},se={class:"stat-value"},ae={class:"stat-icon"},oe={class:"stat-content"},le={class:"stat-value"},ie={class:"stat-icon"},ne={class:"stat-content"},de={class:"stat-value"},ce={class:"view-controls"},ue={class:"view-toggle"},re={class:"video-content"},_e={key:0,class:"video-grid"},me=["onClick"],ve={class:"video-header"},pe={class:"video-id"},fe={class:"video-status"},he={class:"video-content"},ge={class:"video-url"},we={class:"video-time"},be={class:"video-stats"},ye={class:"stat-item"},Ce={class:"stat-item"},ke={class:"stat-item"},Ie={class:"stat-item"},Me={class:"video-actions"},Ve={key:1,class:"video-table"},xe={class:"video-url"},ze={class:"stat-number"},Te={class:"stat-number"},Ee={class:"stat-number"},Be={class:"stat-number"},$e={key:1,class:"empty-state"},Le={__name:"MusicMonitorDetail",setup(Se){const S=lt(),D=it(),E=S.params.musicId,w=g(!1),_=g(null),b=g([]),k=g(""),C=g("grid"),p=g("all"),B=g({}),I=x(()=>{let s=b.value;if(k.value){const e=k.value.toLowerCase();s=s.filter(m=>{var V,d;return((V=m.awemeId)==null?void 0:V.toLowerCase().includes(e))||((d=m.awemeUrl)==null?void 0:d.toLowerCase().includes(e))})}return p.value==="monitoring"?s=s.filter(e=>e.status===1):p.value==="abnormal"?s=s.filter(e=>e.status===2):p.value==="auto"&&(s=s.filter(e=>e.monitorType===2)),s}),H=x(()=>b.value.filter(s=>s.status===1).length),Q=x(()=>b.value.filter(s=>s.status===2).length),W=x(()=>b.value.filter(s=>s.monitorType===2).length),N=async()=>{try{const s=await j.getMusicInfo(E);_.value=s.data}catch(s){console.error("加载音乐信息失败:",s),O.error("加载音乐信息失败")}},$=async()=>{w.value=!0;try{const s=await j.getMonitorVideosByMusicId(E);b.value=s.data||[],await X()}catch(s){console.error("加载监控视频失败:",s),O.error("加载监控视频失败")}finally{w.value=!1}},X=async()=>{const s=b.value.map(async e=>{try{const m=await Nt.getLatestVideoStats(e.awemeId);B.value[e.awemeId]=m.data||{diggCount:0,commentCount:0,collectCount:0,shareCount:0}}catch(m){console.error(`获取视频 ${e.awemeId} 统计数据失败:`,m),B.value[e.awemeId]={diggCount:0,commentCount:0,collectCount:0,shareCount:0}}});await Promise.all(s)},f=s=>B.value[s]||{diggCount:0,commentCount:0,collectCount:0,shareCount:0},M=s=>{p.value=s},U=s=>{D.push(`/stats/${s}`)},A=s=>{s&&window.open(s,"_blank")},Y=()=>{D.push("/music-monitor")},F=s=>{switch(s){case 1:return"success";case 2:return"warning";case 0:return"info";default:return"info"}},R=s=>{switch(s){case 1:return"监控中";case 2:return"异常";case 0:return"已停止";default:return"未知"}},K=s=>s?new Date(s).toLocaleString("zh-CN"):"-",h=s=>s==null?"0":s>=1e4?(s/1e4).toFixed(1)+"w":s.toString();return nt(()=>S.params.musicId,s=>{s&&s!==E&&(N(),$())}),dt(()=>{N(),$()}),(s,e)=>{const m=$t,V=ut,d=rt,L=Lt,y=_t,Z=mt,tt=vt,v=St,et=pt,st=Dt,at=ft;return c(),r("div",Ut,[t("div",At,[o(V,{separator:"/"},{default:l(()=>[o(m,{to:{path:"/music-monitor"}},{default:l(()=>e[8]||(e[8]=[u("音乐监控",-1)])),_:1,__:[8]}),o(m,null,{default:l(()=>{var a;return[u(i(((a=_.value)==null?void 0:a.title)||"音乐详情"),1)]}),_:1})]),_:1})]),_.value?(c(),r("div",Ft,[t("div",Rt,[t("div",Kt,[o(d,{size:"32"},{default:l(()=>[o(n(ht))]),_:1})]),t("div",qt,[t("h2",Gt,i(_.value.title),1),t("p",Jt,[t("span",Ot,i(_.value.author),1),_.value.album?(c(),r("span",Pt,"• "+i(_.value.album),1)):z("",!0)]),_.value.tagList?(c(),r("div",jt,[(c(!0),r(G,null,J(_.value.tagList.split(","),a=>(c(),gt(L,{key:a,size:"small",class:"music-tag"},{default:l(()=>[u(i(a),1)]),_:2},1024))),128))])):z("",!0)]),t("div",Ht,[o(y,{onClick:Y,icon:n(wt)},{default:l(()=>e[9]||(e[9]=[u("返回",-1)])),_:1,__:[9]},8,["icon"]),o(y,{onClick:$,loading:w.value,icon:n(bt)},{default:l(()=>e[10]||(e[10]=[u(" 刷新 ",-1)])),_:1,__:[10]},8,["loading","icon"])])])])):z("",!0),t("div",Qt,[o(Z,{modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=a=>k.value=a),placeholder:"搜索视频ID或链接","prefix-icon":n(yt),class:"search-input",clearable:"",size:"large"},null,8,["modelValue","prefix-icon"])]),t("div",Wt,[t("div",{class:T(["stat-card total",{active:p.value==="all"}]),onClick:e[1]||(e[1]=a=>M("all"))},[t("div",Xt,[o(d,{size:"24"},{default:l(()=>[o(n(Ct))]),_:1})]),t("div",Yt,[t("div",Zt,i(I.value.length),1),e[11]||(e[11]=t("div",{class:"stat-label"},"监控视频总数",-1))])],2),t("div",{class:T(["stat-card monitoring",{active:p.value==="monitoring"}]),onClick:e[2]||(e[2]=a=>M("monitoring"))},[t("div",te,[o(d,{size:"24"},{default:l(()=>[o(n(kt))]),_:1})]),t("div",ee,[t("div",se,i(H.value),1),e[12]||(e[12]=t("div",{class:"stat-label"},"监控中",-1))])],2),t("div",{class:T(["stat-card abnormal",{active:p.value==="abnormal"}]),onClick:e[3]||(e[3]=a=>M("abnormal"))},[t("div",ae,[o(d,{size:"24"},{default:l(()=>[o(n(It))]),_:1})]),t("div",oe,[t("div",le,i(Q.value),1),e[13]||(e[13]=t("div",{class:"stat-label"},"异常监控",-1))])],2),t("div",{class:T(["stat-card auto",{active:p.value==="auto"}]),onClick:e[4]||(e[4]=a=>M("auto"))},[t("div",ie,[o(d,{size:"24"},{default:l(()=>[o(n(Mt))]),_:1})]),t("div",ne,[t("div",de,i(W.value),1),e[14]||(e[14]=t("div",{class:"stat-label"},"自动添加",-1))])],2)]),t("div",ce,[t("div",ue,[o(tt,null,{default:l(()=>[o(y,{type:C.value==="grid"?"primary":"default",onClick:e[5]||(e[5]=a=>C.value="grid"),icon:n(Vt)},{default:l(()=>e[15]||(e[15]=[u(" 卡片视图 ",-1)])),_:1,__:[15]},8,["type","icon"]),o(y,{type:C.value==="list"?"primary":"default",onClick:e[6]||(e[6]=a=>C.value="list"),icon:n(xt)},{default:l(()=>e[16]||(e[16]=[u(" 列表视图 ",-1)])),_:1,__:[16]},8,["type","icon"])]),_:1})])]),ct((c(),r("div",re,[C.value==="grid"?(c(),r("div",_e,[(c(!0),r(G,null,J(I.value,a=>(c(),r("div",{key:a.id,class:"video-card",onClick:q=>U(a.awemeId)},[t("div",ve,[t("div",pe,i(a.awemeId),1),t("div",fe,[o(L,{type:F(a.status),size:"small"},{default:l(()=>[u(i(R(a.status)),1)]),_:2},1032,["type"])])]),t("div",he,[t("p",ge,i(a.awemeUrl),1),t("p",we,"添加时间："+i(K(a.createTime)),1)]),t("div",be,[t("div",ye,[o(d,null,{default:l(()=>[o(n(zt))]),_:1}),t("span",null,i(h(f(a.awemeId).diggCount)),1)]),t("div",Ce,[o(d,null,{default:l(()=>[o(n(Tt))]),_:1}),t("span",null,i(h(f(a.awemeId).commentCount)),1)]),t("div",ke,[o(d,null,{default:l(()=>[o(n(Et))]),_:1}),t("span",null,i(h(f(a.awemeId).collectCount)),1)]),t("div",Ie,[o(d,null,{default:l(()=>[o(n(Bt))]),_:1}),t("span",null,i(h(f(a.awemeId).shareCount)),1)])]),t("div",Me,[o(y,{type:"primary",size:"small",onClick:P(q=>A(a.awemeUrl),["stop"])},{default:l(()=>e[17]||(e[17]=[u(" 打开视频 ",-1)])),_:2,__:[17]},1032,["onClick"])])],8,me))),128))])):(c(),r("div",Ve,[o(et,{data:I.value,style:{width:"100%"},loading:w.value,"empty-text":"暂无监控视频",onRowClick:e[7]||(e[7]=a=>U(a.awemeId)),class:"clickable-table"},{default:l(()=>[o(v,{prop:"awemeId",label:"视频ID",width:"120"}),o(v,{prop:"awemeUrl",label:"视频链接","min-width":"200"},{default:l(({row:a})=>[t("span",xe,i(a.awemeUrl),1)]),_:1}),o(v,{prop:"status",label:"状态",width:"100"},{default:l(({row:a})=>[o(L,{type:F(a.status),size:"small"},{default:l(()=>[u(i(R(a.status)),1)]),_:2},1032,["type"])]),_:1}),o(v,{prop:"createTime",label:"添加时间",width:"160"},{default:l(({row:a})=>[u(i(K(a.createTime)),1)]),_:1}),o(v,{label:"点赞",width:"80"},{default:l(({row:a})=>[t("span",ze,i(h(f(a.awemeId).diggCount)),1)]),_:1}),o(v,{label:"评论",width:"80"},{default:l(({row:a})=>[t("span",Te,i(h(f(a.awemeId).commentCount)),1)]),_:1}),o(v,{label:"收藏",width:"80"},{default:l(({row:a})=>[t("span",Ee,i(h(f(a.awemeId).collectCount)),1)]),_:1}),o(v,{label:"分享",width:"80"},{default:l(({row:a})=>[t("span",Be,i(h(f(a.awemeId).shareCount)),1)]),_:1}),o(v,{label:"操作",width:"120",fixed:"right"},{default:l(({row:a})=>[o(y,{type:"primary",size:"small",onClick:P(q=>A(a.awemeUrl),["stop"])},{default:l(()=>e[18]||(e[18]=[u(" 打开视频 ",-1)])),_:2,__:[18]},1032,["onClick"])]),_:1})]),_:1},8,["data","loading"])]))])),[[at,w.value]]),!w.value&&I.value.length===0?(c(),r("div",$e,[o(st,{description:"暂无监控视频"})])):z("",!0)])}}},Je=ot(Le,[["__scopeId","data-v-3fbb4e7e"]]);export{Je as default};
