/* empty css                  *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                 */import{u as X,a as Y,r as k,n as ee,p as te,q as m,o as r,c as u,d as e,e as o,w as n,t as c,s as E,N as z,O as B,$ as N,Z as g,x as S,y as oe,z as se,B as ne,C as ae,i as le,h as y,f as ie,A as re,P as ce,Q as de,R as ue,k as _e,ah as me,T as pe,ar as fe,S as he}from"./index-ea0ef51f.js";import{m as A}from"./music-cb72a1f9.js";import{p as I}from"./tagUtils-dd34c03c.js";import{_ as ve}from"./_plugin-vue_export-helper-c27b6911.js";const we={class:"music-monitor-layout"},ge={class:"header"},ye={class:"header-right"},Ce={class:"user-info"},Me={class:"username"},ke={class:"main-container"},Ee={class:"sidebar"},Le={class:"content"},Ve={class:"search-bar"},xe={class:"music-grid"},be=["onClick"],De={class:"music-header"},ze={class:"music-icon"},Be={class:"music-actions"},Ne={class:"music-content"},Se=["title"],Ae={class:"music-author"},Ie={key:0,class:"music-album"},Te={key:1,class:"music-tags"},$e={class:"music-footer"},Oe={class:"music-stats"},He={class:"stat-item"},Pe={class:"music-time"},Re={key:1,class:"loading-container"},qe={__name:"MusicMonitor",setup(Fe){const L=X(),C=Y(),p=k(!1),f=k([]),h=k(""),V=ee(()=>{if(!h.value)return f.value;const s=h.value.toLowerCase();return f.value.filter(t=>{var i,l,v;const _=I(t.tagList);return((i=t.title)==null?void 0:i.toLowerCase().includes(s))||((l=t.author)==null?void 0:l.toLowerCase().includes(s))||((v=t.album)==null?void 0:v.toLowerCase().includes(s))||_.some(M=>M.toLowerCase().includes(s))})}),T=async()=>{p.value=!0;try{const s=await A.getMusicList();s.code===200?(f.value=s.data||[],await $()):S.error(s.message||"获取音乐列表失败")}catch(s){console.error("获取音乐列表失败:",s),S.error("获取音乐列表失败，请检查网络连接")}finally{p.value=!1}},$=async()=>{const s=f.value.map(async t=>{var _;try{const i=await A.getMonitorVideosByMusicId(t.id);i.code===200&&(t.monitorCount=((_=i.data)==null?void 0:_.length)||0)}catch(i){console.error(`获取音乐 ${t.id} 的监控数量失败:`,i),t.monitorCount=0}});await Promise.all(s)},x=s=>{L.push(`/music-monitor/${s}`)},O=async s=>{if(s==="logout")try{await oe.confirm("确认退出登录？","提示",{type:"warning"}),await C.logout(),L.push("/login")}catch{}},H=s=>s?new Date(s).toLocaleDateString("zh-CN"):"-";return te(()=>{T()}),(s,t)=>{var D;const _=se,i=m("ArrowDown"),l=re,v=ce,M=de,P=ne,R=m("Odometer"),w=ue,q=m("View"),F=m("Headset"),b=m("MusicNote"),K=ae,Q=le,U=_e,Z=me,j=pe,G=m("VideoCamera"),J=he,W=fe;return r(),u("div",we,[e("header",ge,[t[2]||(t[2]=e("div",{class:"header-left"},[e("h1",{class:"system-title"},"抖音短视频分析系统")],-1)),e("div",ye,[e("div",Ce,[o(_,{size:32,class:"user-avatar"},{default:n(()=>{var a,d;return[y(c((d=(a=E(C).user)==null?void 0:a.username)==null?void 0:d.charAt(0)),1)]}),_:1}),e("span",Me,c((D=E(C).user)==null?void 0:D.username),1),o(P,{onCommand:O,class:"user-dropdown"},{dropdown:n(()=>[o(M,null,{default:n(()=>[o(v,{command:"logout"},{default:n(()=>t[1]||(t[1]=[y("退出登录",-1)])),_:1,__:[1]})]),_:1})]),default:n(()=>[o(l,{class:"dropdown-icon"},{default:n(()=>[o(i)]),_:1})]),_:1})])])]),e("div",ke,[e("nav",Ee,[o(K,{"default-active":s.$route.path,router:"",class:"sidebar-menu"},{default:n(()=>[o(w,{index:"/dashboard",class:"menu-item"},{default:n(()=>[o(l,null,{default:n(()=>[o(R)]),_:1}),t[3]||(t[3]=e("span",null,"数据概览",-1))]),_:1,__:[3]}),o(w,{index:"/monitor",class:"menu-item"},{default:n(()=>[o(l,null,{default:n(()=>[o(q)]),_:1}),t[4]||(t[4]=e("span",null,"监控管理",-1))]),_:1,__:[4]}),o(w,{index:"/music-monitor",class:"menu-item"},{default:n(()=>[o(l,null,{default:n(()=>[o(F)]),_:1}),t[5]||(t[5]=e("span",null,"音乐监控",-1))]),_:1,__:[5]}),o(w,{index:"/music",class:"menu-item"},{default:n(()=>[o(l,null,{default:n(()=>[o(b)]),_:1}),t[6]||(t[6]=e("span",null,"音乐管理",-1))]),_:1,__:[6]})]),_:1},8,["default-active"])]),e("main",Le,[t[7]||(t[7]=e("div",{class:"page-header"},[e("h2",{class:"page-title"},"音乐监控"),e("p",{class:"page-desc"},"选择音乐查看对应的监控视频数据")],-1)),e("div",Ve,[o(Q,{modelValue:h.value,"onUpdate:modelValue":t[0]||(t[0]=a=>h.value=a),placeholder:"搜索音乐标题、作者或专辑","prefix-icon":s.Search,style:{width:"400px"},clearable:"",size:"large"},null,8,["modelValue","prefix-icon"])]),e("div",xe,[(r(!0),u(z,null,B(V.value,a=>(r(),u("div",{key:a.id,class:"music-card",onClick:d=>x(a.id)},[e("div",De,[e("div",ze,[o(l,{size:"24"},{default:n(()=>[o(b)]),_:1})]),e("div",Be,[o(Z,{content:"查看监控详情",placement:"top"},{default:n(()=>[o(U,{type:"primary",size:"small",icon:s.View,circle:"",onClick:ie(d=>x(a.id),["stop"])},null,8,["icon","onClick"])]),_:2},1024)])]),e("div",Ne,[e("h3",{class:"music-title",title:a.title},c(a.title),9,Se),e("p",Ae,c(a.author),1),a.album?(r(),u("p",Ie,"专辑："+c(a.album),1)):g("",!0),a.tagList?(r(),u("div",Te,[(r(!0),u(z,null,B(E(I)(a.tagList),d=>(r(),N(j,{key:d,size:"small",class:"music-tag"},{default:n(()=>[y(c(d),1)]),_:2},1024))),128))])):g("",!0)]),e("div",$e,[e("div",Oe,[e("span",He,[o(l,null,{default:n(()=>[o(G)]),_:1}),y(" 监控视频："+c(a.monitorCount||0),1)])]),e("div",Pe," 创建时间："+c(H(a.createTime)),1)])],8,be))),128))]),!p.value&&V.value.length===0?(r(),N(J,{key:0,description:"暂无音乐数据","image-size":120})):g("",!0),p.value?(r(),u("div",Re,[o(W,{rows:6,animated:""})])):g("",!0)])])])}}},Ye=ve(qe,[["__scopeId","data-v-a2575831"]]);export{Ye as default};
