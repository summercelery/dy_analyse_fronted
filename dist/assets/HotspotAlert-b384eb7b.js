import{_ as vt}from"./_plugin-vue_export-helper-d6af9df2.js";/* empty css                  *//* empty css                             *//* empty css                *//* empty css                        *//* empty css                     *//* empty css                       *//* empty css                  */import{n as M,p as mt,u as ft,a as pt,r as _,q as _t,o as c,c as b,d as t,e as l,w as s,t as n,v as g,h as u,F as gt,z as C,A,g as ht,B as $,C as ke,D as wt,G as yt,H as bt,I as Ct,k as kt,i as Dt,J as Tt,K as St,L as xt,M as At,N as $t,O as Mt,P as zt,aF as It,T as De,U as Ye,W as Lt,X as Ge,y as T,Y as Re,Z as Fe,_ as Vt,a1 as He,a2 as Et,R as qt,aa as ge,a3 as Ut,ab as Bt,ae as Wt,af as Nt,ag as Yt,ai as Gt,aj as Rt,ar as Ft,al as Ht,ah as Kt,am as Ot,an as Pt,ak as jt,au as Qt,av as Jt,ay as Xt}from"./index-a434c30f.js";import{m as Zt}from"./music-6f462bb7.js";import{H as el,v as Ke}from"./index.esm.min-7515423b.js";import{u as tl,i as ll,a as al,b as sl,c as ol,d as nl,e as il}from"./install-6e609d49.js";const se={getAlertList(p={}){return M({url:"/hotspot-alert/list",method:"post",data:p})},getVideoAlerts(p){return M({url:`/hotspot-alert/video/${p}`,method:"get"})},getRecentAlerts(p=10){return M({url:"/hotspot-alert/recent",method:"get",params:{limit:p}})},getMusicAlerts(p,v=30){return M({url:`/hotspot-alert/music/${p}`,method:"get",params:{days:v}})},getMusicAlertList(p,v={}){return M({url:`/hotspot-alert/music/${p}/list`,method:"post",data:v})},getMusicStatistics(p,v=30){return M({url:`/hotspot-alert/music/${p}/statistics`,method:"get",params:{days:v}})},getMusicTrend(p,v=7){return M({url:`/hotspot-alert/music/${p}/trend`,method:"get",params:{days:v}})},getGlobalStatistics(p={}){return M({url:"/hotspot-alert/statistics",method:"get",params:p})},getAlertsByLevel(p,v=7){return M({url:`/hotspot-alert/level/${p}`,method:"get",params:{days:v}})},getGlobalTrend(p=7){return M({url:"/hotspot-alert/trend",method:"get",params:{days:p}})},triggerDetection(p){return M({url:"/hotspot-alert/trigger",method:"post",params:{awemeId:p}})},deleteAlert(p){return M({url:`/hotspot-alert/${p}`,method:"delete"})},batchDeleteAlerts(p){return M({url:"/hotspot-alert/batch",method:"delete",data:p})}};const rl={class:"hotspot-layout"},ul={class:"header"},dl={class:"header-right"},cl={class:"user-info"},vl={class:"username"},ml={class:"main-container"},fl={class:"sidebar"},pl={class:"content"},_l={class:"page-header"},gl={key:0,class:"page-title-section"},hl={class:"page-title"},wl={class:"music-meta"},yl={class:"stats-row"},bl={class:"stat-icon"},Cl={class:"stat-info"},kl={class:"stat-value"},Dl={class:"stat-icon"},Tl={class:"stat-info"},Sl={class:"stat-value"},xl={class:"stat-icon"},Al={class:"stat-info"},$l={class:"stat-value"},Ml={class:"stat-icon"},zl={class:"stat-info"},Il={class:"stat-value"},Ll={class:"filter-section"},Vl={class:"filter-top"},El={class:"nav-controls"},ql={class:"search-controls"},Ul={class:"filter-bottom"},Bl={class:"filter-group"},Wl={class:"date-group"},Nl={class:"card-header"},Yl={class:"header-actions"},Gl={key:0,class:"global-alert-info"},Rl={class:"expand-content"},Fl={class:"time-text"},Hl={class:"growth-detail"},Kl={class:"growth-rate"},Ol={class:"growth-count"},Pl={class:"growth-detail"},jl={class:"growth-rate"},Ql={class:"growth-count"},Jl={class:"growth-detail"},Xl={class:"growth-rate"},Zl={class:"growth-count"},ea={class:"growth-detail"},ta={class:"growth-rate"},la={class:"growth-count"},aa={class:"expand-actions"},sa={class:"video-id"},oa={key:2},na={class:"video-title"},ia={class:"title-text"},ra={key:1,class:"na-text"},ua={class:"author-name"},da={class:"author-nickname"},ca={class:"music-info"},va={key:0,class:"music-title"},ma={key:1,class:"music-author"},fa={key:2,class:"na-text"},pa={class:"alert-stats"},_a={class:"total-alerts"},ga={class:"level-stats"},ha={class:"trigger-score"},wa={class:"stats-preview"},ya={class:"stats-item"},ba={class:"stats-item"},Ca={class:"detection-time"},ka={class:"table-actions"},Da={class:"stats-dialog-content"},Ta={class:"stats-header"},Sa={class:"video-info"},xa={class:"video-id-value"},Aa={class:"time-range-selector"},$a={class:"stats-content"},Ma={key:0,class:"stats-grid"},za={class:"stat-info"},Ia={class:"stat-value"},La={key:0,class:"stat-trend"},Va={class:"stat-icon"},Ea={class:"stat-info"},qa={class:"stat-value"},Ua={key:0,class:"stat-trend"},Ba={class:"stat-icon"},Wa={class:"stat-info"},Na={class:"stat-value"},Ya={key:0,class:"stat-trend"},Ga={class:"stat-icon"},Ra={class:"stat-info"},Fa={class:"stat-value"},Ha={key:0,class:"stat-trend"},Ka={class:"card-header"},Oa={class:"chart-legend"},Pa={class:"chart-container"},ja={key:1,class:"empty-chart"},Qa={key:0,class:"alert-detail"},Ja={class:"detail-section"},Xa={class:"detail-section"},Za={class:"detail-section"},es={class:"detail-section"},ts={class:"detail-section"},ls={__name:"HotspotAlert",setup(p){tl([ll,al,sl,ol,nl,il]);const v=mt(),j=ft(),he=pt(),Q=_(!1),oe=_([]),O=_([]),E=_([]),z=_(null),ne=_(null),q=_("all"),I=_(null),U=_(""),B=_(""),W=_(""),L=_(""),V=_(""),J=_({totalCount:0,level1Count:0,level2Count:0,level3Count:0,todayCount:0,weekCount:0,monthCount:0}),X=_(!1),ie=_(!1),f=_(null),re=_(!1),ue=_(!1),Z=_(null),G=_(null),de=_("7"),ee=_(null),ce=_(null),y=_({digg:0,comment:0,collect:0,share:0}),k=_({likes:!0,comments:!0,collects:!0,shares:!0}),Te=a=>{switch(a){case 1:return"success";case 2:return"warning";case 3:return"danger";default:return"info"}},Se=a=>{switch(a){case 1:return"轻度飙升";case 2:return"中度飙升";case 3:return"高度爆发";default:return"未知"}},Oe=a=>{switch(a){case"short":return"success";case"medium":return"warning";case"long":return"danger";default:return"info"}},xe=a=>{switch(a){case"short":return"短期";case"medium":return"中期";case"long":return"长期";default:return"未知"}},Ae=a=>{switch(a){case"digg":return"点赞";case"comment":return"评论";case"collect":return"收藏";case"share":return"分享";case"comprehensive":return"综合";default:return"未知"}},S=a=>a?a>=1e4?(a/1e4).toFixed(1)+"w":a.toString():"0",N=a=>a?Math.round(a*100)/100:"0",we=a=>a?Math.round(a*100)/100:"0",ve=(a,e)=>!a&&!e?0:e?a?(a||0)-(e||0):0:a||0,$e=(a,e)=>{if(!a)return"score-low";let i,r;switch(e){case"short":i=60,r=100;break;case"medium":i=100,r=200;break;case"long":i=160,r=320;break;default:i=60,r=100;break}return a>r?"score-high":a>=i?"score-medium":"score-low"},te=a=>a?new Date(a).toLocaleString("zh-CN"):"N/A",Me=a=>{const e={};return a.forEach(i=>{const r=i.awemeId;e[r]||(e[r]={awemeId:r,videoTitle:i.videoTitle,videoUrl:i.videoUrl,videoCover:i.videoCover,authorNickname:i.authorNickname,musicTitle:i.musicTitle,musicAuthor:i.musicAuthor,totalAlerts:0,latestAlert:null,alerts:[],level1Count:0,level2Count:0,level3Count:0,maxTriggerScore:0,maxTriggerScoreTimeWindow:null,currentDiggCount:0,currentCommentCount:0,currentCollectCount:0,currentShareCount:0,latestAlertDiggCount:0,latestAlertCommentCount:0,latestDetectionTime:null});const m=e[r];m.alerts.push(i),m.totalAlerts++,i.alertLevel===1?m.level1Count++:i.alertLevel===2?m.level2Count++:i.alertLevel===3&&m.level3Count++,i.triggerScore>m.maxTriggerScore&&(m.maxTriggerScore=i.triggerScore,m.maxTriggerScoreTimeWindow=i.timeWindow),(!m.latestAlert||new Date(i.detectionTime)>new Date(m.latestAlert.detectionTime))&&(m.latestAlert=i,m.currentDiggCount=i.currentDiggCount,m.currentCommentCount=i.currentCommentCount,m.currentCollectCount=i.currentCollectCount,m.currentShareCount=i.currentShareCount,m.latestAlertDiggCount=i.currentDiggCount,m.latestAlertCommentCount=i.currentCommentCount,m.latestDetectionTime=i.detectionTime)}),Object.values(e).sort((i,r)=>new Date(r.latestDetectionTime)-new Date(i.latestDetectionTime))},ye=()=>{F()},le=()=>{R(),F()},R=async()=>{try{const a={};L.value&&(a.startTime=L.value+" 00:00:00"),V.value&&(a.endTime=V.value+" 23:59:59"),z.value&&(a.musicId=z.value),console.log("统计接口调用参数:",a);const e=await se.getGlobalStatistics(a);e.code===200&&(J.value=e.data)}catch(a){console.error("加载统计数据失败:",a)}},Pe=async()=>{try{const a={orderBy:"create_time",orderDir:"DESC"};I.value&&(a.alertLevel=I.value),U.value&&(a.timeWindow=U.value),B.value&&(a.triggerMetric=B.value),W.value&&(a.awemeId=W.value.trim()),L.value&&(a.startTime=L.value+"T00:00:00"),V.value&&(a.endTime=V.value+"T23:59:59");const e=await se.getAlertList(a);if(e.code===200){const i=e.data||{};oe.value=i.list||i||[],O.value=Me(oe.value),console.log("全局热度提醒API响应:",i),console.log("分组后的数据:",O.value),await R()}else $.error(e.message||"加载全局热度提醒列表失败")}catch(a){console.error("加载全局热度提醒列表失败:",a),$.error("加载全局热度提醒列表失败")}finally{Q.value=!1}},me=a=>{switch(q.value=a,a){case"level1":I.value=1;break;case"level2":I.value=2;break;case"level3":I.value=3;break;default:I.value=null;break}F()},F=async()=>{if(Q.value=!0,!z.value){await Pe();return}try{const a={orderBy:"create_time",orderDir:"DESC"};I.value&&(a.alertLevel=I.value),U.value&&(a.timeWindow=U.value),B.value&&(a.triggerMetric=B.value),W.value&&(a.awemeId=W.value.trim()),L.value&&(a.startTime=L.value+"T00:00:00"),V.value&&(a.endTime=V.value+"T23:59:59");const e=await se.getMusicAlertList(z.value,a);if(e.code===200){const i=e.data||{};oe.value=i.list||i||[],O.value=Me(oe.value),console.log("热度提醒API响应:",i),console.log("分组后的数据:",O.value),await R()}else $.error(e.message||"加载热度提醒列表失败")}catch(a){console.error("加载热度提醒列表失败:",a),$.error("加载热度提醒列表失败")}finally{Q.value=!1}},je=a=>{a?(Z.value=a,re.value=!0,ot()):$.warning("视频ID无效")},ze=a=>{f.value=a,ie.value=!0},Qe=a=>{a&&window.open(`https://www.douyin.com/video/${a}`,"_blank")},Je=async a=>{try{await ke.confirm("确认删除该热度提醒？","警告",{type:"warning",confirmButtonText:"确认删除",cancelButtonText:"取消"});const e=await se.deleteAlert(a.id);e.code===200?($.success("删除成功"),await F(),await R()):$.error(e.message||"删除失败")}catch(e){e!=="cancel"&&$.error("删除失败")}},Xe=a=>{E.value=a},Ze=async()=>{try{const a=E.value.reduce((r,m)=>{var P;return r+(((P=m.alerts)==null?void 0:P.length)||0)},0);await ke.confirm(`确认批量删除选中的 ${E.value.length} 个视频的 ${a} 条热度提醒？`,"警告",{type:"warning",confirmButtonText:"确认删除",cancelButtonText:"取消"});const e=[];if(E.value.forEach(r=>{r.alerts&&Array.isArray(r.alerts)&&r.alerts.forEach(m=>{m.id&&e.push(m.id)})}),e.length===0){$.warning("没有找到有效的热度提醒记录ID");return}const i=await se.batchDeleteAlerts(e);i.code===200?($.success("批量删除成功"),X.value=!1,E.value=[],await F(),await R()):$.error(i.message||"批量删除失败")}catch(a){a!=="cancel"&&$.error("批量删除失败")}},et=async a=>{if(a!=="updateEmail"&&a==="logout")try{await ke.confirm("确认退出登录？","提示",{type:"warning"}),await he.logout(),j.push("/login")}catch{}},tt=()=>{j.push("/music")},lt=()=>{const e=new Date().toISOString().split("T")[0];!v.query.startTime&&!v.query.endTime&&(L.value=e,V.value=e)},at=a=>{if(a){const e={...v.query,searchKeyword:W.value||void 0,alertLevel:I.value||void 0,timeWindow:U.value||void 0,triggerMetric:B.value||void 0,startTime:L.value||void 0,endTime:V.value||void 0,currentFilter:q.value!=="all"?q.value:void 0};Object.keys(e).forEach(i=>{e[i]===void 0&&delete e[i]}),j.replace({path:v.path,query:e}).then(()=>{const i={searchKeyword:a,from:"hotspot"};z.value&&(i.musicId=z.value),j.push({path:"/monitor",query:i})})}else $.warning("视频ID无效")};_t(async()=>{if(lt(),v.query.musicId){z.value=parseInt(v.query.musicId);try{const a=await Zt.getMusicById(z.value);(a==null?void 0:a.code)===200&&(ne.value=a.data)}catch(a){console.warn("获取音乐信息失败:",a)}await R()}v.query.searchKeyword&&(W.value=v.query.searchKeyword),v.query.alertLevel&&(I.value=parseInt(v.query.alertLevel)),v.query.timeWindow&&(U.value=v.query.timeWindow),v.query.triggerMetric&&(B.value=v.query.triggerMetric),v.query.currentFilter&&(q.value=v.query.currentFilter),v.query.startTime&&(L.value=v.query.startTime),v.query.endTime&&(V.value=v.query.endTime),await R(),await F()});const fe=a=>a?a>=1e4?(a/1e4).toFixed(1)+"w":a.toString():"0",pe=a=>{if(!a)return Date.now();try{const e=a.split(" ");if(e.length===3){const i=e[0],r=e[1]+" "+e[2],m=`${i}-${r}`;return new Date(m).getTime()}return new Date(a).getTime()}catch(e){return console.error("时间解析失败:",a,e),Date.now()}},Y=a=>{k.value[a]=!k.value[a],Object.values(k.value).every(i=>!i)&&(k.value[a]=!0),ce.value&&Le(ce.value)},st=async()=>{try{const a=await Ke.getLatestVideoStats(Z.value);a.code===200&&(G.value=a.data)}catch(a){console.error("加载最新统计失败:",a)}},Ie=async()=>{try{const a=await Ke.getVideoStatsChart(Z.value,de.value);a.code===200&&(ce.value=a.data,Le(a.data))}catch{$.error("加载图表数据失败")}},Le=a=>{if(!a||!a.timestamps){ee.value=null;return}const e=[];k.value.likes&&e.push({name:"点赞数",type:"line",data:(a.diggCounts||[]).map((i,r)=>[pe(a.timestamps[r]),i]),smooth:!0,symbol:"circle",symbolSize:6,lineStyle:{width:3,color:"#ff6b9d"},itemStyle:{color:"#ff6b9d"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(255, 107, 157, 0.3)"},{offset:1,color:"rgba(255, 107, 157, 0.05)"}]}}}),k.value.comments&&e.push({name:"评论数",type:"line",data:(a.commentCounts||[]).map((i,r)=>[pe(a.timestamps[r]),i]),smooth:!0,symbol:"circle",symbolSize:6,lineStyle:{width:3,color:"#4ecdc4"},itemStyle:{color:"#4ecdc4"}}),k.value.collects&&e.push({name:"收藏数",type:"line",data:(a.collectCounts||[]).map((i,r)=>[pe(a.timestamps[r]),i]),smooth:!0,symbol:"circle",symbolSize:6,lineStyle:{width:3,color:"#45b7d1"},itemStyle:{color:"#45b7d1"}}),k.value.shares&&e.push({name:"分享数",type:"line",data:(a.shareCounts||[]).map((i,r)=>[pe(a.timestamps[r]),i]),smooth:!0,symbol:"circle",symbolSize:6,lineStyle:{width:3,color:"#f9ca24"},itemStyle:{color:"#f9ca24"}}),ee.value={tooltip:{trigger:"axis",axisPointer:{type:"cross"},backgroundColor:"rgba(50, 50, 50, 0.95)",borderColor:"transparent",textStyle:{color:"#fff"}},grid:{left:"2%",right:"2%",bottom:"8%",top:"5%",containLabel:!0},xAxis:{type:"time",axisLine:{lineStyle:{color:"#e6e8eb"}},axisLabel:{color:"#6b7280",formatter:i=>{const r=new Date(i),m=(r.getMonth()+1).toString().padStart(2,"0"),P=r.getDate().toString().padStart(2,"0"),be=r.getHours().toString().padStart(2,"0");return`${m}-${P} ${be}:00`}},splitLine:{show:!1}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#e6e8eb"}},axisLabel:{color:"#6b7280",formatter:i=>i>=1e4?(i/1e4).toFixed(1)+"w":i},splitLine:{lineStyle:{color:"#f1f3f4",type:"dashed"}}},series:e}},ot=async()=>{ue.value=!0;try{await Promise.all([st(),Ie()])}finally{ue.value=!1}},nt=()=>{re.value=!1,Z.value=null,G.value=null,ee.value=null,ce.value=null,de.value="7",k.value={likes:!0,comments:!0,collects:!0,shares:!0}};return(a,e)=>{var Ne;const i=wt,r=yt,m=Wt,P=Nt,be=bt,Ve=Yt,it=Ct,D=kt,rt=Dt,x=Gt,_e=Tt,Ee=St,H=Rt,ut=Ft,w=Ht,K=Kt,qe=Ot,Ue=Pt,Be=xt,Ce=At,dt=jt,h=Qt,ae=Jt,We=Xt;return c(),b("div",rl,[t("header",ul,[e[30]||(e[30]=t("div",{class:"header-left"},[t("h1",{class:"system-title"},"抖音短视频分析系统")],-1)),t("div",dl,[t("div",cl,[l(i,{size:32,class:"user-avatar"},{default:s(()=>{var o,d;return[u(n((d=(o=g(he).user)==null?void 0:o.username)==null?void 0:d.charAt(0)),1)]}),_:1}),t("span",vl,n((Ne=g(he).user)==null?void 0:Ne.username),1),l(be,{onCommand:et,class:"user-dropdown"},{dropdown:s(()=>[l(P,null,{default:s(()=>[l(m,{command:"updateEmail"},{default:s(()=>e[28]||(e[28]=[u("更新邮箱",-1)])),_:1,__:[28]}),l(m,{command:"logout"},{default:s(()=>e[29]||(e[29]=[u("退出登录",-1)])),_:1,__:[29]})]),_:1})]),default:s(()=>[l(r,{class:"dropdown-icon"},{default:s(()=>[l(g($t))]),_:1})]),_:1})])])]),t("div",ml,[t("nav",fl,[l(it,{"default-active":a.$route.path,router:"",class:"sidebar-menu"},{default:s(()=>[l(Ve,{index:"/music",class:"menu-item"},{default:s(()=>[l(r,null,{default:s(()=>[l(g(Mt))]),_:1}),e[31]||(e[31]=t("span",null,"音乐管理",-1))]),_:1,__:[31]}),l(Ve,{index:"/favorite-author",class:"menu-item"},{default:s(()=>[l(r,null,{default:s(()=>[l(g(zt))]),_:1}),e[32]||(e[32]=t("span",null,"收藏播主",-1))]),_:1,__:[32]})]),_:1},8,["default-active"])]),t("main",pl,[t("div",_l,[z.value&&ne.value?(c(),b("div",gl,[t("h2",hl,[u(n(ne.value.title)+" ",1),t("span",wl," · "+n(ne.value.author),1)]),e[33]||(e[33]=t("p",{class:"page-meta"},"热度提醒 · 实时监控视频热度变化",-1))])):(c(),b(gt,{key:1},[e[34]||(e[34]=t("h2",{class:"page-title"},"全局热度提醒",-1)),e[35]||(e[35]=t("p",{class:"page-desc"},"监控所有音乐的视频热度变化，及时发现爆火趋势",-1))],64))]),t("div",yl,[t("div",{class:C(["stat-card total",{"is-active":q.value==="all"}]),onClick:e[0]||(e[0]=o=>me("all"))},[t("div",bl,[l(r,{size:"20"},{default:s(()=>[l(g(It))]),_:1})]),t("div",Cl,[t("div",kl,n(J.value.totalCount),1),e[36]||(e[36]=t("div",{class:"stat-label"},"总提醒数",-1))])],2),t("div",{class:C(["stat-card level1",{"is-active":q.value==="level1"}]),onClick:e[1]||(e[1]=o=>me("level1"))},[t("div",Dl,[l(r,{size:"20"},{default:s(()=>[l(g(De))]),_:1})]),t("div",Tl,[t("div",Sl,n(J.value.level1Count),1),e[37]||(e[37]=t("div",{class:"stat-label"},"轻度飙升",-1))])],2),t("div",{class:C(["stat-card level2",{"is-active":q.value==="level2"}]),onClick:e[2]||(e[2]=o=>me("level2"))},[t("div",xl,[l(r,{size:"20"},{default:s(()=>[l(g(De))]),_:1})]),t("div",Al,[t("div",$l,n(J.value.level2Count),1),e[38]||(e[38]=t("div",{class:"stat-label"},"中度飙升",-1))])],2),t("div",{class:C(["stat-card level3",{"is-active":q.value==="level3"}]),onClick:e[3]||(e[3]=o=>me("level3"))},[t("div",Ml,[l(r,{size:"20"},{default:s(()=>[l(g(De))]),_:1})]),t("div",zl,[t("div",Il,n(J.value.level3Count),1),e[39]||(e[39]=t("div",{class:"stat-label"},"高度爆发",-1))])],2)]),t("div",Ll,[t("div",Vl,[t("div",El,[z.value?(c(),A(D,{key:0,onClick:tt,icon:g(Ye),size:"default"},{default:s(()=>e[40]||(e[40]=[u(" 返回音乐管理 ",-1)])),_:1,__:[40]},8,["icon"])):(c(),A(D,{key:1,onClick:e[4]||(e[4]=o=>g(j).push("/music")),icon:g(Ye),size:"default"},{default:s(()=>e[41]||(e[41]=[u(" 选择音乐 ",-1)])),_:1,__:[41]},8,["icon"])),l(D,{onClick:e[5]||(e[5]=()=>F()),loading:Q.value,icon:g(Lt),size:"default"},{default:s(()=>e[42]||(e[42]=[u(" 刷新数据 ",-1)])),_:1,__:[42]},8,["loading","icon"])]),t("div",ql,[l(rt,{modelValue:W.value,"onUpdate:modelValue":e[6]||(e[6]=o=>W.value=o),placeholder:"搜索视频ID或标题","prefix-icon":g(Ge),style:{width:"280px"},clearable:"",onKeyup:ht(ye,["enter"]),onClear:ye},null,8,["modelValue","prefix-icon"]),l(D,{onClick:ye,icon:g(Ge),type:"primary"},{default:s(()=>e[43]||(e[43]=[u("搜索",-1)])),_:1,__:[43]},8,["icon"])])]),t("div",Ul,[t("div",Bl,[e[44]||(e[44]=t("span",{class:"filter-label"},"筛选条件:",-1)),l(_e,{modelValue:I.value,"onUpdate:modelValue":e[7]||(e[7]=o=>I.value=o),placeholder:"提醒级别",style:{width:"120px"},onChange:le,clearable:"",size:"default"},{default:s(()=>[l(x,{label:"轻度飙升",value:1}),l(x,{label:"中度飙升",value:2}),l(x,{label:"高度爆发",value:3})]),_:1},8,["modelValue"]),l(_e,{modelValue:U.value,"onUpdate:modelValue":e[8]||(e[8]=o=>U.value=o),placeholder:"时间窗口",style:{width:"120px"},onChange:le,clearable:"",size:"default"},{default:s(()=>[l(x,{label:"短期(1小时)",value:"short"}),l(x,{label:"中期(6小时)",value:"medium"}),l(x,{label:"长期(24小时)",value:"long"})]),_:1},8,["modelValue"]),l(_e,{modelValue:B.value,"onUpdate:modelValue":e[9]||(e[9]=o=>B.value=o),placeholder:"触发指标",style:{width:"120px"},onChange:le,clearable:"",size:"default"},{default:s(()=>[l(x,{label:"点赞",value:"digg"}),l(x,{label:"评论",value:"comment"}),l(x,{label:"收藏",value:"collect"}),l(x,{label:"分享",value:"share"}),l(x,{label:"综合",value:"comprehensive"})]),_:1},8,["modelValue"])]),t("div",Wl,[e[45]||(e[45]=t("span",{class:"filter-label"},"时间范围:",-1)),l(Ee,{modelValue:L.value,"onUpdate:modelValue":e[10]||(e[10]=o=>L.value=o),type:"date",placeholder:"开始日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"140px"},onChange:le,size:"default"},null,8,["modelValue"]),e[46]||(e[46]=t("span",{class:"date-separator"},"至",-1)),l(Ee,{modelValue:V.value,"onUpdate:modelValue":e[11]||(e[11]=o=>V.value=o),type:"date",placeholder:"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"140px"},onChange:le,size:"default"},null,8,["modelValue"])])])]),l(Be,{class:"hotspot-table-card"},{header:s(()=>[t("div",Nl,[e[47]||(e[47]=t("span",{class:"card-title"},"热度提醒列表",-1)),t("div",Yl,[l(H,{content:"批量操作",placement:"top"},{default:s(()=>[l(D,{disabled:E.value.length===0,onClick:e[12]||(e[12]=o=>X.value=!0),size:"small"},{default:s(()=>[u(" 批量操作 ("+n(E.value.length)+") ",1)]),_:1},8,["disabled"])]),_:1})])])]),default:s(()=>[z.value?T("",!0):(c(),b("div",Gl,[l(ut,{title:"全局热度提醒",description:"当前显示所有音乐的热度提醒数据，您可以选择具体音乐查看更详细的信息",type:"info",closable:!1,style:{"margin-bottom":"16px"}})])),Re((c(),b("div",null,[l(qe,{data:O.value,style:{width:"100%"},onSelectionChange:Xe,"empty-text":O.value.length===0?"暂无热度提醒数据":"",size:"default","cell-style":{padding:"8px 6px"},"header-cell-style":{padding:"8px 6px",background:"#fafafa"}},{default:s(()=>[l(w,{type:"selection",width:"50"}),l(w,{type:"expand",width:"50"},{default:s(({row:o})=>[t("div",Rl,[l(qe,{data:o.alerts,size:"small",class:"expand-table",stripe:""},{default:s(()=>[l(w,{label:"检测时间","min-width":"160",align:"center"},{default:s(({row:d})=>[t("span",Fl,n(te(d.detectionTime)),1)]),_:1}),l(w,{label:"提醒级别",width:"110",align:"center"},{default:s(({row:d})=>[l(K,{type:Te(d.alertLevel),size:"small"},{default:s(()=>[u(n(Se(d.alertLevel)),1)]),_:2},1032,["type"])]),_:1}),l(w,{label:"时间窗口",width:"110",align:"center"},{default:s(({row:d})=>[l(K,{type:Oe(d.timeWindow),size:"small"},{default:s(()=>[u(n(xe(d.timeWindow)),1)]),_:2},1032,["type"])]),_:1}),l(w,{label:"触发指标",width:"110",align:"center"},{default:s(({row:d})=>[l(K,{size:"small",type:"info"},{default:s(()=>[u(n(Ae(d.triggerMetric)),1)]),_:2},1024)]),_:1}),l(w,{label:"触发评分",width:"100",align:"center"},{default:s(({row:d})=>[t("span",{class:C([$e(d.triggerScore,d.timeWindow),"score-text"])},n(we(d.triggerScore)),3)]),_:1}),l(w,{label:"点赞增长",width:"110",align:"center"},{default:s(({row:d})=>[t("div",Hl,[t("div",Kl,"+"+n(N(d.diggGrowthRate))+"%",1),t("div",Ol,"+"+n(S(ve(d.currentDiggCount,d.baselineDiggCount))),1)])]),_:1}),l(w,{label:"评论增长",width:"110",align:"center"},{default:s(({row:d})=>[t("div",Pl,[t("div",jl,"+"+n(N(d.commentGrowthRate))+"%",1),t("div",Ql,"+"+n(S(ve(d.currentCommentCount,d.baselineCommentCount))),1)])]),_:1}),l(w,{label:"收藏增长",width:"110",align:"center"},{default:s(({row:d})=>[t("div",Jl,[t("div",Xl,"+"+n(N(d.collectGrowthRate))+"%",1),t("div",Zl,"+"+n(S(ve(d.currentCollectCount,d.baselineCollectCount))),1)])]),_:1}),l(w,{label:"分享增长",width:"110",align:"center"},{default:s(({row:d})=>[t("div",ea,[t("div",ta,"+"+n(N(d.shareGrowthRate))+"%",1),t("div",la,"+"+n(S(ve(d.currentShareCount,d.baselineShareCount))),1)])]),_:1}),l(w,{label:"操作",width:"100",align:"center",fixed:"right"},{default:s(({row:d})=>[t("div",aa,[l(H,{content:"查看详情",placement:"top"},{default:s(()=>[l(D,{size:"small",type:"primary",link:"",icon:g(Fe),onClick:ct=>ze(d)},null,8,["icon","onClick"])]),_:2},1024),l(H,{content:"删除",placement:"top"},{default:s(()=>[l(D,{size:"small",type:"danger",link:"",icon:g(Vt),onClick:ct=>Je(d)},null,8,["icon","onClick"])]),_:2},1024)])]),_:1})]),_:2},1032,["data"])])]),_:1}),l(w,{label:"视频ID",width:"140"},{default:s(({row:o})=>[t("div",sa,[o.awemeId&&o.videoUrl?(c(),A(Ue,{key:0,href:o.videoUrl,target:"_blank",type:"primary",class:"video-id-link"},{default:s(()=>[u(n(o.awemeId),1)]),_:2},1032,["href"])):o.awemeId?(c(),A(Ue,{key:1,href:`https://www.douyin.com/video/${o.awemeId}`,target:"_blank",type:"primary",class:"video-id-link"},{default:s(()=>[u(n(o.awemeId),1)]),_:2},1032,["href"])):(c(),b("span",oa,n(o.awemeId||"N/A"),1))])]),_:1}),l(w,{label:"视频标题",width:"200"},{default:s(({row:o})=>[t("div",na,[o.videoTitle?(c(),A(H,{key:0,content:o.videoTitle,placement:"top","show-after":500},{default:s(()=>[t("span",ia,n(o.videoTitle),1)]),_:2},1032,["content"])):(c(),b("span",ra,"无标题"))])]),_:1}),l(w,{label:"播主",width:"120"},{default:s(({row:o})=>[t("div",ua,[t("span",da,n(o.authorNickname||"N/A"),1)])]),_:1}),z.value?T("",!0):(c(),A(w,{key:0,label:"音乐信息",width:"180"},{default:s(({row:o})=>[t("div",ca,[o.musicTitle?(c(),b("div",va,n(o.musicTitle),1)):T("",!0),o.musicAuthor?(c(),b("div",ma,n(o.musicAuthor),1)):T("",!0),!o.musicTitle&&!o.musicAuthor?(c(),b("span",fa,"音乐信息不详")):T("",!0)])]),_:1})),l(w,{label:"提醒统计",width:"180",align:"center"},{default:s(({row:o})=>[t("div",pa,[t("div",_a,"共 "+n(o.totalAlerts)+" 条提醒",1),t("div",ga,[o.level1Count>0?(c(),A(K,{key:0,type:"success",size:"small"},{default:s(()=>[u("轻度"+n(o.level1Count),1)]),_:2},1024)):T("",!0),o.level2Count>0?(c(),A(K,{key:1,type:"warning",size:"small"},{default:s(()=>[u("中度"+n(o.level2Count),1)]),_:2},1024)):T("",!0),o.level3Count>0?(c(),A(K,{key:2,type:"danger",size:"small"},{default:s(()=>[u("高度"+n(o.level3Count),1)]),_:2},1024)):T("",!0)])])]),_:1}),l(w,{label:"最高评分",width:"120",align:"center"},{default:s(({row:o})=>[t("div",ha,[t("span",{class:C([$e(o.maxTriggerScore,o.maxTriggerScoreTimeWindow),"score-text"])},n(we(o.maxTriggerScore)),3)])]),_:1}),l(w,{label:"预警数据",width:"130"},{default:s(({row:o})=>[t("div",wa,[t("div",ya,[e[48]||(e[48]=t("div",{class:"heart-icon"},[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})])],-1)),t("span",null,n(S(o.latestAlertDiggCount||0)),1)]),t("div",ba,[l(r,{size:"14"},{default:s(()=>[l(g(He))]),_:1}),t("span",null,n(S(o.latestAlertCommentCount||0)),1)])])]),_:1}),l(w,{label:"最新检测时间",width:"150",align:"center"},{default:s(({row:o})=>[t("div",Ca,n(te(o.latestDetectionTime)),1)]),_:1}),l(w,{label:"操作",width:"150",fixed:"right"},{default:s(({row:o})=>[t("div",ka,[l(H,{content:"查看统计",placement:"top"},{default:s(()=>[l(D,{type:"primary",size:"small",icon:g(Et),onClick:d=>je(o.awemeId),link:""},null,8,["icon","onClick"])]),_:2},1024),l(H,{content:"查看详情",placement:"top"},{default:s(()=>[l(D,{type:"primary",size:"small",icon:g(Fe),onClick:d=>ze(o.latestAlert),link:""},null,8,["icon","onClick"])]),_:2},1024),l(H,{content:"跳转监控",placement:"top"},{default:s(()=>[l(D,{type:"success",size:"small",icon:g(qt),onClick:d=>at(o.awemeId),link:""},null,8,["icon","onClick"])]),_:2},1024)])]),_:1})]),_:1},8,["data","empty-text"])])),[[We,Q.value]])]),_:1})])]),l(Ce,{modelValue:X.value,"onUpdate:modelValue":e[14]||(e[14]=o=>X.value=o),title:"批量操作",width:"400px"},{footer:s(()=>[l(D,{onClick:e[13]||(e[13]=o=>X.value=!1)},{default:s(()=>e[49]||(e[49]=[u("取消",-1)])),_:1,__:[49]}),l(D,{type:"danger",onClick:Ze},{default:s(()=>e[50]||(e[50]=[u(" 批量删除 ",-1)])),_:1,__:[50]})]),default:s(()=>[t("p",null,"已选择 "+n(E.value.length)+" 个热度提醒",1)]),_:1},8,["modelValue"]),l(Ce,{modelValue:re.value,"onUpdate:modelValue":e[24]||(e[24]=o=>re.value=o),title:"视频数据统计",width:"90%",top:"5vh","close-on-click-modal":!1},{footer:s(()=>[l(D,{onClick:nt},{default:s(()=>e[62]||(e[62]=[u("关闭",-1)])),_:1,__:[62]})]),default:s(()=>[t("div",Da,[t("div",Ta,[t("div",Sa,[e[51]||(e[51]=t("span",{class:"video-id-label"},"视频ID:",-1)),t("span",xa,n(Z.value),1)]),t("div",Aa,[l(_e,{modelValue:de.value,"onUpdate:modelValue":e[15]||(e[15]=o=>de.value=o),placeholder:"选择时间范围",style:{width:"140px"},onChange:Ie},{default:s(()=>[l(x,{label:"最近7天",value:"7"}),l(x,{label:"最近15天",value:"15"}),l(x,{label:"最近30天",value:"30"})]),_:1},8,["modelValue"])])]),Re((c(),b("div",$a,[G.value?(c(),b("div",Ma,[t("div",{class:C(["stat-card likes",{"is-active":k.value.likes}]),onClick:e[16]||(e[16]=o=>Y("likes"))},[e[53]||(e[53]=t("div",{class:"stat-icon"},[t("div",{class:"heart-icon-large"},[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})])])],-1)),t("div",za,[t("div",Ia,n(fe(G.value.diggCount)),1),e[52]||(e[52]=t("div",{class:"stat-label"},"点赞数",-1)),y.value.digg?(c(),b("div",La,[l(r,{class:C({"trend-up":y.value.digg>0,"trend-down":y.value.digg<0})},{default:s(()=>[(c(),A(ge(y.value.digg>0?"ArrowUp":"ArrowDown")))]),_:1},8,["class"]),t("span",null,n(Math.abs(y.value.digg))+"%",1)])):T("",!0)])],2),t("div",{class:C(["stat-card comments",{"is-active":k.value.comments}]),onClick:e[17]||(e[17]=o=>Y("comments"))},[t("div",Va,[l(r,{size:"24"},{default:s(()=>[l(g(He))]),_:1})]),t("div",Ea,[t("div",qa,n(fe(G.value.commentCount)),1),e[54]||(e[54]=t("div",{class:"stat-label"},"评论数",-1)),y.value.comment?(c(),b("div",Ua,[l(r,{class:C({"trend-up":y.value.comment>0,"trend-down":y.value.comment<0})},{default:s(()=>[(c(),A(ge(y.value.comment>0?"ArrowUp":"ArrowDown")))]),_:1},8,["class"]),t("span",null,n(Math.abs(y.value.comment))+"%",1)])):T("",!0)])],2),t("div",{class:C(["stat-card collects",{"is-active":k.value.collects}]),onClick:e[18]||(e[18]=o=>Y("collects"))},[t("div",Ba,[l(r,{size:"24"},{default:s(()=>[l(g(Ut))]),_:1})]),t("div",Wa,[t("div",Na,n(fe(G.value.collectCount)),1),e[55]||(e[55]=t("div",{class:"stat-label"},"收藏数",-1)),y.value.collect?(c(),b("div",Ya,[l(r,{class:C({"trend-up":y.value.collect>0,"trend-down":y.value.collect<0})},{default:s(()=>[(c(),A(ge(y.value.collect>0?"ArrowUp":"ArrowDown")))]),_:1},8,["class"]),t("span",null,n(Math.abs(y.value.collect))+"%",1)])):T("",!0)])],2),t("div",{class:C(["stat-card shares",{"is-active":k.value.shares}]),onClick:e[19]||(e[19]=o=>Y("shares"))},[t("div",Ga,[l(r,{size:"24"},{default:s(()=>[l(g(Bt))]),_:1})]),t("div",Ra,[t("div",Fa,n(fe(G.value.shareCount)),1),e[56]||(e[56]=t("div",{class:"stat-label"},"分享数",-1)),y.value.share?(c(),b("div",Ha,[l(r,{class:C({"trend-up":y.value.share>0,"trend-down":y.value.share<0})},{default:s(()=>[(c(),A(ge(y.value.share>0?"ArrowUp":"ArrowDown")))]),_:1},8,["class"]),t("span",null,n(Math.abs(y.value.share))+"%",1)])):T("",!0)])],2)])):T("",!0),l(Be,{class:"chart-card"},{header:s(()=>[t("div",Ka,[e[61]||(e[61]=t("span",{class:"card-title"},"数据趋势图",-1)),t("div",Oa,[t("div",{class:C(["legend-item",{"legend-disabled":!k.value.likes}]),onClick:e[20]||(e[20]=o=>Y("likes"))},e[57]||(e[57]=[t("div",{class:"legend-dot likes-dot"},null,-1),t("span",null,"点赞",-1)]),2),t("div",{class:C(["legend-item",{"legend-disabled":!k.value.comments}]),onClick:e[21]||(e[21]=o=>Y("comments"))},e[58]||(e[58]=[t("div",{class:"legend-dot comments-dot"},null,-1),t("span",null,"评论",-1)]),2),t("div",{class:C(["legend-item",{"legend-disabled":!k.value.collects}]),onClick:e[22]||(e[22]=o=>Y("collects"))},e[59]||(e[59]=[t("div",{class:"legend-dot collects-dot"},null,-1),t("span",null,"收藏",-1)]),2),t("div",{class:C(["legend-item",{"legend-disabled":!k.value.shares}]),onClick:e[23]||(e[23]=o=>Y("shares"))},e[60]||(e[60]=[t("div",{class:"legend-dot shares-dot"},null,-1),t("span",null,"分享",-1)]),2)])])]),default:s(()=>[t("div",Pa,[ee.value?(c(),A(g(el),{key:0,option:ee.value,style:{height:"400px"},autoresize:""},null,8,["option"])):ue.value?T("",!0):(c(),b("div",ja,[l(dt,{description:"暂无图表数据"})]))])]),_:1})])),[[We,ue.value]])])]),_:1},8,["modelValue"]),l(Ce,{modelValue:ie.value,"onUpdate:modelValue":e[27]||(e[27]=o=>ie.value=o),title:"热度提醒详情",width:"800px"},{footer:s(()=>[l(D,{onClick:e[25]||(e[25]=o=>ie.value=!1)},{default:s(()=>e[68]||(e[68]=[u("关闭",-1)])),_:1,__:[68]}),l(D,{type:"primary",onClick:e[26]||(e[26]=o=>{var d;return Qe((d=f.value)==null?void 0:d.awemeId)})},{default:s(()=>e[69]||(e[69]=[u("查看视频",-1)])),_:1,__:[69]})]),default:s(()=>[f.value?(c(),b("div",Qa,[t("div",Ja,[e[63]||(e[63]=t("h4",null,"基本信息",-1)),l(ae,{column:2,border:""},{default:s(()=>[l(h,{label:"视频ID"},{default:s(()=>[u(n(f.value.awemeId),1)]),_:1}),l(h,{label:"视频标题"},{default:s(()=>[u(n(f.value.videoTitle||"N/A"),1)]),_:1}),l(h,{label:"播主昵称"},{default:s(()=>[u(n(f.value.authorNickname||"N/A"),1)]),_:1}),l(h,{label:"提醒级别"},{default:s(()=>[l(K,{type:Te(f.value.alertLevel),size:"small"},{default:s(()=>[u(n(Se(f.value.alertLevel)),1)]),_:1},8,["type"])]),_:1}),l(h,{label:"时间窗口"},{default:s(()=>[u(n(xe(f.value.timeWindow)),1)]),_:1}),l(h,{label:"触发指标"},{default:s(()=>[u(n(Ae(f.value.triggerMetric)),1)]),_:1})]),_:1})]),t("div",Xa,[e[64]||(e[64]=t("h4",null,"评分数据",-1)),l(ae,{column:1,border:""},{default:s(()=>[l(h,{label:"触发评分"},{default:s(()=>[u(n(we(f.value.triggerScore)),1)]),_:1})]),_:1})]),t("div",Za,[e[65]||(e[65]=t("h4",null,"增长数据",-1)),l(ae,{column:2,border:""},{default:s(()=>[l(h,{label:"点赞增长率"},{default:s(()=>[u("+"+n(N(f.value.diggGrowthRate))+"%",1)]),_:1}),l(h,{label:"评论增长率"},{default:s(()=>[u("+"+n(N(f.value.commentGrowthRate))+"%",1)]),_:1}),l(h,{label:"收藏增长率"},{default:s(()=>[u("+"+n(N(f.value.collectGrowthRate))+"%",1)]),_:1}),l(h,{label:"分享增长率"},{default:s(()=>[u("+"+n(N(f.value.shareGrowthRate))+"%",1)]),_:1})]),_:1})]),t("div",es,[e[66]||(e[66]=t("h4",null,"当前数据 vs 基准数据",-1)),l(ae,{column:4,border:""},{default:s(()=>[l(h,{label:"当前点赞"},{default:s(()=>[u(n(S(f.value.currentDiggCount)),1)]),_:1}),l(h,{label:"基准点赞"},{default:s(()=>[u(n(S(f.value.baselineDiggCount)),1)]),_:1}),l(h,{label:"当前评论"},{default:s(()=>[u(n(S(f.value.currentCommentCount)),1)]),_:1}),l(h,{label:"基准评论"},{default:s(()=>[u(n(S(f.value.baselineCommentCount)),1)]),_:1}),l(h,{label:"当前收藏"},{default:s(()=>[u(n(S(f.value.currentCollectCount)),1)]),_:1}),l(h,{label:"基准收藏"},{default:s(()=>[u(n(S(f.value.baselineCollectCount)),1)]),_:1}),l(h,{label:"当前分享"},{default:s(()=>[u(n(S(f.value.currentShareCount)),1)]),_:1}),l(h,{label:"基准分享"},{default:s(()=>[u(n(S(f.value.baselineShareCount)),1)]),_:1})]),_:1})]),t("div",ts,[e[67]||(e[67]=t("h4",null,"时间信息",-1)),l(ae,{column:2,border:""},{default:s(()=>[l(h,{label:"检测时间"},{default:s(()=>[u(n(te(f.value.detectionTime)),1)]),_:1}),l(h,{label:"基准时间"},{default:s(()=>[u(n(te(f.value.baselineTime)),1)]),_:1}),l(h,{label:"创建时间"},{default:s(()=>[u(n(te(f.value.createTime)),1)]),_:1}),l(h,{label:"时间窗口"},{default:s(()=>[u(n(f.value.timeWindowHours)+"小时",1)]),_:1})]),_:1})])])):T("",!0)]),_:1},8,["modelValue"])])}}},ps=vt(ls,[["__scopeId","data-v-dd4bd5ce"]]);export{ps as default};
