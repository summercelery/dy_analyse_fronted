import{_ as vt}from"./_plugin-vue_export-helper-d6af9df2.js";/* empty css                  *//* empty css                       *//* empty css                */import{m as mt}from"./music-6a137b53.js";import{u as ft,i as pt,a as _t,b as gt,c as ht,d as wt,e as yt}from"./install-c708aa89.js";import{H as bt,v as Ne}from"./index.esm.min-7eb9cc43.js";import{n as M,p as Ct,u as kt,a as Dt,r as _,q as Tt,o as c,c as b,d as t,e as a,w as s,t as n,v as g,h as u,F as St,z as C,A as x,g as At,B as $,C as ke,D as xt,G as $t,H as Mt,I as zt,k as It,i as Lt,J as Vt,K as Et,L as qt,M as Ut,N as Bt,O as Wt,aB as Nt,T as De,U as Ye,W as Yt,X as Ge,y as T,Y as Re,av as Fe,a2 as Gt,Z as He,_ as Rt,Q as Ft,a7 as ge,a1 as Ht,a8 as Kt,aa as Ot,ab as Pt,ac as jt,ae as Qt,af as Jt,an as Xt,ah as Zt,ad as el,aj as tl,ai as ll,ag as al,aq as sl,ar as ol,at as nl}from"./index-a6d8c1ed.js";const se={getAlertList(p={}){return M({url:"/hotspot-alert/list",method:"post",data:p})},getVideoAlerts(p){return M({url:`/hotspot-alert/video/${p}`,method:"get"})},getRecentAlerts(p=10){return M({url:"/hotspot-alert/recent",method:"get",params:{limit:p}})},getMusicAlerts(p,v=30){return M({url:`/hotspot-alert/music/${p}`,method:"get",params:{days:v}})},getMusicAlertList(p,v={}){return M({url:`/hotspot-alert/music/${p}/list`,method:"post",data:v})},getMusicStatistics(p,v=30){return M({url:`/hotspot-alert/music/${p}/statistics`,method:"get",params:{days:v}})},getMusicTrend(p,v=7){return M({url:`/hotspot-alert/music/${p}/trend`,method:"get",params:{days:v}})},getGlobalStatistics(p={}){return M({url:"/hotspot-alert/statistics",method:"get",params:p})},getAlertsByLevel(p,v=7){return M({url:`/hotspot-alert/level/${p}`,method:"get",params:{days:v}})},getGlobalTrend(p=7){return M({url:"/hotspot-alert/trend",method:"get",params:{days:p}})},triggerDetection(p){return M({url:"/hotspot-alert/trigger",method:"post",params:{awemeId:p}})},deleteAlert(p){return M({url:`/hotspot-alert/${p}`,method:"delete"})},batchDeleteAlerts(p){return M({url:"/hotspot-alert/batch",method:"delete",data:p})}};const il={class:"hotspot-layout"},rl={class:"header"},ul={class:"header-right"},dl={class:"user-info"},cl={class:"username"},vl={class:"main-container"},ml={class:"sidebar"},fl={class:"content"},pl={class:"page-header"},_l={key:0,class:"page-title-section"},gl={class:"page-title"},hl={class:"music-meta"},wl={class:"stats-row"},yl={class:"stat-icon"},bl={class:"stat-info"},Cl={class:"stat-value"},kl={class:"stat-icon"},Dl={class:"stat-info"},Tl={class:"stat-value"},Sl={class:"stat-icon"},Al={class:"stat-info"},xl={class:"stat-value"},$l={class:"stat-icon"},Ml={class:"stat-info"},zl={class:"stat-value"},Il={class:"filter-section"},Ll={class:"filter-top"},Vl={class:"nav-controls"},El={class:"search-controls"},ql={class:"filter-bottom"},Ul={class:"filter-group"},Bl={class:"date-group"},Wl={class:"card-header"},Nl={class:"header-actions"},Yl={key:0,class:"global-alert-info"},Gl={class:"expand-content"},Rl={class:"time-text"},Fl={class:"growth-detail"},Hl={class:"growth-rate"},Kl={class:"growth-count"},Ol={class:"growth-detail"},Pl={class:"growth-rate"},jl={class:"growth-count"},Ql={class:"growth-detail"},Jl={class:"growth-rate"},Xl={class:"growth-count"},Zl={class:"growth-detail"},ea={class:"growth-rate"},ta={class:"growth-count"},la={class:"expand-actions"},aa={class:"video-id"},sa={key:2},oa={class:"video-title"},na={class:"title-text"},ia={key:1,class:"na-text"},ra={class:"author-name"},ua={class:"author-nickname"},da={class:"music-info"},ca={key:0,class:"music-title"},va={key:1,class:"music-author"},ma={key:2,class:"na-text"},fa={class:"alert-stats"},pa={class:"total-alerts"},_a={class:"level-stats"},ga={class:"trigger-score"},ha={class:"stats-preview"},wa={class:"stats-item"},ya={class:"stats-item"},ba={class:"detection-time"},Ca={class:"table-actions"},ka={class:"stats-dialog-content"},Da={class:"stats-header"},Ta={class:"video-info"},Sa={class:"video-id-value"},Aa={class:"time-range-selector"},xa={class:"stats-content"},$a={key:0,class:"stats-grid"},Ma={class:"stat-info"},za={class:"stat-value"},Ia={key:0,class:"stat-trend"},La={class:"stat-icon"},Va={class:"stat-info"},Ea={class:"stat-value"},qa={key:0,class:"stat-trend"},Ua={class:"stat-icon"},Ba={class:"stat-info"},Wa={class:"stat-value"},Na={key:0,class:"stat-trend"},Ya={class:"stat-icon"},Ga={class:"stat-info"},Ra={class:"stat-value"},Fa={key:0,class:"stat-trend"},Ha={class:"card-header"},Ka={class:"chart-legend"},Oa={class:"chart-container"},Pa={key:1,class:"empty-chart"},ja={key:0,class:"alert-detail"},Qa={class:"detail-section"},Ja={class:"detail-section"},Xa={class:"detail-section"},Za={class:"detail-section"},es={class:"detail-section"},ts={__name:"HotspotAlert",setup(p){ft([pt,_t,gt,ht,wt,yt]);const v=Ct(),j=kt(),he=Dt(),Q=_(!1),oe=_([]),O=_([]),E=_([]),z=_(null),ne=_(null),q=_("all"),I=_(null),U=_(""),B=_(""),W=_(""),L=_(""),V=_(""),J=_({totalCount:0,level1Count:0,level2Count:0,level3Count:0,todayCount:0,weekCount:0,monthCount:0}),X=_(!1),ie=_(!1),f=_(null),re=_(!1),ue=_(!1),Z=_(null),G=_(null),de=_("7"),ee=_(null),ce=_(null),y=_({digg:0,comment:0,collect:0,share:0}),k=_({likes:!0,comments:!0,collects:!0,shares:!0}),Te=l=>{switch(l){case 1:return"success";case 2:return"warning";case 3:return"danger";default:return"info"}},Se=l=>{switch(l){case 1:return"轻度飙升";case 2:return"中度飙升";case 3:return"高度爆发";default:return"未知"}},Ke=l=>{switch(l){case"short":return"success";case"medium":return"warning";case"long":return"danger";default:return"info"}},Ae=l=>{switch(l){case"short":return"短期";case"medium":return"中期";case"long":return"长期";default:return"未知"}},xe=l=>{switch(l){case"digg":return"点赞";case"comment":return"评论";case"collect":return"收藏";case"share":return"分享";case"comprehensive":return"综合";default:return"未知"}},S=l=>l?l>=1e4?(l/1e4).toFixed(1)+"w":l.toString():"0",N=l=>l?Math.round(l*100)/100:"0",we=l=>l?Math.round(l*100)/100:"0",ve=(l,e)=>!l&&!e?0:e?l?(l||0)-(e||0):0:l||0,$e=(l,e)=>{if(!l)return"score-low";let i,r;switch(e){case"short":i=60,r=100;break;case"medium":i=100,r=200;break;case"long":i=160,r=320;break;default:i=60,r=100;break}return l>r?"score-high":l>=i?"score-medium":"score-low"},te=l=>l?new Date(l).toLocaleString("zh-CN"):"N/A",Me=l=>{const e={};return l.forEach(i=>{const r=i.awemeId;e[r]||(e[r]={awemeId:r,videoTitle:i.videoTitle,videoUrl:i.videoUrl,videoCover:i.videoCover,authorNickname:i.authorNickname,musicTitle:i.musicTitle,musicAuthor:i.musicAuthor,totalAlerts:0,latestAlert:null,alerts:[],level1Count:0,level2Count:0,level3Count:0,maxTriggerScore:0,maxTriggerScoreTimeWindow:null,currentDiggCount:0,currentCommentCount:0,currentCollectCount:0,currentShareCount:0,latestAlertDiggCount:0,latestAlertCommentCount:0,latestDetectionTime:null});const m=e[r];m.alerts.push(i),m.totalAlerts++,i.alertLevel===1?m.level1Count++:i.alertLevel===2?m.level2Count++:i.alertLevel===3&&m.level3Count++,i.triggerScore>m.maxTriggerScore&&(m.maxTriggerScore=i.triggerScore,m.maxTriggerScoreTimeWindow=i.timeWindow),(!m.latestAlert||new Date(i.detectionTime)>new Date(m.latestAlert.detectionTime))&&(m.latestAlert=i,m.currentDiggCount=i.currentDiggCount,m.currentCommentCount=i.currentCommentCount,m.currentCollectCount=i.currentCollectCount,m.currentShareCount=i.currentShareCount,m.latestAlertDiggCount=i.currentDiggCount,m.latestAlertCommentCount=i.currentCommentCount,m.latestDetectionTime=i.detectionTime)}),Object.values(e).sort((i,r)=>new Date(r.latestDetectionTime)-new Date(i.latestDetectionTime))},ye=()=>{F()},le=()=>{R(),F()},R=async()=>{try{const l={};L.value&&(l.startTime=L.value+" 00:00:00"),V.value&&(l.endTime=V.value+" 23:59:59"),z.value&&(l.musicId=z.value),console.log("统计接口调用参数:",l);const e=await se.getGlobalStatistics(l);e.code===200&&(J.value=e.data)}catch(l){console.error("加载统计数据失败:",l)}},Oe=async()=>{try{const l={orderBy:"create_time",orderDir:"DESC"};I.value&&(l.alertLevel=I.value),U.value&&(l.timeWindow=U.value),B.value&&(l.triggerMetric=B.value),W.value&&(l.awemeId=W.value.trim()),L.value&&(l.startTime=L.value+"T00:00:00"),V.value&&(l.endTime=V.value+"T23:59:59");const e=await se.getAlertList(l);if(e.code===200){const i=e.data||{};oe.value=i.list||i||[],O.value=Me(oe.value),console.log("全局热度提醒API响应:",i),console.log("分组后的数据:",O.value),await R()}else $.error(e.message||"加载全局热度提醒列表失败")}catch(l){console.error("加载全局热度提醒列表失败:",l),$.error("加载全局热度提醒列表失败")}finally{Q.value=!1}},me=l=>{switch(q.value=l,l){case"level1":I.value=1;break;case"level2":I.value=2;break;case"level3":I.value=3;break;default:I.value=null;break}F()},F=async()=>{if(Q.value=!0,!z.value){await Oe();return}try{const l={orderBy:"create_time",orderDir:"DESC"};I.value&&(l.alertLevel=I.value),U.value&&(l.timeWindow=U.value),B.value&&(l.triggerMetric=B.value),W.value&&(l.awemeId=W.value.trim()),L.value&&(l.startTime=L.value+"T00:00:00"),V.value&&(l.endTime=V.value+"T23:59:59");const e=await se.getMusicAlertList(z.value,l);if(e.code===200){const i=e.data||{};oe.value=i.list||i||[],O.value=Me(oe.value),console.log("热度提醒API响应:",i),console.log("分组后的数据:",O.value),await R()}else $.error(e.message||"加载热度提醒列表失败")}catch(l){console.error("加载热度提醒列表失败:",l),$.error("加载热度提醒列表失败")}finally{Q.value=!1}},Pe=l=>{l?(Z.value=l,re.value=!0,st()):$.warning("视频ID无效")},ze=l=>{f.value=l,ie.value=!0},je=l=>{l&&window.open(`https://www.douyin.com/video/${l}`,"_blank")},Qe=async l=>{try{await ke.confirm("确认删除该热度提醒？","警告",{type:"warning",confirmButtonText:"确认删除",cancelButtonText:"取消"});const e=await se.deleteAlert(l.id);e.code===200?($.success("删除成功"),await F(),await R()):$.error(e.message||"删除失败")}catch(e){e!=="cancel"&&$.error("删除失败")}},Je=l=>{E.value=l},Xe=async()=>{try{const l=E.value.reduce((r,m)=>{var P;return r+(((P=m.alerts)==null?void 0:P.length)||0)},0);await ke.confirm(`确认批量删除选中的 ${E.value.length} 个视频的 ${l} 条热度提醒？`,"警告",{type:"warning",confirmButtonText:"确认删除",cancelButtonText:"取消"});const e=[];if(E.value.forEach(r=>{r.alerts&&Array.isArray(r.alerts)&&r.alerts.forEach(m=>{m.id&&e.push(m.id)})}),e.length===0){$.warning("没有找到有效的热度提醒记录ID");return}const i=await se.batchDeleteAlerts(e);i.code===200?($.success("批量删除成功"),X.value=!1,E.value=[],await F(),await R()):$.error(i.message||"批量删除失败")}catch(l){l!=="cancel"&&$.error("批量删除失败")}},Ze=async l=>{if(l!=="updateEmail"&&l==="logout")try{await ke.confirm("确认退出登录？","提示",{type:"warning"}),await he.logout(),j.push("/login")}catch{}},et=()=>{j.push("/music")},tt=()=>{const e=new Date().toISOString().split("T")[0];!v.query.startTime&&!v.query.endTime&&(L.value=e,V.value=e)},lt=l=>{if(l){const e={...v.query,searchKeyword:W.value||void 0,alertLevel:I.value||void 0,timeWindow:U.value||void 0,triggerMetric:B.value||void 0,startTime:L.value||void 0,endTime:V.value||void 0,currentFilter:q.value!=="all"?q.value:void 0};Object.keys(e).forEach(i=>{e[i]===void 0&&delete e[i]}),j.replace({path:v.path,query:e}).then(()=>{const i={searchKeyword:l,from:"hotspot"};z.value&&(i.musicId=z.value),j.push({path:"/monitor",query:i})})}else $.warning("视频ID无效")};Tt(async()=>{if(tt(),v.query.musicId){z.value=parseInt(v.query.musicId);try{const l=await mt.getMusicById(z.value);(l==null?void 0:l.code)===200&&(ne.value=l.data)}catch(l){console.warn("获取音乐信息失败:",l)}await R()}v.query.searchKeyword&&(W.value=v.query.searchKeyword),v.query.alertLevel&&(I.value=parseInt(v.query.alertLevel)),v.query.timeWindow&&(U.value=v.query.timeWindow),v.query.triggerMetric&&(B.value=v.query.triggerMetric),v.query.currentFilter&&(q.value=v.query.currentFilter),v.query.startTime&&(L.value=v.query.startTime),v.query.endTime&&(V.value=v.query.endTime),await R(),await F()});const fe=l=>l?l>=1e4?(l/1e4).toFixed(1)+"w":l.toString():"0",pe=l=>{if(!l)return Date.now();try{const e=l.split(" ");if(e.length===3){const i=e[0],r=e[1]+" "+e[2],m=`${i}-${r}`;return new Date(m).getTime()}return new Date(l).getTime()}catch(e){return console.error("时间解析失败:",l,e),Date.now()}},Y=l=>{k.value[l]=!k.value[l],Object.values(k.value).every(i=>!i)&&(k.value[l]=!0),ce.value&&Le(ce.value)},at=async()=>{try{const l=await Ne.getLatestVideoStats(Z.value);l.code===200&&(G.value=l.data)}catch(l){console.error("加载最新统计失败:",l)}},Ie=async()=>{try{const l=await Ne.getVideoStatsChart(Z.value,de.value);l.code===200&&(ce.value=l.data,Le(l.data))}catch{$.error("加载图表数据失败")}},Le=l=>{if(!l||!l.timestamps){ee.value=null;return}const e=[];k.value.likes&&e.push({name:"点赞数",type:"line",data:(l.diggCounts||[]).map((i,r)=>[pe(l.timestamps[r]),i]),smooth:!0,symbol:"circle",symbolSize:6,lineStyle:{width:3,color:"#ff6b9d"},itemStyle:{color:"#ff6b9d"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(255, 107, 157, 0.3)"},{offset:1,color:"rgba(255, 107, 157, 0.05)"}]}}}),k.value.comments&&e.push({name:"评论数",type:"line",data:(l.commentCounts||[]).map((i,r)=>[pe(l.timestamps[r]),i]),smooth:!0,symbol:"circle",symbolSize:6,lineStyle:{width:3,color:"#4ecdc4"},itemStyle:{color:"#4ecdc4"}}),k.value.collects&&e.push({name:"收藏数",type:"line",data:(l.collectCounts||[]).map((i,r)=>[pe(l.timestamps[r]),i]),smooth:!0,symbol:"circle",symbolSize:6,lineStyle:{width:3,color:"#45b7d1"},itemStyle:{color:"#45b7d1"}}),k.value.shares&&e.push({name:"分享数",type:"line",data:(l.shareCounts||[]).map((i,r)=>[pe(l.timestamps[r]),i]),smooth:!0,symbol:"circle",symbolSize:6,lineStyle:{width:3,color:"#f9ca24"},itemStyle:{color:"#f9ca24"}}),ee.value={tooltip:{trigger:"axis",axisPointer:{type:"cross"},backgroundColor:"rgba(50, 50, 50, 0.95)",borderColor:"transparent",textStyle:{color:"#fff"}},grid:{left:"2%",right:"2%",bottom:"8%",top:"5%",containLabel:!0},xAxis:{type:"time",axisLine:{lineStyle:{color:"#e6e8eb"}},axisLabel:{color:"#6b7280",formatter:i=>{const r=new Date(i),m=(r.getMonth()+1).toString().padStart(2,"0"),P=r.getDate().toString().padStart(2,"0"),be=r.getHours().toString().padStart(2,"0");return`${m}-${P} ${be}:00`}},splitLine:{show:!1}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#e6e8eb"}},axisLabel:{color:"#6b7280",formatter:i=>i>=1e4?(i/1e4).toFixed(1)+"w":i},splitLine:{lineStyle:{color:"#f1f3f4",type:"dashed"}}},series:e}},st=async()=>{ue.value=!0;try{await Promise.all([at(),Ie()])}finally{ue.value=!1}},ot=()=>{re.value=!1,Z.value=null,G.value=null,ee.value=null,ce.value=null,de.value="7",k.value={likes:!0,comments:!0,collects:!0,shares:!0}};return(l,e)=>{var We;const i=xt,r=$t,m=Ot,P=Pt,be=Mt,nt=jt,it=zt,D=It,rt=Lt,A=Qt,_e=Vt,Ve=Et,H=Jt,ut=Xt,w=Zt,K=el,Ee=tl,qe=ll,Ue=qt,Ce=Ut,dt=al,h=sl,ae=ol,Be=nl;return c(),b("div",il,[t("header",rl,[e[30]||(e[30]=t("div",{class:"header-left"},[t("h1",{class:"system-title"},"抖音短视频分析系统")],-1)),t("div",ul,[t("div",dl,[a(i,{size:32,class:"user-avatar"},{default:s(()=>{var o,d;return[u(n((d=(o=g(he).user)==null?void 0:o.username)==null?void 0:d.charAt(0)),1)]}),_:1}),t("span",cl,n((We=g(he).user)==null?void 0:We.username),1),a(be,{onCommand:Ze,class:"user-dropdown"},{dropdown:s(()=>[a(P,null,{default:s(()=>[a(m,{command:"updateEmail"},{default:s(()=>e[28]||(e[28]=[u("更新邮箱",-1)])),_:1,__:[28]}),a(m,{command:"logout"},{default:s(()=>e[29]||(e[29]=[u("退出登录",-1)])),_:1,__:[29]})]),_:1})]),default:s(()=>[a(r,{class:"dropdown-icon"},{default:s(()=>[a(g(Bt))]),_:1})]),_:1})])])]),t("div",vl,[t("nav",ml,[a(it,{"default-active":l.$route.path,router:"",class:"sidebar-menu"},{default:s(()=>[a(nt,{index:"/music",class:"menu-item"},{default:s(()=>[a(r,null,{default:s(()=>[a(g(Wt))]),_:1}),e[31]||(e[31]=t("span",null,"音乐管理",-1))]),_:1,__:[31]})]),_:1},8,["default-active"])]),t("main",fl,[t("div",pl,[z.value&&ne.value?(c(),b("div",_l,[t("h2",gl,[u(n(ne.value.title)+" ",1),t("span",hl," · "+n(ne.value.author),1)]),e[32]||(e[32]=t("p",{class:"page-meta"},"热度提醒 · 实时监控视频热度变化",-1))])):(c(),b(St,{key:1},[e[33]||(e[33]=t("h2",{class:"page-title"},"全局热度提醒",-1)),e[34]||(e[34]=t("p",{class:"page-desc"},"监控所有音乐的视频热度变化，及时发现爆火趋势",-1))],64))]),t("div",wl,[t("div",{class:C(["stat-card total",{"is-active":q.value==="all"}]),onClick:e[0]||(e[0]=o=>me("all"))},[t("div",yl,[a(r,{size:"20"},{default:s(()=>[a(g(Nt))]),_:1})]),t("div",bl,[t("div",Cl,n(J.value.totalCount),1),e[35]||(e[35]=t("div",{class:"stat-label"},"总提醒数",-1))])],2),t("div",{class:C(["stat-card level1",{"is-active":q.value==="level1"}]),onClick:e[1]||(e[1]=o=>me("level1"))},[t("div",kl,[a(r,{size:"20"},{default:s(()=>[a(g(De))]),_:1})]),t("div",Dl,[t("div",Tl,n(J.value.level1Count),1),e[36]||(e[36]=t("div",{class:"stat-label"},"轻度飙升",-1))])],2),t("div",{class:C(["stat-card level2",{"is-active":q.value==="level2"}]),onClick:e[2]||(e[2]=o=>me("level2"))},[t("div",Sl,[a(r,{size:"20"},{default:s(()=>[a(g(De))]),_:1})]),t("div",Al,[t("div",xl,n(J.value.level2Count),1),e[37]||(e[37]=t("div",{class:"stat-label"},"中度飙升",-1))])],2),t("div",{class:C(["stat-card level3",{"is-active":q.value==="level3"}]),onClick:e[3]||(e[3]=o=>me("level3"))},[t("div",$l,[a(r,{size:"20"},{default:s(()=>[a(g(De))]),_:1})]),t("div",Ml,[t("div",zl,n(J.value.level3Count),1),e[38]||(e[38]=t("div",{class:"stat-label"},"高度爆发",-1))])],2)]),t("div",Il,[t("div",Ll,[t("div",Vl,[z.value?(c(),x(D,{key:0,onClick:et,icon:g(Ye),size:"default"},{default:s(()=>e[39]||(e[39]=[u(" 返回音乐管理 ",-1)])),_:1,__:[39]},8,["icon"])):(c(),x(D,{key:1,onClick:e[4]||(e[4]=o=>g(j).push("/music")),icon:g(Ye),size:"default"},{default:s(()=>e[40]||(e[40]=[u(" 选择音乐 ",-1)])),_:1,__:[40]},8,["icon"])),a(D,{onClick:e[5]||(e[5]=()=>F()),loading:Q.value,icon:g(Yt),size:"default"},{default:s(()=>e[41]||(e[41]=[u(" 刷新数据 ",-1)])),_:1,__:[41]},8,["loading","icon"])]),t("div",El,[a(rt,{modelValue:W.value,"onUpdate:modelValue":e[6]||(e[6]=o=>W.value=o),placeholder:"搜索视频ID或标题","prefix-icon":g(Ge),style:{width:"280px"},clearable:"",onKeyup:At(ye,["enter"]),onClear:ye},null,8,["modelValue","prefix-icon"]),a(D,{onClick:ye,icon:g(Ge),type:"primary"},{default:s(()=>e[42]||(e[42]=[u("搜索",-1)])),_:1,__:[42]},8,["icon"])])]),t("div",ql,[t("div",Ul,[e[43]||(e[43]=t("span",{class:"filter-label"},"筛选条件:",-1)),a(_e,{modelValue:I.value,"onUpdate:modelValue":e[7]||(e[7]=o=>I.value=o),placeholder:"提醒级别",style:{width:"120px"},onChange:le,clearable:"",size:"default"},{default:s(()=>[a(A,{label:"轻度飙升",value:1}),a(A,{label:"中度飙升",value:2}),a(A,{label:"高度爆发",value:3})]),_:1},8,["modelValue"]),a(_e,{modelValue:U.value,"onUpdate:modelValue":e[8]||(e[8]=o=>U.value=o),placeholder:"时间窗口",style:{width:"120px"},onChange:le,clearable:"",size:"default"},{default:s(()=>[a(A,{label:"短期(1小时)",value:"short"}),a(A,{label:"中期(6小时)",value:"medium"}),a(A,{label:"长期(24小时)",value:"long"})]),_:1},8,["modelValue"]),a(_e,{modelValue:B.value,"onUpdate:modelValue":e[9]||(e[9]=o=>B.value=o),placeholder:"触发指标",style:{width:"120px"},onChange:le,clearable:"",size:"default"},{default:s(()=>[a(A,{label:"点赞",value:"digg"}),a(A,{label:"评论",value:"comment"}),a(A,{label:"收藏",value:"collect"}),a(A,{label:"分享",value:"share"}),a(A,{label:"综合",value:"comprehensive"})]),_:1},8,["modelValue"])]),t("div",Bl,[e[44]||(e[44]=t("span",{class:"filter-label"},"时间范围:",-1)),a(Ve,{modelValue:L.value,"onUpdate:modelValue":e[10]||(e[10]=o=>L.value=o),type:"date",placeholder:"开始日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"140px"},onChange:le,size:"default"},null,8,["modelValue"]),e[45]||(e[45]=t("span",{class:"date-separator"},"至",-1)),a(Ve,{modelValue:V.value,"onUpdate:modelValue":e[11]||(e[11]=o=>V.value=o),type:"date",placeholder:"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"140px"},onChange:le,size:"default"},null,8,["modelValue"])])])]),a(Ue,{class:"hotspot-table-card"},{header:s(()=>[t("div",Wl,[e[46]||(e[46]=t("span",{class:"card-title"},"热度提醒列表",-1)),t("div",Nl,[a(H,{content:"批量操作",placement:"top"},{default:s(()=>[a(D,{disabled:E.value.length===0,onClick:e[12]||(e[12]=o=>X.value=!0),size:"small"},{default:s(()=>[u(" 批量操作 ("+n(E.value.length)+") ",1)]),_:1},8,["disabled"])]),_:1})])])]),default:s(()=>[z.value?T("",!0):(c(),b("div",Yl,[a(ut,{title:"全局热度提醒",description:"当前显示所有音乐的热度提醒数据，您可以选择具体音乐查看更详细的信息",type:"info",closable:!1,style:{"margin-bottom":"16px"}})])),Re((c(),b("div",null,[a(Ee,{data:O.value,style:{width:"100%"},onSelectionChange:Je,"empty-text":O.value.length===0?"暂无热度提醒数据":"",size:"default","cell-style":{padding:"8px 6px"},"header-cell-style":{padding:"8px 6px",background:"#fafafa"}},{default:s(()=>[a(w,{type:"selection",width:"50"}),a(w,{type:"expand",width:"50"},{default:s(({row:o})=>[t("div",Gl,[a(Ee,{data:o.alerts,size:"small",class:"expand-table",stripe:""},{default:s(()=>[a(w,{label:"检测时间","min-width":"160",align:"center"},{default:s(({row:d})=>[t("span",Rl,n(te(d.detectionTime)),1)]),_:1}),a(w,{label:"提醒级别",width:"110",align:"center"},{default:s(({row:d})=>[a(K,{type:Te(d.alertLevel),size:"small"},{default:s(()=>[u(n(Se(d.alertLevel)),1)]),_:2},1032,["type"])]),_:1}),a(w,{label:"时间窗口",width:"110",align:"center"},{default:s(({row:d})=>[a(K,{type:Ke(d.timeWindow),size:"small"},{default:s(()=>[u(n(Ae(d.timeWindow)),1)]),_:2},1032,["type"])]),_:1}),a(w,{label:"触发指标",width:"110",align:"center"},{default:s(({row:d})=>[a(K,{size:"small",type:"info"},{default:s(()=>[u(n(xe(d.triggerMetric)),1)]),_:2},1024)]),_:1}),a(w,{label:"触发评分",width:"100",align:"center"},{default:s(({row:d})=>[t("span",{class:C([$e(d.triggerScore,d.timeWindow),"score-text"])},n(we(d.triggerScore)),3)]),_:1}),a(w,{label:"点赞增长",width:"110",align:"center"},{default:s(({row:d})=>[t("div",Fl,[t("div",Hl,"+"+n(N(d.diggGrowthRate))+"%",1),t("div",Kl,"+"+n(S(ve(d.currentDiggCount,d.baselineDiggCount))),1)])]),_:1}),a(w,{label:"评论增长",width:"110",align:"center"},{default:s(({row:d})=>[t("div",Ol,[t("div",Pl,"+"+n(N(d.commentGrowthRate))+"%",1),t("div",jl,"+"+n(S(ve(d.currentCommentCount,d.baselineCommentCount))),1)])]),_:1}),a(w,{label:"收藏增长",width:"110",align:"center"},{default:s(({row:d})=>[t("div",Ql,[t("div",Jl,"+"+n(N(d.collectGrowthRate))+"%",1),t("div",Xl,"+"+n(S(ve(d.currentCollectCount,d.baselineCollectCount))),1)])]),_:1}),a(w,{label:"分享增长",width:"110",align:"center"},{default:s(({row:d})=>[t("div",Zl,[t("div",ea,"+"+n(N(d.shareGrowthRate))+"%",1),t("div",ta,"+"+n(S(ve(d.currentShareCount,d.baselineShareCount))),1)])]),_:1}),a(w,{label:"操作",width:"100",align:"center",fixed:"right"},{default:s(({row:d})=>[t("div",la,[a(H,{content:"查看详情",placement:"top"},{default:s(()=>[a(D,{size:"small",type:"primary",link:"",icon:g(Fe),onClick:ct=>ze(d)},null,8,["icon","onClick"])]),_:2},1024),a(H,{content:"删除",placement:"top"},{default:s(()=>[a(D,{size:"small",type:"danger",link:"",icon:g(Gt),onClick:ct=>Qe(d)},null,8,["icon","onClick"])]),_:2},1024)])]),_:1})]),_:2},1032,["data"])])]),_:1}),a(w,{label:"视频ID",width:"140"},{default:s(({row:o})=>[t("div",aa,[o.awemeId&&o.videoUrl?(c(),x(qe,{key:0,href:o.videoUrl,target:"_blank",type:"primary",class:"video-id-link"},{default:s(()=>[u(n(o.awemeId),1)]),_:2},1032,["href"])):o.awemeId?(c(),x(qe,{key:1,href:`https://www.douyin.com/video/${o.awemeId}`,target:"_blank",type:"primary",class:"video-id-link"},{default:s(()=>[u(n(o.awemeId),1)]),_:2},1032,["href"])):(c(),b("span",sa,n(o.awemeId||"N/A"),1))])]),_:1}),a(w,{label:"视频标题",width:"200"},{default:s(({row:o})=>[t("div",oa,[o.videoTitle?(c(),x(H,{key:0,content:o.videoTitle,placement:"top","show-after":500},{default:s(()=>[t("span",na,n(o.videoTitle),1)]),_:2},1032,["content"])):(c(),b("span",ia,"无标题"))])]),_:1}),a(w,{label:"播主",width:"120"},{default:s(({row:o})=>[t("div",ra,[t("span",ua,n(o.authorNickname||"N/A"),1)])]),_:1}),z.value?T("",!0):(c(),x(w,{key:0,label:"音乐信息",width:"180"},{default:s(({row:o})=>[t("div",da,[o.musicTitle?(c(),b("div",ca,n(o.musicTitle),1)):T("",!0),o.musicAuthor?(c(),b("div",va,n(o.musicAuthor),1)):T("",!0),!o.musicTitle&&!o.musicAuthor?(c(),b("span",ma,"音乐信息不详")):T("",!0)])]),_:1})),a(w,{label:"提醒统计",width:"180",align:"center"},{default:s(({row:o})=>[t("div",fa,[t("div",pa,"共 "+n(o.totalAlerts)+" 条提醒",1),t("div",_a,[o.level1Count>0?(c(),x(K,{key:0,type:"success",size:"small"},{default:s(()=>[u("轻度"+n(o.level1Count),1)]),_:2},1024)):T("",!0),o.level2Count>0?(c(),x(K,{key:1,type:"warning",size:"small"},{default:s(()=>[u("中度"+n(o.level2Count),1)]),_:2},1024)):T("",!0),o.level3Count>0?(c(),x(K,{key:2,type:"danger",size:"small"},{default:s(()=>[u("高度"+n(o.level3Count),1)]),_:2},1024)):T("",!0)])])]),_:1}),a(w,{label:"最高评分",width:"120",align:"center"},{default:s(({row:o})=>[t("div",ga,[t("span",{class:C([$e(o.maxTriggerScore,o.maxTriggerScoreTimeWindow),"score-text"])},n(we(o.maxTriggerScore)),3)])]),_:1}),a(w,{label:"预警数据",width:"130"},{default:s(({row:o})=>[t("div",ha,[t("div",wa,[e[47]||(e[47]=t("div",{class:"heart-icon"},[t("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})])],-1)),t("span",null,n(S(o.latestAlertDiggCount||0)),1)]),t("div",ya,[a(r,{size:"14"},{default:s(()=>[a(g(He))]),_:1}),t("span",null,n(S(o.latestAlertCommentCount||0)),1)])])]),_:1}),a(w,{label:"最新检测时间",width:"150",align:"center"},{default:s(({row:o})=>[t("div",ba,n(te(o.latestDetectionTime)),1)]),_:1}),a(w,{label:"操作",width:"150",fixed:"right"},{default:s(({row:o})=>[t("div",Ca,[a(H,{content:"查看统计",placement:"top"},{default:s(()=>[a(D,{type:"primary",size:"small",icon:g(Rt),onClick:d=>Pe(o.awemeId),link:""},null,8,["icon","onClick"])]),_:2},1024),a(H,{content:"查看详情",placement:"top"},{default:s(()=>[a(D,{type:"primary",size:"small",icon:g(Fe),onClick:d=>ze(o.latestAlert),link:""},null,8,["icon","onClick"])]),_:2},1024),a(H,{content:"跳转监控",placement:"top"},{default:s(()=>[a(D,{type:"success",size:"small",icon:g(Ft),onClick:d=>lt(o.awemeId),link:""},null,8,["icon","onClick"])]),_:2},1024)])]),_:1})]),_:1},8,["data","empty-text"])])),[[Be,Q.value]])]),_:1})])]),a(Ce,{modelValue:X.value,"onUpdate:modelValue":e[14]||(e[14]=o=>X.value=o),title:"批量操作",width:"400px"},{footer:s(()=>[a(D,{onClick:e[13]||(e[13]=o=>X.value=!1)},{default:s(()=>e[48]||(e[48]=[u("取消",-1)])),_:1,__:[48]}),a(D,{type:"danger",onClick:Xe},{default:s(()=>e[49]||(e[49]=[u(" 批量删除 ",-1)])),_:1,__:[49]})]),default:s(()=>[t("p",null,"已选择 "+n(E.value.length)+" 个热度提醒",1)]),_:1},8,["modelValue"]),a(Ce,{modelValue:re.value,"onUpdate:modelValue":e[24]||(e[24]=o=>re.value=o),title:"视频数据统计",width:"90%",top:"5vh","close-on-click-modal":!1},{footer:s(()=>[a(D,{onClick:ot},{default:s(()=>e[61]||(e[61]=[u("关闭",-1)])),_:1,__:[61]})]),default:s(()=>[t("div",ka,[t("div",Da,[t("div",Ta,[e[50]||(e[50]=t("span",{class:"video-id-label"},"视频ID:",-1)),t("span",Sa,n(Z.value),1)]),t("div",Aa,[a(_e,{modelValue:de.value,"onUpdate:modelValue":e[15]||(e[15]=o=>de.value=o),placeholder:"选择时间范围",style:{width:"140px"},onChange:Ie},{default:s(()=>[a(A,{label:"最近7天",value:"7"}),a(A,{label:"最近15天",value:"15"}),a(A,{label:"最近30天",value:"30"})]),_:1},8,["modelValue"])])]),Re((c(),b("div",xa,[G.value?(c(),b("div",$a,[t("div",{class:C(["stat-card likes",{"is-active":k.value.likes}]),onClick:e[16]||(e[16]=o=>Y("likes"))},[e[52]||(e[52]=t("div",{class:"stat-icon"},[t("div",{class:"heart-icon-large"},[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})])])],-1)),t("div",Ma,[t("div",za,n(fe(G.value.diggCount)),1),e[51]||(e[51]=t("div",{class:"stat-label"},"点赞数",-1)),y.value.digg?(c(),b("div",Ia,[a(r,{class:C({"trend-up":y.value.digg>0,"trend-down":y.value.digg<0})},{default:s(()=>[(c(),x(ge(y.value.digg>0?"ArrowUp":"ArrowDown")))]),_:1},8,["class"]),t("span",null,n(Math.abs(y.value.digg))+"%",1)])):T("",!0)])],2),t("div",{class:C(["stat-card comments",{"is-active":k.value.comments}]),onClick:e[17]||(e[17]=o=>Y("comments"))},[t("div",La,[a(r,{size:"24"},{default:s(()=>[a(g(He))]),_:1})]),t("div",Va,[t("div",Ea,n(fe(G.value.commentCount)),1),e[53]||(e[53]=t("div",{class:"stat-label"},"评论数",-1)),y.value.comment?(c(),b("div",qa,[a(r,{class:C({"trend-up":y.value.comment>0,"trend-down":y.value.comment<0})},{default:s(()=>[(c(),x(ge(y.value.comment>0?"ArrowUp":"ArrowDown")))]),_:1},8,["class"]),t("span",null,n(Math.abs(y.value.comment))+"%",1)])):T("",!0)])],2),t("div",{class:C(["stat-card collects",{"is-active":k.value.collects}]),onClick:e[18]||(e[18]=o=>Y("collects"))},[t("div",Ua,[a(r,{size:"24"},{default:s(()=>[a(g(Ht))]),_:1})]),t("div",Ba,[t("div",Wa,n(fe(G.value.collectCount)),1),e[54]||(e[54]=t("div",{class:"stat-label"},"收藏数",-1)),y.value.collect?(c(),b("div",Na,[a(r,{class:C({"trend-up":y.value.collect>0,"trend-down":y.value.collect<0})},{default:s(()=>[(c(),x(ge(y.value.collect>0?"ArrowUp":"ArrowDown")))]),_:1},8,["class"]),t("span",null,n(Math.abs(y.value.collect))+"%",1)])):T("",!0)])],2),t("div",{class:C(["stat-card shares",{"is-active":k.value.shares}]),onClick:e[19]||(e[19]=o=>Y("shares"))},[t("div",Ya,[a(r,{size:"24"},{default:s(()=>[a(g(Kt))]),_:1})]),t("div",Ga,[t("div",Ra,n(fe(G.value.shareCount)),1),e[55]||(e[55]=t("div",{class:"stat-label"},"分享数",-1)),y.value.share?(c(),b("div",Fa,[a(r,{class:C({"trend-up":y.value.share>0,"trend-down":y.value.share<0})},{default:s(()=>[(c(),x(ge(y.value.share>0?"ArrowUp":"ArrowDown")))]),_:1},8,["class"]),t("span",null,n(Math.abs(y.value.share))+"%",1)])):T("",!0)])],2)])):T("",!0),a(Ue,{class:"chart-card"},{header:s(()=>[t("div",Ha,[e[60]||(e[60]=t("span",{class:"card-title"},"数据趋势图",-1)),t("div",Ka,[t("div",{class:C(["legend-item",{"legend-disabled":!k.value.likes}]),onClick:e[20]||(e[20]=o=>Y("likes"))},e[56]||(e[56]=[t("div",{class:"legend-dot likes-dot"},null,-1),t("span",null,"点赞",-1)]),2),t("div",{class:C(["legend-item",{"legend-disabled":!k.value.comments}]),onClick:e[21]||(e[21]=o=>Y("comments"))},e[57]||(e[57]=[t("div",{class:"legend-dot comments-dot"},null,-1),t("span",null,"评论",-1)]),2),t("div",{class:C(["legend-item",{"legend-disabled":!k.value.collects}]),onClick:e[22]||(e[22]=o=>Y("collects"))},e[58]||(e[58]=[t("div",{class:"legend-dot collects-dot"},null,-1),t("span",null,"收藏",-1)]),2),t("div",{class:C(["legend-item",{"legend-disabled":!k.value.shares}]),onClick:e[23]||(e[23]=o=>Y("shares"))},e[59]||(e[59]=[t("div",{class:"legend-dot shares-dot"},null,-1),t("span",null,"分享",-1)]),2)])])]),default:s(()=>[t("div",Oa,[ee.value?(c(),x(g(bt),{key:0,option:ee.value,style:{height:"400px"},autoresize:""},null,8,["option"])):ue.value?T("",!0):(c(),b("div",Pa,[a(dt,{description:"暂无图表数据"})]))])]),_:1})])),[[Be,ue.value]])])]),_:1},8,["modelValue"]),a(Ce,{modelValue:ie.value,"onUpdate:modelValue":e[27]||(e[27]=o=>ie.value=o),title:"热度提醒详情",width:"800px"},{footer:s(()=>[a(D,{onClick:e[25]||(e[25]=o=>ie.value=!1)},{default:s(()=>e[67]||(e[67]=[u("关闭",-1)])),_:1,__:[67]}),a(D,{type:"primary",onClick:e[26]||(e[26]=o=>{var d;return je((d=f.value)==null?void 0:d.awemeId)})},{default:s(()=>e[68]||(e[68]=[u("查看视频",-1)])),_:1,__:[68]})]),default:s(()=>[f.value?(c(),b("div",ja,[t("div",Qa,[e[62]||(e[62]=t("h4",null,"基本信息",-1)),a(ae,{column:2,border:""},{default:s(()=>[a(h,{label:"视频ID"},{default:s(()=>[u(n(f.value.awemeId),1)]),_:1}),a(h,{label:"视频标题"},{default:s(()=>[u(n(f.value.videoTitle||"N/A"),1)]),_:1}),a(h,{label:"播主昵称"},{default:s(()=>[u(n(f.value.authorNickname||"N/A"),1)]),_:1}),a(h,{label:"提醒级别"},{default:s(()=>[a(K,{type:Te(f.value.alertLevel),size:"small"},{default:s(()=>[u(n(Se(f.value.alertLevel)),1)]),_:1},8,["type"])]),_:1}),a(h,{label:"时间窗口"},{default:s(()=>[u(n(Ae(f.value.timeWindow)),1)]),_:1}),a(h,{label:"触发指标"},{default:s(()=>[u(n(xe(f.value.triggerMetric)),1)]),_:1})]),_:1})]),t("div",Ja,[e[63]||(e[63]=t("h4",null,"评分数据",-1)),a(ae,{column:1,border:""},{default:s(()=>[a(h,{label:"触发评分"},{default:s(()=>[u(n(we(f.value.triggerScore)),1)]),_:1})]),_:1})]),t("div",Xa,[e[64]||(e[64]=t("h4",null,"增长数据",-1)),a(ae,{column:2,border:""},{default:s(()=>[a(h,{label:"点赞增长率"},{default:s(()=>[u("+"+n(N(f.value.diggGrowthRate))+"%",1)]),_:1}),a(h,{label:"评论增长率"},{default:s(()=>[u("+"+n(N(f.value.commentGrowthRate))+"%",1)]),_:1}),a(h,{label:"收藏增长率"},{default:s(()=>[u("+"+n(N(f.value.collectGrowthRate))+"%",1)]),_:1}),a(h,{label:"分享增长率"},{default:s(()=>[u("+"+n(N(f.value.shareGrowthRate))+"%",1)]),_:1})]),_:1})]),t("div",Za,[e[65]||(e[65]=t("h4",null,"当前数据 vs 基准数据",-1)),a(ae,{column:4,border:""},{default:s(()=>[a(h,{label:"当前点赞"},{default:s(()=>[u(n(S(f.value.currentDiggCount)),1)]),_:1}),a(h,{label:"基准点赞"},{default:s(()=>[u(n(S(f.value.baselineDiggCount)),1)]),_:1}),a(h,{label:"当前评论"},{default:s(()=>[u(n(S(f.value.currentCommentCount)),1)]),_:1}),a(h,{label:"基准评论"},{default:s(()=>[u(n(S(f.value.baselineCommentCount)),1)]),_:1}),a(h,{label:"当前收藏"},{default:s(()=>[u(n(S(f.value.currentCollectCount)),1)]),_:1}),a(h,{label:"基准收藏"},{default:s(()=>[u(n(S(f.value.baselineCollectCount)),1)]),_:1}),a(h,{label:"当前分享"},{default:s(()=>[u(n(S(f.value.currentShareCount)),1)]),_:1}),a(h,{label:"基准分享"},{default:s(()=>[u(n(S(f.value.baselineShareCount)),1)]),_:1})]),_:1})]),t("div",es,[e[66]||(e[66]=t("h4",null,"时间信息",-1)),a(ae,{column:2,border:""},{default:s(()=>[a(h,{label:"检测时间"},{default:s(()=>[u(n(te(f.value.detectionTime)),1)]),_:1}),a(h,{label:"基准时间"},{default:s(()=>[u(n(te(f.value.baselineTime)),1)]),_:1}),a(h,{label:"创建时间"},{default:s(()=>[u(n(te(f.value.createTime)),1)]),_:1}),a(h,{label:"时间窗口"},{default:s(()=>[u(n(f.value.timeWindowHours)+"小时",1)]),_:1})]),_:1})])])):T("",!0)]),_:1},8,["modelValue"])])}}},ds=vt(ts,[["__scopeId","data-v-260bcfa0"]]);export{ds as default};
