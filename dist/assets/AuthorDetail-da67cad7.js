import{_ as Y}from"./_plugin-vue_export-helper-d6af9df2.js";/* empty css                  *//* empty css                     *//* empty css                 *//* empty css                */import{n as J,p as K,u as O,a as P,r as m,q as Q,o as p,c as y,d as t,e as l,w as a,t as r,v as f,Y as W,A as V,C as X,D as Z,H as ee,k as te,L as oe,M as ae,an as le,h as s,N as se,U as ne,y as re,B as c,a6 as ue,G as ie,a7 as de,a8 as _e,af as me,ad as pe,i as ce,j as fe,l as ve}from"./index-bf792e0d.js";const ge={getAuthorInfo(E){return J({url:`/author/info/${E}`,method:"get"})}};const we={class:"author-layout"},ye={class:"header"},Ee={class:"header-right"},ke={class:"user-info"},he={class:"username"},Ae={class:"content"},De={key:0,class:"author-info"},xe={class:"row"},Ie={class:"row"},Ve={class:"row"},Ce={key:0,class:"row"},be={__name:"AuthorDetail",setup(E){const C=K(),k=O(),i=P(),v=m(!1),n=m(null),d=m(!1),g=m(!1),_=m({email:""}),b=()=>k.back(),h=o=>o?o>=1e4?(o/1e4).toFixed(1)+"w":o.toString():"0",U=async()=>{const o=C.params.userId;if(o){v.value=!0;try{const e=await ge.getAuthorInfo(o);e.code===200&&(n.value=e.data)}finally{v.value=!1}}},B=async o=>{var e;if(o==="updateEmail"){_.value.email=((e=i.user)==null?void 0:e.email)||"",d.value=!0;return}if(o==="logout")try{await X.confirm("确认退出登录？","提示",{type:"warning"}),await i.logout(),k.push("/login")}catch{}},N=o=>/^[\w.!#$%&'*+/=?^`{|}~-]+@[\w-]+(\.[\w-]+)+$/.test(o),F=async()=>{const o=(_.value.email||"").trim();if(!o){c.warning("请输入邮箱地址");return}if(!N(o)){c.warning("邮箱格式不正确");return}g.value=!0;try{const e=await ue.updateEmail({email:o});e.code===200?(i.setUser({...i.user||{},email:o}),c.success("邮箱更新成功"),d.value=!1):c.error(e.message||"邮箱更新失败")}catch{c.error("邮箱更新失败，请稍后重试")}finally{g.value=!1}};return Q(U),(o,e)=>{var x;const A=Z,L=ie,D=de,M=_e,S=ee,w=te,$=me,q=pe,R=oe,j=ce,z=fe,G=ve,H=ae,T=le;return p(),y("div",we,[t("header",ye,[e[6]||(e[6]=t("div",{class:"header-left"},[t("h1",{class:"system-title"},"")],-1)),t("div",Ee,[t("div",ke,[l(A,{size:32,class:"user-avatar"},{default:a(()=>{var u,I;return[s(r((I=(u=f(i).user)==null?void 0:u.username)==null?void 0:I.charAt(0)),1)]}),_:1}),t("span",he,r((x=f(i).user)==null?void 0:x.username),1),l(S,{onCommand:B,class:"user-dropdown"},{dropdown:a(()=>[l(M,null,{default:a(()=>[l(D,{command:"updateEmail"},{default:a(()=>e[3]||(e[3]=[s("更新邮箱",-1)])),_:1,__:[3]}),l(D,{command:"logout"},{default:a(()=>e[4]||(e[4]=[s("退出登录",-1)])),_:1,__:[4]})]),_:1})]),default:a(()=>[l(L,{class:"dropdown-icon"},{default:a(()=>[l(f(se))]),_:1})]),_:1})]),l(w,{onClick:b,icon:f(ne),style:{"margin-left":"16px"}},{default:a(()=>e[5]||(e[5]=[s("返回",-1)])),_:1,__:[5]},8,["icon"])])]),t("main",Ae,[e[14]||(e[14]=t("div",{class:"page-header"},[t("h2",{class:"page-title"},"播主信息")],-1)),W((p(),V(R,null,{default:a(()=>[n.value?(p(),y("div",De,[t("div",xe,[t("div",null,[e[7]||(e[7]=t("strong",null,"用户ID：",-1)),s(r(n.value.userId),1)]),t("div",null,[e[8]||(e[8]=t("strong",null,"昵称：",-1)),s(r(n.value.nickname),1)])]),t("div",Ie,[t("div",null,[e[9]||(e[9]=t("strong",null,"粉丝：",-1)),s(r(h(n.value.followerCount)),1)]),t("div",null,[e[10]||(e[10]=t("strong",null,"获赞：",-1)),s(r(h(n.value.totalFavorited)),1)])]),t("div",Ve,[t("div",null,[e[11]||(e[11]=t("strong",null,"性别：",-1)),s(r(n.value.gender||"-"),1)]),t("div",null,[e[12]||(e[12]=t("strong",null,"地区：",-1)),s(r(n.value.ipLocation||"-"),1)])]),n.value.userUrl?(p(),y("div",Ce,[t("div",null,[e[13]||(e[13]=t("strong",null,"播主地址：",-1)),l($,{type:"primary",href:n.value.userUrl,target:"_blank",class:"author-link"},{default:a(()=>[s(r(n.value.userUrl),1)]),_:1},8,["href"])])])):re("",!0)])):(p(),V(q,{key:1,description:"暂无播主信息"}))]),_:1})),[[T,v.value]])]),l(H,{modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=u=>d.value=u),title:"更新邮箱",width:"420px"},{footer:a(()=>[l(w,{onClick:e[1]||(e[1]=u=>d.value=!1)},{default:a(()=>e[15]||(e[15]=[s("取消",-1)])),_:1,__:[15]}),l(w,{type:"primary",loading:g.value,onClick:F},{default:a(()=>e[16]||(e[16]=[s("确定",-1)])),_:1,__:[16]},8,["loading"])]),default:a(()=>[l(G,{model:_.value,"label-width":"80px"},{default:a(()=>[l(z,{label:"邮箱"},{default:a(()=>[l(j,{modelValue:_.value.email,"onUpdate:modelValue":e[0]||(e[0]=u=>_.value.email=u),placeholder:"请输入新的邮箱地址"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Se=Y(be,[["__scopeId","data-v-26d3a9eb"]]);export{Se as default};
