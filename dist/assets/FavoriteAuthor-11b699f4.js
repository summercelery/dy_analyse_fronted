import{_ as ne}from"./_plugin-vue_export-helper-d6af9df2.js";/* empty css                  *//* empty css                     *//* empty css                        *//* empty css                     */import{u as re,a as ie,r as v,az as ue,q as de,o as i,c as m,d as l,e as a,w as o,t as u,v as _,B as d,C as S,D as ce,G as _e,H as me,I as pe,k as fe,i as ve,L as he,M as ge,h as p,N as ye,O as we,P as j,W as ke,X as be,Y as Ce,A as D,aP as Ee,y as Le,aQ as xe,Z as Ae,_ as Te,ac as De,ad as Fe,ae as Ve,af as Ie,aj as Ne,ak as $e,ag as ze,al as Be,j as Me,l as Ue,ay as Se}from"./index-0e04f23d.js";import{f as P}from"./favorite-ea945121.js";const je={class:"favorite-layout"},Pe={class:"header"},qe={class:"header-right"},Ge={class:"user-info"},He={class:"username"},Ke={class:"main-container"},Oe={class:"sidebar"},Qe={class:"content"},Re={class:"stats-row"},We={class:"stat-card total"},Xe={class:"stat-icon"},Ye={class:"stat-info"},Ze={class:"stat-value"},Je={class:"toolbar"},et={class:"toolbar-left"},tt={class:"toolbar-right"},at={key:0,class:"empty-container"},ot={class:"nickname-cell"},st=["onClick"],lt={key:0,class:"author-level"},nt={class:"desc-cell"},rt={class:"stat-number"},it={class:"stat-number"},ut={key:1},dt={key:1},ct={key:0,class:"color-preview"},_t={class:"color-code"},mt={key:1},pt={class:"remark-cell"},ft={key:0,class:"remark-text"},vt={key:1,class:"no-remark"},ht={class:"time-text"},gt={__name:"FavoriteAuthor",setup(yt){const F=re(),f=ie(),h=v(!1),b=v([]),V=v(0),C=v(""),E=v(null),g=v(!1),L=v(!1),y=v({email:""}),I=ue(()=>{if(!C.value)return b.value;const s=C.value.toLowerCase();return b.value.filter(e=>{const r=e.author||{};return(r.nickname||"").toLowerCase().includes(s)||(r.userDesc||"").toLowerCase().includes(s)||(r.channelType||"").toLowerCase().includes(s)||(e.remark||"").toLowerCase().includes(s)})}),q=s=>s?new Date(s).toLocaleString("zh-CN"):"N/A",N=s=>{if(s==null)return"N/A";const e=parseInt(s);return e>=1e4?(e/1e4).toFixed(1)+"w":e.toString()},G=s=>{switch(s){case 1:return"info";case 2:return"success";case 3:return"warning";default:return"info"}},H=s=>{switch(s){case 1:return"普通";case 2:return"优质";case 3:return"顶级";default:return"未知"}},x=async()=>{var s;if(!((s=f.user)!=null&&s.id)){d.error("用户信息不完整，请重新登录");return}h.value=!0;try{const e=await P.getFavoriteList(f.user.id);e.success?(b.value=e.data||[],V.value=e.total||b.value.length):d.error(e.message||"加载收藏列表失败")}catch(e){console.error("加载收藏列表失败:",e),d.error("加载收藏列表失败")}finally{h.value=!1}},K=async s=>{var e;try{await S.confirm(`确认取消收藏播主"${((e=s.author)==null?void 0:e.nickname)||"N/A"}"？`,"警告",{type:"warning",confirmButtonText:"确认取消",cancelButtonText:"取消"}),E.value=s.id;const r=await P.removeFavorite(f.user.id,s.authorUserId);r.success?(d.success("取消收藏成功"),await x()):d.error(r.message||"取消收藏失败")}catch(r){r!=="cancel"&&(console.error("取消收藏失败:",r),d.error("取消收藏失败"))}finally{E.value=null}},A=s=>{s!=null&&s.userId?F.push(`/author/${s.userId}`):d.warning("播主信息不完整")},O=()=>{},Q=async s=>{var e;if(s==="updateEmail"){y.value.email=((e=f.user)==null?void 0:e.email)||"",g.value=!0;return}if(s==="logout")try{await S.confirm("确认退出登录？","提示",{type:"warning"}),await f.logout(),F.push("/login")}catch{}},R=s=>/^[\w.!#$%&'*+/=?^`{|}~-]+@[\w-]+(\.[\w-]+)+$/.test(s),W=async()=>{const s=(y.value.email||"").trim();if(!s){d.warning("请输入邮箱地址");return}if(!R(s)){d.warning("邮箱格式不正确");return}L.value=!0;try{const e=await De.updateEmail({email:s});e.code===200?(f.setUser({...f.user||{},email:s}),d.success("邮箱更新成功"),g.value=!1):d.error(e.message||"邮箱更新失败")}catch{d.error("邮箱更新失败，请稍后重试")}finally{L.value=!1}};return de(()=>{x()}),(s,e)=>{var U;const r=ce,w=_e,$=Fe,X=Ve,Y=me,z=Ie,Z=pe,k=fe,B=ve,J=Ne,c=$e,M=ze,ee=Be,te=he,ae=Me,oe=Ue,se=ge,le=Se;return i(),m("div",je,[l("header",Pe,[e[6]||(e[6]=l("div",{class:"header-left"},[l("h1",{class:"system-title"},"抖音短视频分析系统")],-1)),l("div",qe,[l("div",Ge,[a(r,{size:32,class:"user-avatar"},{default:o(()=>{var t,n;return[p(u((n=(t=_(f).user)==null?void 0:t.username)==null?void 0:n.charAt(0)),1)]}),_:1}),l("span",He,u((U=_(f).user)==null?void 0:U.username),1),a(Y,{onCommand:Q,class:"user-dropdown"},{dropdown:o(()=>[a(X,null,{default:o(()=>[a($,{command:"updateEmail"},{default:o(()=>e[4]||(e[4]=[p("更新邮箱",-1)])),_:1,__:[4]}),a($,{command:"logout"},{default:o(()=>e[5]||(e[5]=[p("退出登录",-1)])),_:1,__:[5]})]),_:1})]),default:o(()=>[a(w,{class:"dropdown-icon"},{default:o(()=>[a(_(ye))]),_:1})]),_:1})])])]),l("div",Ke,[l("nav",Oe,[a(Z,{"default-active":s.$route.path,router:"",class:"sidebar-menu"},{default:o(()=>[a(z,{index:"/music",class:"menu-item"},{default:o(()=>[a(w,null,{default:o(()=>[a(_(we))]),_:1}),e[7]||(e[7]=l("span",null,"音乐管理",-1))]),_:1,__:[7]}),a(z,{index:"/favorite-author",class:"menu-item"},{default:o(()=>[a(w,null,{default:o(()=>[a(_(j))]),_:1}),e[8]||(e[8]=l("span",null,"收藏播主",-1))]),_:1,__:[8]})]),_:1},8,["default-active"])]),l("main",Qe,[e[15]||(e[15]=l("div",{class:"page-header"},[l("h2",{class:"page-title"},"收藏播主"),l("p",{class:"page-desc"},"管理您收藏的播主，查看播主详细信息")],-1)),l("div",Re,[l("div",We,[l("div",Xe,[a(w,null,{default:o(()=>[a(_(j))]),_:1})]),l("div",Ye,[l("div",Ze,u(V.value),1),e[9]||(e[9]=l("div",{class:"stat-label"},"收藏播主总数",-1))])])]),l("div",Je,[l("div",et,[a(k,{type:"primary",onClick:x,icon:_(ke),loading:h.value},{default:o(()=>e[10]||(e[10]=[p(" 刷新列表 ",-1)])),_:1,__:[10]},8,["icon","loading"])]),l("div",tt,[a(B,{modelValue:C.value,"onUpdate:modelValue":e[0]||(e[0]=t=>C.value=t),placeholder:"搜索播主昵称、描述或标签","prefix-icon":_(be),style:{width:"300px"},clearable:"",onInput:O},null,8,["modelValue","prefix-icon"])])]),a(te,{class:"favorite-table-card"},{header:o(()=>e[11]||(e[11]=[l("div",{class:"card-header"},[l("span",{class:"card-title"},"收藏播主列表")],-1)])),default:o(()=>[Ce((i(),m("div",null,[I.value.length===0&&!h.value?(i(),m("div",at,[a(J,{description:"暂无收藏播主"},{description:o(()=>e[12]||(e[12]=[l("span",null,"您还没有收藏任何播主",-1),l("br",null,null,-1),l("small",null,"可以在播主详情页面进行收藏",-1)])),_:1})])):(i(),D(ee,{key:1,data:I.value,stripe:"",style:{width:"100%"},"default-sort":{prop:"createTime",order:"descending"}},{default:o(()=>[a(c,{prop:"author.authorAvatar",label:"头像",width:"80",align:"center"},{default:o(({row:t})=>{var n;return[a(r,{size:40,src:(n=t.author)==null?void 0:n.authorAvatar,onClick:T=>A(t.author),class:"avatar-clickable"},{default:o(()=>[a(w,null,{default:o(()=>[a(_(Ee))]),_:1})]),_:2},1032,["src","onClick"])]}),_:1}),a(c,{prop:"author.nickname",label:"昵称","min-width":"120"},{default:o(({row:t})=>{var n,T;return[l("div",ot,[l("span",{class:"nickname-link",onClick:wt=>A(t.author)},u(((n=t.author)==null?void 0:n.nickname)||"N/A"),9,st),(T=t.author)!=null&&T.authorLevel?(i(),m("div",lt," Lv."+u(t.author.authorLevel),1)):Le("",!0)])]}),_:1}),a(c,{prop:"author.userDesc",label:"描述","min-width":"200"},{default:o(({row:t})=>{var n;return[l("div",nt,u(((n=t.author)==null?void 0:n.userDesc)||"暂无描述"),1)]}),_:1}),a(c,{prop:"author.followerCount",label:"粉丝数",width:"100",align:"right"},{default:o(({row:t})=>{var n;return[l("span",rt,u(N((n=t.author)==null?void 0:n.followerCount)),1)]}),_:1}),a(c,{prop:"author.totalFavorited",label:"获赞数",width:"100",align:"right"},{default:o(({row:t})=>{var n;return[l("span",it,u(N((n=t.author)==null?void 0:n.totalFavorited)),1)]}),_:1}),a(c,{prop:"author.channelType",label:"类型",width:"100",align:"center"},{default:o(({row:t})=>{var n;return[(n=t.author)!=null&&n.channelType?(i(),D(M,{key:0,size:"small",type:"primary"},{default:o(()=>[p(u(t.author.channelType),1)]),_:2},1024)):(i(),m("span",ut,"-"))]}),_:1}),a(c,{prop:"author.authorLevel",label:"播主等级",width:"100",align:"center"},{default:o(({row:t})=>{var n;return[(n=t.author)!=null&&n.authorLevel?(i(),D(M,{key:0,type:G(t.author.authorLevel),size:"small"},{default:o(()=>[p(u(H(t.author.authorLevel)),1)]),_:2},1032,["type"])):(i(),m("span",dt,"-"))]}),_:1}),a(c,{prop:"author.backgroundColor",label:"背景颜色",width:"100",align:"center"},{default:o(({row:t})=>{var n;return[(n=t.author)!=null&&n.backgroundColor?(i(),m("div",ct,[l("div",{class:"color-block",style:xe({backgroundColor:t.author.backgroundColor})},null,4),l("span",_t,u(t.author.backgroundColor),1)])):(i(),m("span",mt,"-"))]}),_:1}),a(c,{prop:"remark",label:"备注","min-width":"150"},{default:o(({row:t})=>[l("div",pt,[t.remark?(i(),m("span",ft,u(t.remark),1)):(i(),m("span",vt,"暂无备注"))])]),_:1}),a(c,{prop:"createTime",label:"收藏时间",width:"160",sortable:""},{default:o(({row:t})=>[l("span",ht,u(q(t.createTime)),1)]),_:1}),a(c,{label:"操作",width:"200",align:"center",fixed:"right"},{default:o(({row:t})=>[a(k,{type:"primary",size:"small",icon:_(Ae),onClick:n=>A(t.author)},{default:o(()=>e[13]||(e[13]=[p(" 查看详情 ",-1)])),_:2,__:[13]},1032,["icon","onClick"]),a(k,{type:"danger",size:"small",icon:_(Te),onClick:n=>K(t),loading:E.value===t.id},{default:o(()=>e[14]||(e[14]=[p(" 取消收藏 ",-1)])),_:2,__:[14]},1032,["icon","onClick","loading"])]),_:1})]),_:1},8,["data"]))])),[[le,h.value]])]),_:1})])]),a(se,{modelValue:g.value,"onUpdate:modelValue":e[3]||(e[3]=t=>g.value=t),title:"更新邮箱",width:"420px"},{footer:o(()=>[a(k,{onClick:e[2]||(e[2]=t=>g.value=!1)},{default:o(()=>e[16]||(e[16]=[p("取消",-1)])),_:1,__:[16]}),a(k,{type:"primary",loading:L.value,onClick:W},{default:o(()=>e[17]||(e[17]=[p("确定",-1)])),_:1,__:[17]},8,["loading"])]),default:o(()=>[a(oe,{model:y.value,"label-width":"80px"},{default:o(()=>[a(ae,{label:"邮箱"},{default:o(()=>[a(B,{modelValue:y.value.email,"onUpdate:modelValue":e[1]||(e[1]=t=>y.value.email=t),placeholder:"请输入新的邮箱地址"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Tt=ne(gt,[["__scopeId","data-v-63f5fb4e"]]);export{Tt as default};
