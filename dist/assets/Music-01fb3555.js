import{_ as le,u as ae,a as se,r as m,n as oe,p as ne,o as C,c as A,d as o,e as t,w as a,t as u,s as i,x as r,y as U,z as ie,A as re,B as ue,C as de,k as ce,i as me,U as _e,Z as pe,h as _,G as fe,H as ve,I as ge,J as I,$ as he,M as we,a0 as be,v as ye,N as Le,O as xe,a2 as Ce,a3 as Ve,an as Ee,a8 as Me,P as ke,Q as Ae,R as Ne,ad as De,T as Be,ac as Ie,af as Te,j as ze,l as Fe,F as Ue}from"./index-ebe2b180.js";/* empty css                   *//* empty css                   *//* empty css                     *//* empty css                  *//* empty css                        *//* empty css               *//* empty css                 */import{m as V}from"./music-02d5a60f.js";const $e={class:"music-layout"},Re={class:"header"},Se={class:"header-right"},qe={class:"user-info"},je={class:"username"},Ge={class:"main-container"},He={class:"sidebar"},Je={class:"content"},Ke={class:"toolbar"},Oe={class:"toolbar-left"},Pe={class:"toolbar-right"},Qe={class:"stats-row"},Ze={class:"stat-card total"},We={class:"stat-icon"},Xe={class:"stat-info"},Ye={class:"stat-value"},et={class:"music-id"},tt={class:"music-title"},lt={class:"music-author"},at={class:"music-album"},st={class:"music-tags"},ot={key:0,class:"na-text"},nt={class:"table-actions"},it={__name:"Music",setup(rt){const $=ae(),N=se(),f=m(!1),D=m(!1),E=m([]),v=m(""),g=m(!1),h=m(null),y=m(),n=m({id:null,title:"",author:"",album:"",tagList:""}),R={title:[{required:!0,message:"请输入音乐标题",trigger:"blur"}],author:[{required:!0,message:"请输入作者名称",trigger:"blur"}],album:[{required:!0,message:"请输入专辑名称",trigger:"blur"}]},B=oe(()=>{if(!v.value)return E.value;const l=v.value.toLowerCase();return E.value.filter(e=>(e.title||"").toLowerCase().includes(l)||(e.author||"").toLowerCase().includes(l)||(e.album||"").toLowerCase().includes(l)||(e.tagList||"").toLowerCase().includes(l))}),S=l=>l?new Date(l).toLocaleString("zh-CN"):"N/A",L=async()=>{f.value=!0;try{const l=await V.getMusicList();l.code===200?E.value=l.data||[]:r.error(l.message||"加载音乐列表失败")}catch(l){console.error("加载音乐列表失败:",l),r.error("加载音乐列表失败")}finally{f.value=!1}},q=async()=>{if(v.value.trim()){f.value=!0;try{const l=await V.searchMusic(v.value.trim());l.code===200?E.value=l.data||[]:r.error(l.message||"搜索失败")}catch(l){console.error("搜索失败:",l),r.error("搜索失败")}finally{f.value=!1}}},T=()=>{h.value=null,n.value={id:null,title:"",author:"",album:"",tagList:""},y.value&&y.value.resetFields()},j=l=>{h.value=l,n.value={id:l.id,title:l.title||"",author:l.author||"",album:l.album||"",tagList:l.tagList||""},g.value=!0},G=async()=>{if(y.value){try{await y.value.validate()}catch{return}D.value=!0;try{let l;h.value?l=await V.updateMusic(n.value):l=await V.addMusic(n.value),l.code===200?(r.success(h.value?"更新音乐成功":"添加音乐成功"),g.value=!1,T(),await L()):r.error(l.message||"操作失败")}catch(l){console.error("操作失败:",l),r.error("操作失败")}finally{D.value=!1}}},H=async l=>{var e;try{await U.confirm(`确认删除音乐"${l.title}"？删除后无法恢复`,"警告",{type:"warning",confirmButtonText:"确认删除",cancelButtonText:"取消"});const c=await V.deleteMusic(l.id);c.code===200?(r.success("删除成功"),await L()):(e=c.message)!=null&&e.includes("歌曲信息不存在")?(r.error("该音乐不存在或已被删除"),await L()):r.error(c.message||"删除失败")}catch(c){c!=="cancel"&&(console.error("删除失败:",c),r.error("删除失败"))}},J=async l=>{if(l==="logout")try{await U.confirm("确认退出登录？","提示",{type:"warning"}),await N.logout(),$.push("/login")}catch{}};return ne(()=>{L()}),(l,e)=>{var F;const c=ie,w=re,K=ke,O=Ae,P=ue,M=Ne,Q=de,b=ce,x=me,p=De,Z=Be,z=Ie,W=Te,X=_e,k=ze,Y=Fe,ee=pe,te=Ue;return C(),A("div",$e,[o("header",Re,[e[9]||(e[9]=o("div",{class:"header-left"},[o("h1",{class:"system-title"},"抖音短视频分析系统")],-1)),o("div",Se,[o("div",qe,[t(c,{size:32,class:"user-avatar"},{default:a(()=>{var s,d;return[_(u((d=(s=i(N).user)==null?void 0:s.username)==null?void 0:d.charAt(0)),1)]}),_:1}),o("span",je,u((F=i(N).user)==null?void 0:F.username),1),t(P,{onCommand:J,class:"user-dropdown"},{dropdown:a(()=>[t(O,null,{default:a(()=>[t(K,{command:"logout"},{default:a(()=>e[8]||(e[8]=[_("退出登录",-1)])),_:1,__:[8]})]),_:1})]),default:a(()=>[t(w,{class:"dropdown-icon"},{default:a(()=>[t(i(fe))]),_:1})]),_:1})])])]),o("div",Ge,[o("nav",He,[t(Q,{"default-active":l.$route.path,router:"",class:"sidebar-menu"},{default:a(()=>[t(M,{index:"/dashboard",class:"menu-item"},{default:a(()=>[t(w,null,{default:a(()=>[t(i(ve))]),_:1}),e[10]||(e[10]=o("span",null,"数据概览",-1))]),_:1,__:[10]}),t(M,{index:"/monitor",class:"menu-item"},{default:a(()=>[t(w,null,{default:a(()=>[t(i(ge))]),_:1}),e[11]||(e[11]=o("span",null,"监控管理",-1))]),_:1,__:[11]}),t(M,{index:"/music",class:"menu-item"},{default:a(()=>[t(w,null,{default:a(()=>[t(i(I))]),_:1}),e[12]||(e[12]=o("span",null,"音乐管理",-1))]),_:1,__:[12]}),t(M,{index:"/music-monitor",class:"menu-item"},{default:a(()=>[t(w,null,{default:a(()=>[t(i(I))]),_:1}),e[13]||(e[13]=o("span",null,"音乐监控",-1))]),_:1,__:[13]})]),_:1},8,["default-active"])]),o("main",Je,[e[18]||(e[18]=o("div",{class:"page-header"},[o("h2",{class:"page-title"},"音乐管理"),o("p",{class:"page-desc"},"管理系统中的音乐库，支持音乐的增删改查操作")],-1)),o("div",Ke,[o("div",Oe,[t(b,{type:"primary",onClick:e[0]||(e[0]=s=>g.value=!0),icon:i(he)},{default:a(()=>e[14]||(e[14]=[_(" 添加音乐 ",-1)])),_:1,__:[14]},8,["icon"]),t(b,{onClick:L,loading:f.value,icon:i(we)},{default:a(()=>e[15]||(e[15]=[_(" 刷新 ",-1)])),_:1,__:[15]},8,["loading","icon"])]),o("div",Pe,[t(x,{modelValue:v.value,"onUpdate:modelValue":e[1]||(e[1]=s=>v.value=s),placeholder:"搜索音乐标题、作者或专辑","prefix-icon":i(be),style:{width:"300px"},clearable:"",onInput:q},null,8,["modelValue","prefix-icon"])])]),o("div",Qe,[o("div",Ze,[o("div",We,[t(w,{size:"20"},{default:a(()=>[t(i(I))]),_:1})]),o("div",Xe,[o("div",Ye,u(B.value.length),1),e[16]||(e[16]=o("div",{class:"stat-label"},"音乐总数",-1))])])]),t(X,{class:"music-table-card"},{header:a(()=>e[17]||(e[17]=[o("div",{class:"card-header"},[o("span",{class:"card-title"},"音乐列表")],-1)])),default:a(()=>[ye((C(),A("div",null,[t(W,{data:B.value,style:{width:"100%"},"empty-text":B.value.length===0?"暂无音乐数据":""},{default:a(()=>[t(p,{label:"ID",width:"80"},{default:a(({row:s})=>[o("span",et,u(s.id),1)]),_:1}),t(p,{label:"音乐标题","min-width":"200"},{default:a(({row:s})=>[o("div",tt,u(s.title||"N/A"),1)]),_:1}),t(p,{label:"作者","min-width":"150"},{default:a(({row:s})=>[o("div",lt,u(s.author||"N/A"),1)]),_:1}),t(p,{label:"专辑","min-width":"150"},{default:a(({row:s})=>[o("div",at,u(s.album||"N/A"),1)]),_:1}),t(p,{label:"标签","min-width":"150"},{default:a(({row:s})=>[o("div",st,[(C(!0),A(Le,null,xe((s.tagList||"").split(",").filter(d=>d.trim()),d=>(C(),Ce(Z,{key:d,size:"small",style:{"margin-right":"5px"}},{default:a(()=>[_(u(d.trim()),1)]),_:2},1024))),128)),!s.tagList||!s.tagList.trim()?(C(),A("span",ot,"N/A")):Ve("",!0)])]),_:1}),t(p,{label:"创建时间",width:"180"},{default:a(({row:s})=>[_(u(S(s.createTime)),1)]),_:1}),t(p,{label:"操作",width:"200",fixed:"right"},{default:a(({row:s})=>[o("div",nt,[t(z,{content:"编辑音乐",placement:"top"},{default:a(()=>[t(b,{type:"primary",size:"small",icon:i(Ee),onClick:d=>j(s),link:""},null,8,["icon","onClick"])]),_:2},1024),t(z,{content:"删除音乐",placement:"top"},{default:a(()=>[t(b,{type:"danger",size:"small",icon:i(Me),onClick:d=>H(s),link:""},null,8,["icon","onClick"])]),_:2},1024)])]),_:1})]),_:1},8,["data","empty-text"])])),[[te,f.value]])]),_:1})])]),t(ee,{modelValue:g.value,"onUpdate:modelValue":e[7]||(e[7]=s=>g.value=s),title:h.value?"编辑音乐":"添加音乐",width:"500px",onClose:T},{footer:a(()=>[t(b,{onClick:e[6]||(e[6]=s=>g.value=!1)},{default:a(()=>e[19]||(e[19]=[_("取消",-1)])),_:1,__:[19]}),t(b,{type:"primary",onClick:G,loading:D.value},{default:a(()=>[_(u(h.value?"更新":"添加"),1)]),_:1},8,["loading"])]),default:a(()=>[t(Y,{model:n.value,rules:R,ref_key:"formRef",ref:y,"label-width":"100px"},{default:a(()=>[t(k,{label:"音乐标题",prop:"title"},{default:a(()=>[t(x,{modelValue:n.value.title,"onUpdate:modelValue":e[2]||(e[2]=s=>n.value.title=s),placeholder:"请输入音乐标题"},null,8,["modelValue"])]),_:1}),t(k,{label:"作者",prop:"author"},{default:a(()=>[t(x,{modelValue:n.value.author,"onUpdate:modelValue":e[3]||(e[3]=s=>n.value.author=s),placeholder:"请输入作者名称"},null,8,["modelValue"])]),_:1}),t(k,{label:"专辑",prop:"album"},{default:a(()=>[t(x,{modelValue:n.value.album,"onUpdate:modelValue":e[4]||(e[4]=s=>n.value.album=s),placeholder:"请输入专辑名称"},null,8,["modelValue"])]),_:1}),t(k,{label:"标签",prop:"tagList"},{default:a(()=>[t(x,{modelValue:n.value.tagList,"onUpdate:modelValue":e[5]||(e[5]=s=>n.value.tagList=s),placeholder:"请输入标签，用逗号分隔（如：流行,抒情）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},ht=le(it,[["__scopeId","data-v-e3c8ac87"]]);export{ht as default};
