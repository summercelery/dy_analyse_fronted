/* empty css                  *//* empty css                 *//* empty css                        *//* empty css                  *//* empty css                 *//* empty css                           */import{u as Dt,ao as Tt,a as xt,r as g,n as M,p as Bt,q as c,o as u,c as p,d as e,e as s,w as n,t as l,s as tt,a2 as D,N as et,O as st,ap as T,a1 as ot,x,y as Lt,z as $t,A as Nt,B as Ut,C as At,aq as Rt,k as Pt,i as Ft,ar as Ot,ae as qt,h as d,f as at,P as Gt,Q as Ht,R as Wt,as as Kt,T as Qt,ab as jt,ac as Jt,S as Xt}from"./index-615a714d.js";import{m as nt}from"./music-263a48e5.js";import{v as Yt}from"./video-91d2a661.js";import{_ as Zt}from"./_plugin-vue_export-helper-c27b6911.js";const te={class:"music-detail-layout"},ee={class:"header"},se={class:"header-right"},oe={class:"user-info"},ae={class:"username"},ne={class:"main-container"},le={class:"sidebar"},ie={class:"content"},de={class:"breadcrumb-container"},ce={key:0,class:"music-info-card"},re={class:"music-info-header"},ue={class:"music-icon"},_e={class:"music-details"},me={class:"music-title"},pe={class:"music-meta"},ve={class:"music-author"},fe={key:0,class:"music-album"},he={key:0,class:"music-tags"},ge={class:"music-actions"},we={class:"search-bar"},ye={class:"stats-row"},be={class:"stat-icon"},Ce={class:"stat-info"},ke={class:"stat-value"},Ie={class:"stat-icon"},Me={class:"stat-info"},Ve={class:"stat-value"},Ee={class:"stat-icon"},Se={class:"stat-info"},ze={class:"stat-value"},De={class:"stat-icon"},Te={class:"stat-info"},xe={class:"stat-value"},Be={class:"monitor-list-card"},Le={class:"card-header"},$e={class:"card-actions"},Ne={key:0,class:"video-grid"},Ue=["onClick"],Ae={class:"video-header"},Re={class:"video-status"},Pe={class:"video-actions"},Fe={class:"video-content"},Oe={class:"video-id"},qe=["title"],Ge={class:"video-time"},He={class:"video-stats"},We={class:"stat-item"},Ke={class:"stat-item"},Qe={class:"stat-item"},je={class:"stat-item"},Je={class:"video-footer"},Xe={class:"video-dates"},Ye={class:"create-time"},Ze={key:1,class:"video-table"},ts={class:"video-id-text"},es={class:"video-url-text"},ss={class:"stat-number"},os={class:"stat-number"},as={class:"stat-number"},ns={class:"stat-number"},ls={__name:"MusicMonitorDetail",setup(is){const B=Dt(),R=Tt(),L=xt(),b=g(!1),m=g(null),h=g([]),$=g(new Map),V=g(""),C=g("grid"),w=g("all"),N=M(()=>h.value),P=M(()=>h.value.filter(o=>o.status===1)),F=M(()=>h.value.filter(o=>o.status===2||o.status===3)),O=M(()=>h.value.filter(o=>o.type===0)),U=M(()=>{let o=[];switch(w.value){case"all":o=N.value;break;case"monitoring":o=P.value;break;case"error":o=F.value;break;case"auto":o=O.value;break;default:o=N.value}if(V.value){const t=V.value.toLowerCase();o=o.filter(_=>{var S,i;return((S=_.awemeId)==null?void 0:S.toLowerCase().includes(t))||((i=_.videoUrl)==null?void 0:i.toLowerCase().includes(t))})}return o}),lt=async()=>{const o=R.params.musicId;if(o)try{const t=await nt.getMusicById(o);t.code===200?m.value=t.data:x.error(t.message||"获取音乐信息失败")}catch(t){console.error("获取音乐信息失败:",t),x.error("获取音乐信息失败")}},q=async()=>{const o=R.params.musicId;if(o){b.value=!0;try{const t=await nt.getMonitorVideosByMusicId(o);t.code===200?(h.value=t.data||[],await it()):x.error(t.message||"获取监控视频失败")}catch(t){console.error("获取监控视频失败:",t),x.error("获取监控视频失败")}finally{b.value=!1}}},it=async()=>{if(h.value.length===0)return;const o=h.value.map(async t=>{try{const _=await Yt.getLatestVideoStats(t.awemeId);_.code===200&&_.data&&$.value.set(t.awemeId,_.data)}catch(_){console.error(`获取视频 ${t.awemeId} 统计数据失败:`,_),$.value.set(t.awemeId,{diggCount:0,commentCount:0,collectCount:0,shareCount:0})}});await Promise.all(o)},v=o=>$.value.get(o)||{diggCount:0,commentCount:0,collectCount:0,shareCount:0},E=o=>{w.value=o},G=o=>{B.push(`/stats/${o}`)},H=o=>{window.open(o,"_blank")},dt=()=>{B.push("/music-monitor")},W=o=>({1:"success",0:"warning",2:"danger",3:"danger"})[o]||"info",K=o=>({1:"监控中",0:"已停用",2:"已删除",3:"失败"})[o]||"未知",Q=o=>o?o.length>50?o.substring(0,50)+"...":o:"",j=o=>o?new Date(o).toLocaleDateString("zh-CN"):"-",J=o=>o?new Date(o*1e3).toLocaleDateString("zh-CN"):"-",f=o=>o==null?"0":o>=1e4?(o/1e4).toFixed(1)+"w":o>=1e3?(o/1e3).toFixed(1)+"k":o.toString(),ct=async o=>{if(o==="logout")try{await Lt.confirm("确认退出登录？","提示",{type:"warning"}),await L.logout(),B.push("/login")}catch{}};return Bt(()=>{lt(),q()}),(o,t)=>{var Z;const _=$t,S=c("ArrowDown"),i=Nt,rt=Gt,ut=Ht,_t=Ut,mt=c("Odometer"),z=Wt,pt=c("View"),vt=c("Headset"),X=c("MusicNote"),ft=At,Y=Kt,ht=Rt,k=Qt,y=Pt,gt=Ft,wt=c("VideoCamera"),yt=c("CircleCheck"),bt=c("Warning"),Ct=c("MagicStick"),kt=Ot,A=jt,It=c("Star"),Mt=c("ChatDotRound"),Vt=c("Collection"),Et=c("Share"),r=Jt,St=qt,zt=Xt;return u(),p("div",te,[e("header",ee,[t[9]||(t[9]=e("div",{class:"header-left"},[e("h1",{class:"system-title"},"抖音短视频分析系统")],-1)),e("div",se,[e("div",oe,[s(_,{size:32,class:"user-avatar"},{default:n(()=>{var a,I;return[d(l((I=(a=tt(L).user)==null?void 0:a.username)==null?void 0:I.charAt(0)),1)]}),_:1}),e("span",ae,l((Z=tt(L).user)==null?void 0:Z.username),1),s(_t,{onCommand:ct,class:"user-dropdown"},{dropdown:n(()=>[s(ut,null,{default:n(()=>[s(rt,{command:"logout"},{default:n(()=>t[8]||(t[8]=[d("退出登录",-1)])),_:1,__:[8]})]),_:1})]),default:n(()=>[s(i,{class:"dropdown-icon"},{default:n(()=>[s(S)]),_:1})]),_:1})])])]),e("div",ne,[e("nav",le,[s(ft,{"default-active":o.$route.path,router:"",class:"sidebar-menu"},{default:n(()=>[s(z,{index:"/dashboard",class:"menu-item"},{default:n(()=>[s(i,null,{default:n(()=>[s(mt)]),_:1}),t[10]||(t[10]=e("span",null,"数据概览",-1))]),_:1,__:[10]}),s(z,{index:"/monitor",class:"menu-item"},{default:n(()=>[s(i,null,{default:n(()=>[s(pt)]),_:1}),t[11]||(t[11]=e("span",null,"监控管理",-1))]),_:1,__:[11]}),s(z,{index:"/music-monitor",class:"menu-item"},{default:n(()=>[s(i,null,{default:n(()=>[s(vt)]),_:1}),t[12]||(t[12]=e("span",null,"音乐监控",-1))]),_:1,__:[12]}),s(z,{index:"/music",class:"menu-item"},{default:n(()=>[s(i,null,{default:n(()=>[s(X)]),_:1}),t[13]||(t[13]=e("span",null,"音乐管理",-1))]),_:1,__:[13]})]),_:1},8,["default-active"])]),e("main",ie,[e("div",de,[s(ht,{separator:"/"},{default:n(()=>[s(Y,{to:{path:"/music-monitor"}},{default:n(()=>t[14]||(t[14]=[d("音乐监控",-1)])),_:1,__:[14]}),s(Y,null,{default:n(()=>{var a;return[d(l(((a=m.value)==null?void 0:a.title)||"音乐详情"),1)]}),_:1})]),_:1})]),m.value?(u(),p("div",ce,[e("div",re,[e("div",ue,[s(i,{size:"32"},{default:n(()=>[s(X)]),_:1})]),e("div",_e,[e("h2",me,l(m.value.title),1),e("p",pe,[e("span",ve,l(m.value.author),1),m.value.album?(u(),p("span",fe,"• "+l(m.value.album),1)):D("",!0)]),m.value.tagList?(u(),p("div",he,[(u(!0),p(et,null,st(m.value.tagList.split(","),a=>(u(),ot(k,{key:a,size:"small",class:"music-tag"},{default:n(()=>[d(l(a),1)]),_:2},1024))),128))])):D("",!0)]),e("div",ge,[s(y,{onClick:dt,icon:o.ArrowLeft},{default:n(()=>t[15]||(t[15]=[d("返回",-1)])),_:1,__:[15]},8,["icon"]),s(y,{onClick:q,loading:b.value,icon:o.Refresh},{default:n(()=>t[16]||(t[16]=[d(" 刷新 ",-1)])),_:1,__:[16]},8,["loading","icon"])])])])):D("",!0),e("div",we,[s(gt,{modelValue:V.value,"onUpdate:modelValue":t[0]||(t[0]=a=>V.value=a),placeholder:"搜索视频ID或链接","prefix-icon":o.Search,style:{width:"400px"},clearable:"",size:"large"},null,8,["modelValue","prefix-icon"])]),e("div",ye,[e("div",{class:T(["stat-card total",{active:w.value==="all"}]),onClick:t[1]||(t[1]=a=>E("all"))},[e("div",be,[s(i,{size:"20"},{default:n(()=>[s(wt)]),_:1})]),e("div",Ce,[e("div",ke,l(N.value.length),1),t[17]||(t[17]=e("div",{class:"stat-label"},"监控视频总数",-1))])],2),e("div",{class:T(["stat-card monitoring",{active:w.value==="monitoring"}]),onClick:t[2]||(t[2]=a=>E("monitoring"))},[e("div",Ie,[s(i,{size:"20"},{default:n(()=>[s(yt)]),_:1})]),e("div",Me,[e("div",Ve,l(P.value.length),1),t[18]||(t[18]=e("div",{class:"stat-label"},"监控中",-1))])],2),e("div",{class:T(["stat-card error",{active:w.value==="error"}]),onClick:t[3]||(t[3]=a=>E("error"))},[e("div",Ee,[s(i,{size:"20"},{default:n(()=>[s(bt)]),_:1})]),e("div",Se,[e("div",ze,l(F.value.length),1),t[19]||(t[19]=e("div",{class:"stat-label"},"异常监控",-1))])],2),e("div",{class:T(["stat-card auto",{active:w.value==="auto"}]),onClick:t[4]||(t[4]=a=>E("auto"))},[e("div",De,[s(i,{size:"20"},{default:n(()=>[s(Ct)]),_:1})]),e("div",Te,[e("div",xe,l(O.value.length),1),t[20]||(t[20]=e("div",{class:"stat-label"},"自动添加",-1))])],2)]),e("div",Be,[e("div",Le,[t[23]||(t[23]=e("h3",{class:"card-title"},"监控视频列表",-1)),e("div",$e,[s(kt,null,{default:n(()=>[s(y,{type:C.value==="grid"?"primary":"",onClick:t[5]||(t[5]=a=>C.value="grid"),icon:o.Grid},{default:n(()=>t[21]||(t[21]=[d(" 网格视图 ",-1)])),_:1,__:[21]},8,["type","icon"]),s(y,{type:C.value==="list"?"primary":"",onClick:t[6]||(t[6]=a=>C.value="list"),icon:o.List},{default:n(()=>t[22]||(t[22]=[d(" 列表视图 ",-1)])),_:1,__:[22]},8,["type","icon"])]),_:1})])]),C.value==="grid"?(u(),p("div",Ne,[(u(!0),p(et,null,st(U.value,a=>(u(),p("div",{key:a.id,class:"video-card",onClick:I=>G(a.awemeId)},[e("div",Ae,[e("div",Re,[s(k,{type:W(a.status),size:"small"},{default:n(()=>[d(l(K(a.status)),1)]),_:2},1032,["type"]),s(k,{type:a.type===1?"primary":"info",size:"small"},{default:n(()=>[d(l(a.type===1?"手动":"自动"),1)]),_:2},1032,["type"])]),e("div",Pe,[s(A,{content:"打开视频",placement:"top"},{default:n(()=>[s(y,{type:"success",size:"small",icon:o.Link,circle:"",onClick:at(I=>H(a.videoUrl),["stop"])},null,8,["icon","onClick"])]),_:2},1024)])]),e("div",Fe,[e("div",Oe,l(a.awemeId),1),e("div",{class:"video-url",title:a.videoUrl},l(Q(a.videoUrl)),9,qe),e("div",Ge," 发布时间："+l(J(a.videoPublishTime)),1),e("div",He,[e("div",We,[s(i,null,{default:n(()=>[s(It)]),_:1}),e("span",null,l(f(v(a.awemeId).diggCount)),1)]),e("div",Ke,[s(i,null,{default:n(()=>[s(Mt)]),_:1}),e("span",null,l(f(v(a.awemeId).commentCount)),1)]),e("div",Qe,[s(i,null,{default:n(()=>[s(Vt)]),_:1}),e("span",null,l(f(v(a.awemeId).collectCount)),1)]),e("div",je,[s(i,null,{default:n(()=>[s(Et)]),_:1}),e("span",null,l(f(v(a.awemeId).shareCount)),1)])])]),e("div",Je,[e("div",Xe,[e("div",Ye," 添加时间："+l(j(a.createTime)),1)])])],8,Ue))),128))])):(u(),p("div",Ze,[s(St,{data:U.value,style:{width:"100%"},loading:b.value,"empty-text":"暂无监控视频",onRowClick:t[7]||(t[7]=a=>G(a.awemeId)),class:"clickable-table"},{default:n(()=>[s(r,{prop:"awemeId",label:"视频ID",width:"180"},{default:n(({row:a})=>[e("span",ts,l(a.awemeId),1)]),_:1}),s(r,{prop:"videoUrl",label:"视频链接","min-width":"200"},{default:n(({row:a})=>[s(A,{content:a.videoUrl,placement:"top"},{default:n(()=>[e("span",es,l(Q(a.videoUrl)),1)]),_:2},1032,["content"])]),_:1}),s(r,{prop:"type",label:"类型",width:"80"},{default:n(({row:a})=>[s(k,{type:a.type===1?"primary":"info",size:"small"},{default:n(()=>[d(l(a.type===1?"手动":"自动"),1)]),_:2},1032,["type"])]),_:1}),s(r,{prop:"status",label:"状态",width:"80"},{default:n(({row:a})=>[s(k,{type:W(a.status),size:"small"},{default:n(()=>[d(l(K(a.status)),1)]),_:2},1032,["type"])]),_:1}),s(r,{prop:"videoPublishTime",label:"发布时间",width:"120"},{default:n(({row:a})=>[d(l(J(a.videoPublishTime)),1)]),_:1}),s(r,{prop:"createTime",label:"添加时间",width:"120"},{default:n(({row:a})=>[d(l(j(a.createTime)),1)]),_:1}),s(r,{label:"点赞",width:"80"},{default:n(({row:a})=>[e("span",ss,l(f(v(a.awemeId).diggCount)),1)]),_:1}),s(r,{label:"评论",width:"80"},{default:n(({row:a})=>[e("span",os,l(f(v(a.awemeId).commentCount)),1)]),_:1}),s(r,{label:"收藏",width:"80"},{default:n(({row:a})=>[e("span",as,l(f(v(a.awemeId).collectCount)),1)]),_:1}),s(r,{label:"分享",width:"80"},{default:n(({row:a})=>[e("span",ns,l(f(v(a.awemeId).shareCount)),1)]),_:1}),s(r,{label:"操作",width:"80",fixed:"right"},{default:n(({row:a})=>[s(A,{content:"打开视频",placement:"top"},{default:n(()=>[s(y,{type:"success",size:"small",icon:o.Link,onClick:at(I=>H(a.videoUrl),["stop"])},null,8,["icon","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data","loading"])])),!b.value&&U.value.length===0?(u(),ot(zt,{key:2,description:"该音乐暂无监控视频","image-size":120})):D("",!0)])])])])}}},gs=Zt(ls,[["__scopeId","data-v-92d5abf2"]]);export{gs as default};
