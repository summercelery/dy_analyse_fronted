import{X as j,_ as tt,u as ot,a as st,r as x,n as H,p as lt,Y as at,o as V,c as b,d as s,e as o,w as l,t as c,s as _,x as u,y as W,z as nt,A as it,B as rt,C as ut,k as dt,i as ct,U as mt,Z as ft,h as p,G as vt,H as pt,I as _t,J as Ie,$ as xe,M as gt,a0 as ht,K as wt,L as Ve,a1 as ke,v as yt,a2 as fe,a3 as X,a4 as It,a5 as xt,a6 as Vt,a7 as kt,a8 as Et,N as Ee,a9 as Ct,aa as bt,O as Mt,ab as Dt,P as St,Q as At,R as Tt,ac as Lt,ad as Nt,ae as Pt,T as Ut,af as $t,ag as Rt,ah as zt,j as Ft,ai as Bt,aj as Ot,ak as Gt,al as qt,l as jt,am as Jt,F as Kt}from"./index-ebe2b180.js";/* empty css                   *//* empty css                   *//* empty css                     *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                        *//* empty css                 */import{m as z}from"./monitor-8c9caccc.js";import{m as Y}from"./music-02d5a60f.js";import{v as ne}from"./video-c44cf66a.js";const Ce={getAuthorInfo(S){return j({url:`/author/info/${S}`,method:"get"})},getAuthorByNickname(S){return j({url:`/author/nickname/${S}`,method:"get"})},searchAuthorByNickname(S){return j({url:`/author/search/nickname/${S}`,method:"get"})},getAuthorList(){return j({url:"/author/list",method:"get"})},getAuthorDetails(S){return j({url:`/author/details/${S}`,method:"get"})},searchAuthor(S){return j({url:"/author/search",method:"get",params:S})}};const Qt={class:"monitor-layout"},Ht={class:"header"},Wt={class:"header-right"},Xt={class:"user-info"},Yt={class:"username"},Zt={class:"main-container"},eo={class:"sidebar"},to={class:"content"},oo={class:"toolbar"},so={class:"toolbar-left"},lo={class:"toolbar-right"},ao={class:"stats-row"},no={class:"stat-card total"},io={class:"stat-icon"},ro={class:"stat-info"},uo={class:"stat-value"},co={class:"stat-card active"},mo={class:"stat-icon"},fo={class:"stat-info"},vo={class:"stat-value"},po={class:"stat-card inactive"},_o={class:"stat-icon"},go={class:"stat-info"},ho={class:"stat-value"},wo={class:"card-header"},yo={class:"header-actions"},Io={class:"video-id"},xo={class:"video-url-wrap"},Vo={key:1,class:"na-text"},ko={class:"author-name"},Eo={class:"author-nickname"},Co={key:0,class:"author-followers"},bo={key:0,class:"music-info"},Mo={class:"music-title"},Do={class:"music-author"},So={key:1,class:"na-text"},Ao={key:0,class:"stats-preview"},To={class:"stats-item"},Lo={class:"stats-item"},No={key:1,class:"na-text"},Po={class:"publish-time"},Uo={class:"table-actions"},$o={style:{"line-height":"1.6"}},Ro={style:{margin:"8px 0"}},zo={style:{display:"flex",gap:"10px",width:"100%"}},Fo={style:{display:"flex","justify-content":"space-between","align-items":"center"}},Bo={style:{color:"#8492a6","font-size":"13px"}},Oo={class:"task-progress-container"},Go={class:"task-info"},qo={class:"progress-section"},jo={key:0,class:"progress-stats"},Jo={class:"stats-row"},Ko={class:"stats-row"},Qo={style:{color:"#67c23a"}},Ho={style:{color:"#909399"}},Wo={style:{color:"#f56c6c"}},Xo={key:0,class:"processing-tip"},Yo={key:1,class:"completed-message"},Zo={key:2,class:"failed-message"},es={__name:"Monitor",setup(S){const ve=ot(),ie=st(),Z=x(!1),re=x(!1),ue=x(!1),J=x([]),ee=x(""),A=x([]),te=x([]),G=x(!1),q=x(!1),K=x(!1),oe=x(!1),de=x(!1),F=x("single"),f=x({videoUrl:"",musicId:null,file:null}),M=x({title:"",author:"",album:"",tagList:""}),h=x({id:null,fileName:"",status:"PENDING",progress:0,totalCount:0,processedCount:0,successCount:0,skipCount:0,errorCount:0}),D=x(null),B=H(()=>ee.value?J.value.filter(t=>{var n,w,k,m,E;const e=((w=(n=t.monitorVideo)==null?void 0:n.awemeId)==null?void 0:w.toString())||"",v=((k=t.monitorVideo)==null?void 0:k.videoUrl)||"",i=((m=t.authorInfo)==null?void 0:m.nickname)||"",d=((E=t.videoInfo)==null?void 0:E.authorId)||"",r=ee.value.toLowerCase();return e.toLowerCase().includes(r)||v.toLowerCase().includes(r)||i.toLowerCase().includes(r)||d.toLowerCase().includes(r)}):J.value),be=H(()=>B.value.filter(t=>{var e;return((e=t.monitorVideo)==null?void 0:e.status)===1}));H(()=>B.value.filter(t=>{var e;return((e=t.monitorVideo)==null?void 0:e.status)===0})),H(()=>B.value.filter(t=>{var v;const e=(v=t.monitorVideo)==null?void 0:v.status;return e!==0&&e!==1}));const Me=H(()=>B.value.filter(t=>{var e;return((e=t.monitorVideo)==null?void 0:e.status)!==1})),pe=t=>t?t>=1e4?(t/1e4).toFixed(1)+"w":t.toString():"0",De=t=>t?new Date(t*1e3).toLocaleString("zh-CN"):"N/A",Se=t=>t?t>=1e4?(t/1e4).toFixed(1)+"w":t.toString():"0",Ae=t=>{switch(t){case 1:return"success";case 0:return"info";case 2:return"warning";case 3:return"danger";default:return"info"}},Te=t=>{switch(t){case 1:return"启用";case 0:return"停用";case 2:return"无权限";case 3:return"失败";default:return"未知"}},P=async()=>{Z.value=!0;try{const t=await z.getMonitorList();if(console.log("Monitor页面: 监控列表API响应:",t),t.code===200){const e=t.data||[];console.log("Monitor页面: 处理后的监控数据:",e),e.length>0&&console.log("Monitor页面: 第一条数据结构:",JSON.stringify(e[0],null,2));try{const v=await ne.getMonitorVideoDetails();if(console.log("Monitor页面: 详细信息API响应:",v),v.code===200){const i=v.data||[];console.log("Monitor页面: 详细信息数据:",i);const d=await Promise.all(e.map(async r=>{var E,T,C,O,U,g;const n=i.find(y=>{var $,se,L,le;return(($=y.monitor)==null?void 0:$.awemeId)===((se=r.monitorVideo)==null?void 0:se.awemeId)||((L=y.monitorVideo)==null?void 0:L.awemeId)===((le=r.monitorVideo)==null?void 0:le.awemeId)});let w=(n==null?void 0:n.music)||(n==null?void 0:n.musicInfo),k=n==null?void 0:n.video,m=null;if(!w&&((E=r.userMonitor)!=null&&E.musicId||(T=r.monitorVideo)!=null&&T.musicId))try{const y=((C=r.userMonitor)==null?void 0:C.musicId)||((O=r.monitorVideo)==null?void 0:O.musicId),$=await Y.getMusicById(y);$.code===200&&(w=$.data)}catch(y){console.warn("获取音乐信息失败:",y)}if(!k&&((U=r.monitorVideo)!=null&&U.awemeId))try{const y=await ne.getVideoInfo(r.monitorVideo.awemeId);y.code===200&&(k=y.data)}catch(y){console.warn("获取视频信息失败:",y)}if(k!=null&&k.authorId)try{const y=await Ce.getAuthorInfo(k.authorId);y.code===200&&(m=y.data)}catch(y){console.warn("获取播主信息失败:",y)}return{...r,musicInfo:w,videoInfo:k,authorInfo:m,latestStats:(n==null?void 0:n.latestStats)||((g=n==null?void 0:n.video)==null?void 0:g.latestStats),video:n==null?void 0:n.video}}));console.log("Monitor页面: 合并后的数据:",d),J.value=d}else{const i=await Promise.all(e.map(async d=>{var m,E,T,C,O,U;let r=null,n=null,w=null,k=null;if((m=d.userMonitor)!=null&&m.musicId||(E=d.monitorVideo)!=null&&E.musicId)try{const g=((T=d.userMonitor)==null?void 0:T.musicId)||((C=d.monitorVideo)==null?void 0:C.musicId),y=await Y.getMusicById(g);y.code===200&&(r=y.data)}catch(g){console.warn("获取音乐信息失败:",g)}if((O=d.monitorVideo)!=null&&O.awemeId)try{const g=await ne.getVideoInfo(d.monitorVideo.awemeId);g.code===200&&(n=g.data)}catch(g){console.warn("获取视频信息失败:",g)}if(n!=null&&n.authorId)try{const g=await Ce.getAuthorInfo(n.authorId);g.code===200&&(w=g.data)}catch(g){console.warn("获取播主信息失败:",g)}if((U=d.monitorVideo)!=null&&U.awemeId)try{const g=await ne.getLatestVideoStats(d.monitorVideo.awemeId);g.code===200&&(k=g.data)}catch(g){console.warn("获取统计数据失败:",g)}return{...d,musicInfo:r,videoInfo:n,authorInfo:w,latestStats:k}}));J.value=i}}catch(v){console.warn("Monitor页面: 获取详细信息失败，使用基础数据:",v),J.value=e}}else u.error(t.message||"加载监控列表失败")}catch(t){console.error("Monitor页面: 加载监控列表失败:",t),u.error("加载监控列表失败")}finally{Z.value=!1}},Le=async()=>{var t,e,v,i;if(!f.value.videoUrl.trim()){u.warning("请输入视频链接或ID");return}if(!f.value.musicId){u.warning("请选择音乐，音乐为必选项");return}re.value=!0;try{const d=await z.addMonitor({videoUrl:f.value.videoUrl.trim(),musicId:f.value.musicId});d.code===200?(u.success("添加监控成功"),G.value=!1,f.value={videoUrl:"",musicId:null},await P()):(t=d.message)!=null&&t.includes("音乐ID不能为空，音乐为必选项")?u.error("音乐为必选项，请选择一个音乐"):(e=d.message)!=null&&e.includes("指定的音乐不存在，请选择有效的音乐")?u.error("所选音乐不存在，请重新选择"):(v=d.message)!=null&&v.includes("视频链接不能为空")?u.error("请输入视频链接"):(i=d.message)!=null&&i.includes("添加失败，可能是链接格式错误或已存在")?u.error("视频链接格式错误或该视频已在监控中"):u.error(d.message||"添加监控失败")}catch{u.error("添加监控失败")}finally{re.value=!1}},ce=async()=>{if(!(te.value.length>0))try{const t=await Y.getMusicList();t.code===200&&(te.value=t.data||[])}catch(t){console.error("加载音乐列表失败:",t)}},Ne=async t=>{if(!t){await ce();return}ue.value=!0;try{const e=await Y.searchMusic(t);e.code===200&&(te.value=e.data||[])}catch(e){console.error("搜索音乐失败:",e)}finally{ue.value=!1}},_e=()=>{if(f.value={videoUrl:"",musicId:null,file:null},Q.value)try{Q.value.clearFiles()}catch(t){console.warn("清理上传组件失败:",t)}},Pe=()=>{const t=document.createElement("a");t.href="/监控视频模板.xlsx",t.download="监控视频模板.xlsx",document.body.appendChild(t),t.click(),document.body.removeChild(t)},Ue=async()=>{if(!M.value.title.trim()||!M.value.author.trim()){u.warning("请输入音乐标题和作者");return}try{const t=await Y.addMusic(M.value);t.code===200?(u.success("添加音乐成功"),K.value=!1,M.value={title:"",author:"",album:"",tagList:""},await ce()):u.error(t.message||"添加音乐失败")}catch(t){console.error("添加音乐失败:",t),u.error("添加音乐失败")}},Q=x(),$e=t=>{var i,d;if(console.log("文件选择:",t),!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv","application/csv"].includes(t.raw.type)&&!t.name.endsWith(".csv")){u.error("请选择 .xlsx、.xls 或 .csv 格式的文件");try{(i=Q.value)==null||i.clearFiles()}catch(r){console.warn("清理上传文件失败:",r)}f.value.file=null;return}const v=10*1024*1024;if(t.raw.size>v){u.error("文件大小不能超过 10MB");try{(d=Q.value)==null||d.clearFiles()}catch(r){console.warn("清理上传文件失败:",r)}f.value.file=null;return}f.value.file=t.raw},Re=()=>{console.log("文件移除"),f.value.file=null},ze=async()=>{var t,e,v,i,d;if(!f.value.musicId){u.warning("请选择音乐，音乐为必选项");return}if(!f.value.file){u.warning("请选择要上传的Excel文件");return}if(!f.value.file.name){u.error("文件信息不完整，请重新选择文件"),f.value.file=null;return}de.value=!0;try{const r=new FormData;r.append("file",f.value.file),r.append("musicId",f.value.musicId.toString()),console.log("开始上传Excel文件:",{fileName:f.value.file.name,fileSize:f.value.file.size,musicId:f.value.musicId});const n=await z.uploadExcelAsync(r);if(n.code===200){const{taskId:w,message:k}=n.data;u.success("文件上传成功，正在后台处理中...");const m=((t=f.value.file)==null?void 0:t.name)||"未知文件";G.value=!1,_e(),Fe(w,m)}else{let w=n.message||"Excel上传失败";(e=n.message)!=null&&e.includes("请选择要上传的Excel文件")?w="请选择要上传的Excel文件":(v=n.message)!=null&&v.includes("文件格式不正确，请上传Excel文件(.xlsx或.xls)")?w="文件格式不正确，请上传Excel文件(.xlsx或.xls)":(i=n.message)!=null&&i.includes("音乐ID不能为空，音乐为必选项")?w="音乐为必选项，请选择音乐":(d=n.message)!=null&&d.includes("指定的音乐不存在，请选择有效的音乐")&&(w="所选音乐不存在，请重新选择音乐"),u.error(w)}}catch(r){console.error("Excel上传失败:",r),u.error("Excel上传失败，请检查网络连接后重试")}finally{de.value=!1}},Fe=(t,e)=>{h.value={id:t,fileName:e,status:"PENDING",progress:0,totalCount:0,processedCount:0,successCount:0,skipCount:0,errorCount:0},oe.value=!0,Be()},Be=()=>{D.value&&clearInterval(D.value),D.value=setInterval(async()=>{try{const t=await z.getTaskProgress(h.value.id);if(t.code===200){const e=t.data;h.value={...h.value,...e},(e.status==="COMPLETED"||e.status==="FAILED")&&(clearInterval(D.value),D.value=null,e.status==="COMPLETED"&&await P())}}catch(t){console.error("查询任务进度失败:",t)}},2e3)},ge=()=>{D.value&&(clearInterval(D.value),D.value=null),oe.value=!1},Oe=t=>{switch(t){case"PENDING":return"等待处理";case"PROCESSING":return"处理中";case"COMPLETED":return"已完成";case"FAILED":return"处理失败";default:return"未知状态"}},Ge=t=>{switch(t){case"PENDING":return"info";case"PROCESSING":return"warning";case"COMPLETED":return"success";case"FAILED":return"danger";default:return"info"}},qe=t=>{t?ve.push(`/stats/${t}`):u.warning("视频ID无效")},je=async t=>{var d;const v=((d=t.monitorVideo)==null?void 0:d.status)===1?0:1,i=v===1?"启用":"停用";try{await W.confirm(`确认${i}该监控视频？`,"提示",{type:"warning"});const r=await z.updateStatus(t.monitorVideo.id,{status:v});r.code===200?(await P(),u.success(`${i}成功`)):u.error(r.message||`${i}失败`)}catch(r){r!=="cancel"&&u.error(`${i}失败`)}},Je=async t=>{try{await W.confirm("确认删除该监控视频？删除后无法恢复","警告",{type:"warning",confirmButtonText:"确认删除",cancelButtonText:"取消"});const e=await z.deleteMonitor(t.monitorVideo.id);e.code===200?(await P(),u.success("删除成功")):u.error(e.message||"删除失败")}catch(e){e!=="cancel"&&u.error("删除失败")}},Ke=t=>{A.value=t},he=async t=>{const e=t===1?"启用":"停用";try{await W.confirm(`确认批量${e}选中的 ${A.value.length} 个监控项？`,"提示",{type:"warning"});const v=A.value.map(i=>z.updateStatus(i.monitorVideo.id,{status:t}));await Promise.all(v),await P(),q.value=!1,A.value=[],u.success(`批量${e}成功`)}catch(v){v!=="cancel"&&u.error(`批量${e}失败`)}},Qe=async()=>{try{await W.confirm(`确认批量删除选中的 ${A.value.length} 个监控项？删除后无法恢复`,"警告",{type:"warning",confirmButtonText:"确认删除",cancelButtonText:"取消"});const t=A.value.map(e=>z.deleteMonitor(e.monitorVideo.id));await Promise.all(t),await P(),q.value=!1,A.value=[],u.success("批量删除成功")}catch(t){t!=="cancel"&&u.error("批量删除失败")}},He=async t=>{if(t==="logout")try{await W.confirm("确认退出登录？","提示",{type:"warning"}),await ie.logout(),ve.push("/login")}catch{}};return lt(()=>{P()}),at(()=>{D.value&&(clearInterval(D.value),D.value=null)}),(t,e)=>{var ye;const v=nt,i=it,d=St,r=At,n=rt,w=Tt,k=ut,m=dt,E=ct,T=Lt,C=Nt,O=Pt,U=Ut,g=$t,y=mt,$=Rt,se=zt,L=Ft,le=Bt,We=Ot,Xe=Gt,Ye=qt,we=jt,ae=ft,Ze=Jt,et=Kt;return V(),b("div",Qt,[s("header",Ht,[e[22]||(e[22]=s("div",{class:"header-left"},[s("h1",{class:"system-title"},"抖音短视频分析系统")],-1)),s("div",Wt,[s("div",Xt,[o(v,{size:32,class:"user-avatar"},{default:l(()=>{var a,I;return[p(c((I=(a=_(ie).user)==null?void 0:a.username)==null?void 0:I.charAt(0)),1)]}),_:1}),s("span",Yt,c((ye=_(ie).user)==null?void 0:ye.username),1),o(n,{onCommand:He,class:"user-dropdown"},{dropdown:l(()=>[o(r,null,{default:l(()=>[o(d,{command:"logout"},{default:l(()=>e[21]||(e[21]=[p("退出登录",-1)])),_:1,__:[21]})]),_:1})]),default:l(()=>[o(i,{class:"dropdown-icon"},{default:l(()=>[o(_(vt))]),_:1})]),_:1})])])]),s("div",Zt,[s("nav",eo,[o(k,{"default-active":t.$route.path,router:"",class:"sidebar-menu"},{default:l(()=>[o(w,{index:"/dashboard",class:"menu-item"},{default:l(()=>[o(i,null,{default:l(()=>[o(_(pt))]),_:1}),e[23]||(e[23]=s("span",null,"数据概览",-1))]),_:1,__:[23]}),o(w,{index:"/monitor",class:"menu-item"},{default:l(()=>[o(i,null,{default:l(()=>[o(_(_t))]),_:1}),e[24]||(e[24]=s("span",null,"监控管理",-1))]),_:1,__:[24]}),o(w,{index:"/music",class:"menu-item"},{default:l(()=>[o(i,null,{default:l(()=>[o(_(Ie))]),_:1}),e[25]||(e[25]=s("span",null,"音乐管理",-1))]),_:1,__:[25]}),o(w,{index:"/music-monitor",class:"menu-item"},{default:l(()=>[o(i,null,{default:l(()=>[o(_(Ie))]),_:1}),e[26]||(e[26]=s("span",null,"音乐监控",-1))]),_:1,__:[26]})]),_:1},8,["default-active"])]),s("main",to,[e[34]||(e[34]=s("div",{class:"page-header"},[s("h2",{class:"page-title"},"监控管理"),s("p",{class:"page-desc"},"管理您的抖音视频监控任务，实时掌握数据变化")],-1)),s("div",oo,[s("div",so,[o(m,{type:"primary",onClick:e[0]||(e[0]=a=>G.value=!0),icon:_(xe)},{default:l(()=>e[27]||(e[27]=[p(" 添加监控 ",-1)])),_:1,__:[27]},8,["icon"]),o(m,{onClick:P,loading:Z.value,icon:_(gt)},{default:l(()=>e[28]||(e[28]=[p(" 刷新 ",-1)])),_:1,__:[28]},8,["loading","icon"])]),s("div",lo,[o(E,{modelValue:ee.value,"onUpdate:modelValue":e[1]||(e[1]=a=>ee.value=a),placeholder:"搜索视频ID、链接或播主名称","prefix-icon":_(ht),style:{width:"300px"},clearable:""},null,8,["modelValue","prefix-icon"])])]),s("div",ao,[s("div",no,[s("div",io,[o(i,{size:"20"},{default:l(()=>[o(_(wt))]),_:1})]),s("div",ro,[s("div",uo,c(B.value.length),1),e[29]||(e[29]=s("div",{class:"stat-label"},"总监控数",-1))])]),s("div",co,[s("div",mo,[o(i,{size:"20"},{default:l(()=>[o(_(Ve))]),_:1})]),s("div",fo,[s("div",vo,c(be.value.length),1),e[30]||(e[30]=s("div",{class:"stat-label"},"监控中",-1))])]),s("div",po,[s("div",_o,[o(i,{size:"20"},{default:l(()=>[o(_(ke))]),_:1})]),s("div",go,[s("div",ho,c(Me.value.length),1),e[31]||(e[31]=s("div",{class:"stat-label"},"未启用",-1))])])]),o(y,{class:"monitor-table-card"},{header:l(()=>[s("div",wo,[e[32]||(e[32]=s("span",{class:"card-title"},"监控列表",-1)),s("div",yo,[o(T,{content:"批量操作",placement:"top"},{default:l(()=>[o(m,{disabled:A.value.length===0,onClick:e[2]||(e[2]=a=>q.value=!0),size:"small"},{default:l(()=>[p(" 批量操作 ("+c(A.value.length)+") ",1)]),_:1},8,["disabled"])]),_:1})])])]),default:l(()=>[yt((V(),b("div",null,[o(g,{data:B.value,style:{width:"100%"},onSelectionChange:Ke,"empty-text":B.value.length===0?"暂无监控数据":"",size:"default","cell-style":{padding:"8px 6px"},"header-cell-style":{padding:"10px 6px",background:"#fafafa"}},{default:l(()=>[o(C,{type:"selection",width:"50"}),o(C,{label:"视频ID",width:"140"},{default:l(({row:a})=>{var I;return[s("div",Io,c(((I=a.monitorVideo)==null?void 0:I.awemeId)||"N/A"),1)]}),_:1}),o(C,{label:"视频链接",width:"280"},{default:l(({row:a})=>{var I;return[s("div",xo,[(I=a.monitorVideo)!=null&&I.videoUrl?(V(),fe(O,{key:0,href:a.monitorVideo.videoUrl,target:"_blank",type:"primary",class:"video-link"},{default:l(()=>[p(c(a.monitorVideo.videoUrl),1)]),_:2},1032,["href"])):(V(),b("span",Vo,"N/A"))])]}),_:1}),o(C,{label:"播主名称",width:"140"},{default:l(({row:a})=>{var I,N,R;return[s("div",ko,[s("div",Eo,c(((I=a.authorInfo)==null?void 0:I.nickname)||((N=a.videoInfo)==null?void 0:N.authorId)||"N/A"),1),(R=a.authorInfo)!=null&&R.followerCount?(V(),b("div",Co," 粉丝: "+c(Se(a.authorInfo.followerCount)),1)):X("",!0)])]}),_:1}),o(C,{label:"状态",width:"100",align:"center"},{default:l(({row:a})=>{var I;return[o(U,{type:Ae((I=a.monitorVideo)==null?void 0:I.status),size:"small",class:"status-tag"},{default:l(()=>{var N;return[p(c(Te((N=a.monitorVideo)==null?void 0:N.status)),1)]}),_:2},1032,["type"])]}),_:1}),o(C,{label:"关联音乐",width:"130"},{default:l(({row:a})=>[a.musicInfo?(V(),b("div",bo,[s("div",Mo,c(a.musicInfo.title),1),s("div",Do,c(a.musicInfo.author),1)])):(V(),b("span",So,"未关联音乐"))]),_:1}),o(C,{label:"最新数据",width:"140"},{default:l(({row:a})=>[a.latestStats?(V(),b("div",Ao,[s("div",To,[e[33]||(e[33]=s("div",{class:"heart-icon"},[s("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor"},[s("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})])],-1)),s("span",null,c(pe(a.latestStats.diggCount||0)),1)]),s("div",Lo,[o(i,{size:"14"},{default:l(()=>[o(_(It))]),_:1}),s("span",null,c(pe(a.latestStats.commentCount||0)),1)])])):(V(),b("span",No,"暂无数据"))]),_:1}),o(C,{label:"发布时间",width:"160",align:"center"},{default:l(({row:a})=>{var I;return[s("div",Po,c(De((I=a.monitorVideo)==null?void 0:I.videoPublishTime)),1)]}),_:1}),o(C,{label:"操作",width:"160",fixed:"right"},{default:l(({row:a})=>{var I;return[s("div",Uo,[o(T,{content:"查看统计",placement:"top"},{default:l(()=>[o(m,{type:"primary",size:"small",icon:_(xt),onClick:N=>{var R;return qe((R=a.monitorVideo)==null?void 0:R.awemeId)},link:""},null,8,["icon","onClick"])]),_:2},1024),o(T,{content:((I=a.monitorVideo)==null?void 0:I.status)===1?"停用监控":"启用监控",placement:"top"},{default:l(()=>{var N,R;return[o(m,{type:((N=a.monitorVideo)==null?void 0:N.status)===1?"warning":"success",size:"small",icon:((R=a.monitorVideo)==null?void 0:R.status)===1?_(Vt):_(kt),onClick:me=>je(a),link:""},{default:l(()=>{var me;return[p(c(((me=a.monitorVideo)==null?void 0:me.status)===1?"停用":"启用"),1)]}),_:2},1032,["type","icon","onClick"])]}),_:2},1032,["content"]),o(T,{content:"删除监控",placement:"top"},{default:l(()=>[o(m,{type:"danger",size:"small",icon:_(Et),onClick:N=>Je(a),link:""},null,8,["icon","onClick"])]),_:2},1024)])]}),_:1})]),_:1},8,["data","empty-text"])])),[[et,Z.value]])]),_:1})])]),o(ae,{modelValue:G.value,"onUpdate:modelValue":e[9]||(e[9]=a=>G.value=a),title:"添加监控视频",width:"600px"},{footer:l(()=>[o(m,{onClick:e[7]||(e[7]=a=>G.value=!1)},{default:l(()=>e[43]||(e[43]=[p("取消",-1)])),_:1,__:[43]}),o(m,{type:"primary",onClick:e[8]||(e[8]=a=>F.value==="single"?Le():ze()),loading:F.value==="single"?re.value:de.value,disabled:F.value==="batch"&&(!f.value.musicId||!f.value.file)},{default:l(()=>[p(c(F.value==="single"?"添加监控":"开始导入"),1)]),_:1},8,["loading","disabled"])]),default:l(()=>[o(se,{modelValue:F.value,"onUpdate:modelValue":e[3]||(e[3]=a=>F.value=a),style:{"margin-bottom":"20px"},onChange:_e},{default:l(()=>[o($,{label:"single"},{default:l(()=>e[35]||(e[35]=[p("单个添加",-1)])),_:1,__:[35]}),o($,{label:"batch"},{default:l(()=>e[36]||(e[36]=[p("批量导入",-1)])),_:1,__:[36]})]),_:1},8,["modelValue"]),o(we,{model:f.value,"label-width":"100px"},{default:l(()=>[F.value==="single"?(V(),fe(L,{key:0,label:"视频链接"},{default:l(()=>[o(E,{modelValue:f.value.videoUrl,"onUpdate:modelValue":e[4]||(e[4]=a=>f.value.videoUrl=a),placeholder:"请输入抖音视频链接或ID"},null,8,["modelValue"])]),_:1})):(V(),b(Ee,{key:1},[o(le,{title:"批量导入说明",type:"info",closable:!1,"show-icon":"",style:{"margin-bottom":"20px"}},{default:l(()=>[s("div",$o,[e[38]||(e[38]=s("p",null,[s("strong",null,"Excel文件格式要求：")],-1)),e[39]||(e[39]=s("ul",{style:{margin:"8px 0","padding-left":"20px"}},[s("li",null,"支持 .xlsx、.xls 和 .csv 格式"),s("li",null,"第一行为标题行（监控视频地址），会被跳过"),s("li",null,"从第二行开始，第一列为视频链接")],-1)),s("p",Ro,[o(m,{type:"primary",size:"small",onClick:Pe,icon:_(Ct)},{default:l(()=>e[37]||(e[37]=[p(" 下载Excel模板 ",-1)])),_:1,__:[37]},8,["icon"])])])]),_:1}),o(L,{label:"Excel文件",required:""},{default:l(()=>[o(We,{ref_key:"uploadRef",ref:Q,"auto-upload":!1,"show-file-list":!0,limit:1,accept:".xlsx,.xls,.csv","on-change":$e,"on-remove":Re},{tip:l(()=>e[41]||(e[41]=[s("div",{class:"el-upload__tip",style:{color:"#909399","font-size":"12px","margin-top":"5px"}}," 支持 .xlsx/.xls/.csv 文件，且不超过 10MB ",-1)])),default:l(()=>[o(m,{icon:_(bt)},{default:l(()=>e[40]||(e[40]=[p("选择Excel文件",-1)])),_:1,__:[40]},8,["icon"])]),_:1},512)]),_:1})],64)),o(L,{label:"音乐选择",required:""},{default:l(()=>[s("div",zo,[o(Ye,{modelValue:f.value.musicId,"onUpdate:modelValue":e[5]||(e[5]=a=>f.value.musicId=a),placeholder:"请选择音乐（必填）",style:{flex:"1"},filterable:"",remote:"","remote-method":Ne,loading:ue.value,clearable:"",onFocus:ce},{default:l(()=>[(V(!0),b(Ee,null,Mt(te.value,a=>(V(),fe(Xe,{key:a.id,label:`${a.title} - ${a.author}`,value:a.id},{default:l(()=>[s("div",Fo,[s("span",null,c(a.title),1),s("span",Bo,c(a.author),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),o(m,{onClick:e[6]||(e[6]=a=>K.value=!0),icon:_(xe),size:"default"},{default:l(()=>e[42]||(e[42]=[p(" 新建 ",-1)])),_:1,__:[42]},8,["icon"])])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),o(ae,{modelValue:q.value,"onUpdate:modelValue":e[13]||(e[13]=a=>q.value=a),title:"批量操作",width:"400px"},{footer:l(()=>[o(m,{onClick:e[10]||(e[10]=a=>q.value=!1)},{default:l(()=>e[44]||(e[44]=[p("取消",-1)])),_:1,__:[44]}),o(m,{type:"success",onClick:e[11]||(e[11]=a=>he(1))},{default:l(()=>e[45]||(e[45]=[p(" 批量启用 ",-1)])),_:1,__:[45]}),o(m,{type:"warning",onClick:e[12]||(e[12]=a=>he(0))},{default:l(()=>e[46]||(e[46]=[p(" 批量停用 ",-1)])),_:1,__:[46]}),o(m,{type:"danger",onClick:Qe},{default:l(()=>e[47]||(e[47]=[p(" 批量删除 ",-1)])),_:1,__:[47]})]),default:l(()=>[s("p",null,"已选择 "+c(A.value.length)+" 个监控项",1)]),_:1},8,["modelValue"]),o(ae,{modelValue:K.value,"onUpdate:modelValue":e[19]||(e[19]=a=>K.value=a),title:"快速添加音乐",width:"500px"},{footer:l(()=>[o(m,{onClick:e[18]||(e[18]=a=>K.value=!1)},{default:l(()=>e[48]||(e[48]=[p("取消",-1)])),_:1,__:[48]}),o(m,{type:"primary",onClick:Ue},{default:l(()=>e[49]||(e[49]=[p(" 添加音乐 ",-1)])),_:1,__:[49]})]),default:l(()=>[o(we,{model:M.value,"label-width":"100px"},{default:l(()=>[o(L,{label:"音乐标题",required:""},{default:l(()=>[o(E,{modelValue:M.value.title,"onUpdate:modelValue":e[14]||(e[14]=a=>M.value.title=a),placeholder:"请输入音乐标题"},null,8,["modelValue"])]),_:1}),o(L,{label:"作者",required:""},{default:l(()=>[o(E,{modelValue:M.value.author,"onUpdate:modelValue":e[15]||(e[15]=a=>M.value.author=a),placeholder:"请输入作者名称"},null,8,["modelValue"])]),_:1}),o(L,{label:"专辑"},{default:l(()=>[o(E,{modelValue:M.value.album,"onUpdate:modelValue":e[16]||(e[16]=a=>M.value.album=a),placeholder:"请输入专辑名称"},null,8,["modelValue"])]),_:1}),o(L,{label:"标签"},{default:l(()=>[o(E,{modelValue:M.value.tagList,"onUpdate:modelValue":e[17]||(e[17]=a=>M.value.tagList=a),placeholder:"请输入标签，用逗号分隔（如：流行,抒情）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),o(ae,{modelValue:oe.value,"onUpdate:modelValue":e[20]||(e[20]=a=>oe.value=a),title:"导入进度",width:"500px","close-on-click-modal":!1,"close-on-press-escape":!1,onClose:ge},{footer:l(()=>[o(m,{onClick:ge,disabled:h.value.status==="PROCESSING"},{default:l(()=>[p(c(h.value.status==="PROCESSING"?"处理中...":"关闭"),1)]),_:1},8,["disabled"])]),default:l(()=>[s("div",Oo,[s("div",Go,[s("p",null,[e[50]||(e[50]=s("strong",null,"文件名：",-1)),p(c(h.value.fileName),1)]),s("p",null,[e[51]||(e[51]=s("strong",null,"任务ID：",-1)),p(c(h.value.id),1)]),s("p",null,[e[52]||(e[52]=s("strong",null,"状态：",-1)),o(U,{type:Ge(h.value.status),size:"small"},{default:l(()=>[p(c(Oe(h.value.status)),1)]),_:1},8,["type"])])]),s("div",qo,[o(Ze,{percentage:h.value.progress,status:h.value.status==="COMPLETED"?"success":h.value.status==="FAILED"?"exception":null},null,8,["percentage","status"]),h.value.totalCount>0?(V(),b("div",jo,[s("div",Jo,[s("span",null,"总计："+c(h.value.totalCount),1),s("span",null,"已处理："+c(h.value.processedCount),1)]),s("div",Ko,[s("span",Qo,"成功："+c(h.value.successCount),1),s("span",Ho,"跳过："+c(h.value.skipCount),1),s("span",Wo,"失败："+c(h.value.errorCount),1)])])):X("",!0)]),h.value.status==="PROCESSING"?(V(),b("div",Xo,[o(i,{class:"rotating"},{default:l(()=>[o(_(Dt))]),_:1}),e[53]||(e[53]=s("span",null,"正在处理中，请稍候...",-1))])):X("",!0),h.value.status==="COMPLETED"?(V(),b("div",Yo,[o(i,{style:{color:"#67c23a"}},{default:l(()=>[o(_(Ve))]),_:1}),e[54]||(e[54]=s("span",null,"导入完成！",-1))])):X("",!0),h.value.status==="FAILED"?(V(),b("div",Zo,[o(i,{style:{color:"#f56c6c"}},{default:l(()=>[o(_(ke))]),_:1}),e[55]||(e[55]=s("span",null,"导入失败，请重试",-1))])):X("",!0)])]),_:1},8,["modelValue"])])}}},fs=tt(es,[["__scopeId","data-v-27006d73"]]);export{fs as default};
