import{_ as T}from"./_plugin-vue_export-helper-d6af9df2.js";/* empty css                  *//* empty css                     *//* empty css                */import{p as Y,u as J,a as K,r as m,q as O,o as p,c as y,d as t,e as l,w as a,t as r,v as f,Y as P,A as V,C as Q,D as W,H as X,k as Z,L as ee,M as te,ay as oe,h as s,N as ae,U as le,y as se,B as c,ad as ne,G as re,ae as ue,af as ie,an as de,ak as _e,i as me,j as pe,l as ce}from"./index-a434c30f.js";import{a as fe}from"./author-93b9e298.js";const ve={class:"author-layout"},ge={class:"header"},we={class:"header-right"},ye={class:"user-info"},Ee={class:"username"},ke={class:"content"},he={key:0,class:"author-info"},De={class:"row"},xe={class:"row"},Ae={class:"row"},Ve={key:0,class:"row"},Ce={__name:"AuthorDetail",setup(Ie){const C=Y(),E=J(),i=K(),v=m(!1),n=m(null),d=m(!1),g=m(!1),_=m({email:""}),I=()=>E.back(),k=o=>o?o>=1e4?(o/1e4).toFixed(1)+"w":o.toString():"0",b=async()=>{const o=C.params.userId;if(o){v.value=!0;try{const e=await fe.getAuthorInfo(o);e.code===200&&(n.value=e.data)}finally{v.value=!1}}},U=async o=>{var e;if(o==="updateEmail"){_.value.email=((e=i.user)==null?void 0:e.email)||"",d.value=!0;return}if(o==="logout")try{await Q.confirm("确认退出登录？","提示",{type:"warning"}),await i.logout(),E.push("/login")}catch{}},B=o=>/^[\w.!#$%&'*+/=?^`{|}~-]+@[\w-]+(\.[\w-]+)+$/.test(o),N=async()=>{const o=(_.value.email||"").trim();if(!o){c.warning("请输入邮箱地址");return}if(!B(o)){c.warning("邮箱格式不正确");return}g.value=!0;try{const e=await ne.updateEmail({email:o});e.code===200?(i.setUser({...i.user||{},email:o}),c.success("邮箱更新成功"),d.value=!1):c.error(e.message||"邮箱更新失败")}catch{c.error("邮箱更新失败，请稍后重试")}finally{g.value=!1}};return O(b),(o,e)=>{var x;const h=W,F=re,D=ue,L=ie,M=X,w=Z,S=de,$=_e,R=ee,j=me,q=pe,z=ce,G=te,H=oe;return p(),y("div",ve,[t("header",ge,[e[6]||(e[6]=t("div",{class:"header-left"},[t("h1",{class:"system-title"},"抖音短视频分析系统")],-1)),t("div",we,[t("div",ye,[l(h,{size:32,class:"user-avatar"},{default:a(()=>{var u,A;return[s(r((A=(u=f(i).user)==null?void 0:u.username)==null?void 0:A.charAt(0)),1)]}),_:1}),t("span",Ee,r((x=f(i).user)==null?void 0:x.username),1),l(M,{onCommand:U,class:"user-dropdown"},{dropdown:a(()=>[l(L,null,{default:a(()=>[l(D,{command:"updateEmail"},{default:a(()=>e[3]||(e[3]=[s("更新邮箱",-1)])),_:1,__:[3]}),l(D,{command:"logout"},{default:a(()=>e[4]||(e[4]=[s("退出登录",-1)])),_:1,__:[4]})]),_:1})]),default:a(()=>[l(F,{class:"dropdown-icon"},{default:a(()=>[l(f(ae))]),_:1})]),_:1})]),l(w,{onClick:I,icon:f(le),style:{"margin-left":"16px"}},{default:a(()=>e[5]||(e[5]=[s("返回",-1)])),_:1,__:[5]},8,["icon"])])]),t("main",ke,[e[14]||(e[14]=t("div",{class:"page-header"},[t("h2",{class:"page-title"},"播主信息")],-1)),P((p(),V(R,null,{default:a(()=>[n.value?(p(),y("div",he,[t("div",De,[t("div",null,[e[7]||(e[7]=t("strong",null,"用户ID：",-1)),s(r(n.value.userId),1)]),t("div",null,[e[8]||(e[8]=t("strong",null,"昵称：",-1)),s(r(n.value.nickname),1)])]),t("div",xe,[t("div",null,[e[9]||(e[9]=t("strong",null,"粉丝：",-1)),s(r(k(n.value.followerCount)),1)]),t("div",null,[e[10]||(e[10]=t("strong",null,"获赞：",-1)),s(r(k(n.value.totalFavorited)),1)])]),t("div",Ae,[t("div",null,[e[11]||(e[11]=t("strong",null,"性别：",-1)),s(r(n.value.gender||"-"),1)]),t("div",null,[e[12]||(e[12]=t("strong",null,"地区：",-1)),s(r(n.value.ipLocation||"-"),1)])]),n.value.userUrl?(p(),y("div",Ve,[t("div",null,[e[13]||(e[13]=t("strong",null,"播主地址：",-1)),l(S,{type:"primary",href:n.value.userUrl,target:"_blank",class:"author-link"},{default:a(()=>[s(r(n.value.userUrl),1)]),_:1},8,["href"])])])):se("",!0)])):(p(),V($,{key:1,description:"暂无播主信息"}))]),_:1})),[[H,v.value]])]),l(G,{modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=u=>d.value=u),title:"更新邮箱",width:"420px"},{footer:a(()=>[l(w,{onClick:e[1]||(e[1]=u=>d.value=!1)},{default:a(()=>e[15]||(e[15]=[s("取消",-1)])),_:1,__:[15]}),l(w,{type:"primary",loading:g.value,onClick:N},{default:a(()=>e[16]||(e[16]=[s("确定",-1)])),_:1,__:[16]},8,["loading"])]),default:a(()=>[l(z,{model:_.value,"label-width":"80px"},{default:a(()=>[l(q,{label:"邮箱"},{default:a(()=>[l(j,{modelValue:_.value.email,"onUpdate:modelValue":e[0]||(e[0]=u=>_.value.email=u),placeholder:"请输入新的邮箱地址"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Me=T(Ce,[["__scopeId","data-v-26d3a9eb"]]);export{Me as default};
