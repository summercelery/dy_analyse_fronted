# 音乐标签管理功能说明

## 功能概述

根据最新的API接口文档（v2.5.0），我们优化了音乐编辑时标签的部分，新增了完整的音乐标签管理体系。

## 新增功能

### 1. 标签管理接口
- **添加标签**: `POST /api/music/{id}/tags?tag=标签名`
- **移除标签**: `DELETE /api/music/{id}/tags?tag=标签名`
- **设置标签**: `PUT /api/music/{id}/tags?tags=标签1,标签2,标签3`
- **获取标签**: `GET /api/music/{id}/tags`

### 2. 搜索功能增强
- **扩展搜索**: `GET /api/music/search/extended?keyword=关键词` - 支持标签搜索
- **标签搜索**: `GET /api/music/search/tag?tag=标签名`
- **多标签搜索**: `GET /api/music/search/tags?tags=标签1,标签2,标签3`

### 3. 前端优化

#### Music.vue 页面
- 标签输入改为动态添加/删除模式
- 支持回车键快速添加标签
- 标签数量限制（最多10个）
- 单个标签长度限制（最多20字符）
- 标签重复检查
- 标签验证规则

#### Monitor.vue 页面
- 新增音乐编辑功能
- 在监控页面直接编辑音乐信息
- 标签管理集成

## 使用方法

### 添加标签
1. 在标签输入框中输入标签名称
2. 按回车键或点击"添加"按钮
3. 标签会自动添加到标签列表中

### 删除标签
1. 点击标签右侧的关闭按钮
2. 标签会从列表中移除

### 编辑音乐
1. 在监控页面点击"编辑音乐"按钮
2. 修改音乐信息（标题、作者、专辑、标签）
3. 点击"更新"保存修改

## 技术特点

### 1. 数据格式
- 前端使用数组格式管理标签：`["流行", "抒情", "原创"]`
- API传输使用JSON字符串格式：`"[\"流行\",\"抒情\",\"原创\"]`
- 显示时转换为逗号分隔格式：`流行, 抒情, 原创`

### 2. 验证规则
- 标签数量：1-10个
- 单个标签长度：1-20字符
- 标签不能重复
- 标签不能为空

### 3. 用户体验
- 实时标签预览
- 键盘快捷键支持
- 友好的错误提示
- 响应式标签布局

## 文件修改说明

### 新增文件
- `MUSIC_TAGS_README.md` - 功能说明文档

### 修改文件
- `src/api/music.js` - 新增标签管理API接口
- `src/views/Music.vue` - 优化标签编辑功能
- `src/views/Monitor.vue` - 新增音乐编辑功能
- `src/views/BasicTest.vue` - 标签功能测试页面

## 测试方法

1. 访问 `/basic-test` 页面测试标签输入功能
2. 在音乐管理页面测试标签编辑功能
3. 在监控页面测试音乐编辑功能
4. 使用API测试按钮验证接口功能

## 注意事项

1. **标签格式**: 标签以JSON数组格式存储，支持中英文
2. **数据同步**: 标签变更会自动推送到RabbitMQ队列进行同步
3. **搜索优化**: 标签搜索使用MySQL `JSON_CONTAINS()` 函数高效查询
4. **权限控制**: 标签管理功能无需登录认证

## 更新日志

### v2.5.0 (2025-08-11)
- 🎵 新增完整的音乐标签管理体系
- 🔍 新增4个标签管理接口
- 🔍 新增3个标签搜索接口
- 🎨 优化前端标签编辑体验
- 📱 支持键盘快捷键操作
- ✅ 完善的标签验证规则

---

如有问题或建议，请联系开发团队。
